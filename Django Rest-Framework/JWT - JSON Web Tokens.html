<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JWT - JSON Web Tokens | Kevin-Blog</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/kevin-blog/logo.png">
    <meta name="description" content="">
    <link rel="preload" href="/kevin-blog/assets/css/0.styles.267bc68b.css" as="style"><link rel="preload" href="/kevin-blog/assets/js/app.dd46475d.js" as="script"><link rel="preload" href="/kevin-blog/assets/js/2.97d04891.js" as="script"><link rel="preload" href="/kevin-blog/assets/js/29.37ea8137.js" as="script"><link rel="prefetch" href="/kevin-blog/assets/js/10.2b686438.js"><link rel="prefetch" href="/kevin-blog/assets/js/100.cfc5acd5.js"><link rel="prefetch" href="/kevin-blog/assets/js/101.628bd39e.js"><link rel="prefetch" href="/kevin-blog/assets/js/102.41585307.js"><link rel="prefetch" href="/kevin-blog/assets/js/103.5d18350a.js"><link rel="prefetch" href="/kevin-blog/assets/js/104.85cd65cf.js"><link rel="prefetch" href="/kevin-blog/assets/js/105.9d303bac.js"><link rel="prefetch" href="/kevin-blog/assets/js/106.73f6a263.js"><link rel="prefetch" href="/kevin-blog/assets/js/107.9dfe114c.js"><link rel="prefetch" href="/kevin-blog/assets/js/108.315e8c63.js"><link rel="prefetch" href="/kevin-blog/assets/js/109.ef21ffa0.js"><link rel="prefetch" href="/kevin-blog/assets/js/11.2b0f6358.js"><link rel="prefetch" href="/kevin-blog/assets/js/110.dfe062a3.js"><link rel="prefetch" href="/kevin-blog/assets/js/111.08f0c3e7.js"><link rel="prefetch" href="/kevin-blog/assets/js/112.0e180f10.js"><link rel="prefetch" href="/kevin-blog/assets/js/113.295f1fca.js"><link rel="prefetch" href="/kevin-blog/assets/js/114.5645d09d.js"><link rel="prefetch" href="/kevin-blog/assets/js/115.ebe19212.js"><link rel="prefetch" href="/kevin-blog/assets/js/116.b3eb5cab.js"><link rel="prefetch" href="/kevin-blog/assets/js/117.076c6372.js"><link rel="prefetch" href="/kevin-blog/assets/js/118.226fb513.js"><link rel="prefetch" href="/kevin-blog/assets/js/119.298c0302.js"><link rel="prefetch" href="/kevin-blog/assets/js/12.01390043.js"><link rel="prefetch" href="/kevin-blog/assets/js/120.943d0d71.js"><link rel="prefetch" href="/kevin-blog/assets/js/121.2d1bd8ef.js"><link rel="prefetch" href="/kevin-blog/assets/js/122.84b9dff1.js"><link rel="prefetch" href="/kevin-blog/assets/js/123.85d93d87.js"><link rel="prefetch" href="/kevin-blog/assets/js/124.4913aefd.js"><link rel="prefetch" href="/kevin-blog/assets/js/125.cf667169.js"><link rel="prefetch" href="/kevin-blog/assets/js/126.eefd3250.js"><link rel="prefetch" href="/kevin-blog/assets/js/127.f9697daf.js"><link rel="prefetch" href="/kevin-blog/assets/js/128.aff6033d.js"><link rel="prefetch" href="/kevin-blog/assets/js/129.fa7ec9a8.js"><link rel="prefetch" href="/kevin-blog/assets/js/13.e55a4126.js"><link rel="prefetch" href="/kevin-blog/assets/js/130.9d50b78d.js"><link rel="prefetch" href="/kevin-blog/assets/js/131.f384aa34.js"><link rel="prefetch" href="/kevin-blog/assets/js/132.e60091dc.js"><link rel="prefetch" href="/kevin-blog/assets/js/133.09a9de16.js"><link rel="prefetch" href="/kevin-blog/assets/js/134.a7739a99.js"><link rel="prefetch" href="/kevin-blog/assets/js/135.bea491db.js"><link rel="prefetch" href="/kevin-blog/assets/js/136.92af3a82.js"><link rel="prefetch" href="/kevin-blog/assets/js/137.dbda7b02.js"><link rel="prefetch" href="/kevin-blog/assets/js/138.9fea4ca4.js"><link rel="prefetch" href="/kevin-blog/assets/js/139.0a81aff9.js"><link rel="prefetch" href="/kevin-blog/assets/js/14.efd69f3b.js"><link rel="prefetch" href="/kevin-blog/assets/js/140.3f048218.js"><link rel="prefetch" href="/kevin-blog/assets/js/141.002d7568.js"><link rel="prefetch" href="/kevin-blog/assets/js/142.aec10062.js"><link rel="prefetch" href="/kevin-blog/assets/js/143.2e682c5b.js"><link rel="prefetch" href="/kevin-blog/assets/js/144.d05092f0.js"><link rel="prefetch" href="/kevin-blog/assets/js/145.358437b8.js"><link rel="prefetch" href="/kevin-blog/assets/js/146.af219f24.js"><link rel="prefetch" href="/kevin-blog/assets/js/147.061cb5fe.js"><link rel="prefetch" href="/kevin-blog/assets/js/148.422d1f87.js"><link rel="prefetch" href="/kevin-blog/assets/js/149.c97f27f4.js"><link rel="prefetch" href="/kevin-blog/assets/js/15.271f58eb.js"><link rel="prefetch" href="/kevin-blog/assets/js/150.177533a9.js"><link rel="prefetch" href="/kevin-blog/assets/js/151.d70f314c.js"><link rel="prefetch" href="/kevin-blog/assets/js/152.ca40e6fc.js"><link rel="prefetch" href="/kevin-blog/assets/js/153.a2bca317.js"><link rel="prefetch" href="/kevin-blog/assets/js/154.22edbf9f.js"><link rel="prefetch" href="/kevin-blog/assets/js/155.e59b2d87.js"><link rel="prefetch" href="/kevin-blog/assets/js/156.d5a38de8.js"><link rel="prefetch" href="/kevin-blog/assets/js/157.cbe5199a.js"><link rel="prefetch" href="/kevin-blog/assets/js/158.31c5b8b2.js"><link rel="prefetch" href="/kevin-blog/assets/js/159.0763ed0c.js"><link rel="prefetch" href="/kevin-blog/assets/js/16.e92cdd55.js"><link rel="prefetch" href="/kevin-blog/assets/js/160.a05ced02.js"><link rel="prefetch" href="/kevin-blog/assets/js/161.7e52ed13.js"><link rel="prefetch" href="/kevin-blog/assets/js/162.f5df7208.js"><link rel="prefetch" href="/kevin-blog/assets/js/163.78a78de8.js"><link rel="prefetch" href="/kevin-blog/assets/js/164.54fd347c.js"><link rel="prefetch" href="/kevin-blog/assets/js/165.a0347ed3.js"><link rel="prefetch" href="/kevin-blog/assets/js/166.0702e96e.js"><link rel="prefetch" href="/kevin-blog/assets/js/167.69136cd0.js"><link rel="prefetch" href="/kevin-blog/assets/js/168.d0aa7e0d.js"><link rel="prefetch" href="/kevin-blog/assets/js/169.6229f0ca.js"><link rel="prefetch" href="/kevin-blog/assets/js/17.9a006e5d.js"><link rel="prefetch" href="/kevin-blog/assets/js/170.b6571721.js"><link rel="prefetch" href="/kevin-blog/assets/js/171.600f9683.js"><link rel="prefetch" href="/kevin-blog/assets/js/172.6e1792a7.js"><link rel="prefetch" href="/kevin-blog/assets/js/173.cef126b3.js"><link rel="prefetch" href="/kevin-blog/assets/js/174.97b3e897.js"><link rel="prefetch" href="/kevin-blog/assets/js/175.fcefca30.js"><link rel="prefetch" href="/kevin-blog/assets/js/176.31862a66.js"><link rel="prefetch" href="/kevin-blog/assets/js/177.089b09c0.js"><link rel="prefetch" href="/kevin-blog/assets/js/178.a5dcd25c.js"><link rel="prefetch" href="/kevin-blog/assets/js/179.a9d685f2.js"><link rel="prefetch" href="/kevin-blog/assets/js/18.a1c24192.js"><link rel="prefetch" href="/kevin-blog/assets/js/180.4ad69266.js"><link rel="prefetch" href="/kevin-blog/assets/js/181.691d48a2.js"><link rel="prefetch" href="/kevin-blog/assets/js/182.e77aa679.js"><link rel="prefetch" href="/kevin-blog/assets/js/183.2b4341f4.js"><link rel="prefetch" href="/kevin-blog/assets/js/184.b3610e8b.js"><link rel="prefetch" href="/kevin-blog/assets/js/185.08107897.js"><link rel="prefetch" href="/kevin-blog/assets/js/186.9f5a3f65.js"><link rel="prefetch" href="/kevin-blog/assets/js/187.ac2fe2c2.js"><link rel="prefetch" href="/kevin-blog/assets/js/188.09023a78.js"><link rel="prefetch" href="/kevin-blog/assets/js/189.409b4ed0.js"><link rel="prefetch" href="/kevin-blog/assets/js/19.c733cdfe.js"><link rel="prefetch" href="/kevin-blog/assets/js/190.ca5d775c.js"><link rel="prefetch" href="/kevin-blog/assets/js/191.8052fe42.js"><link rel="prefetch" href="/kevin-blog/assets/js/192.31ebe059.js"><link rel="prefetch" href="/kevin-blog/assets/js/193.9bf32e11.js"><link rel="prefetch" href="/kevin-blog/assets/js/194.0667554a.js"><link rel="prefetch" href="/kevin-blog/assets/js/195.ea249ba4.js"><link rel="prefetch" href="/kevin-blog/assets/js/196.6278ec5a.js"><link rel="prefetch" href="/kevin-blog/assets/js/197.90f6af7b.js"><link rel="prefetch" href="/kevin-blog/assets/js/198.2e358b6a.js"><link rel="prefetch" href="/kevin-blog/assets/js/199.a0bd0085.js"><link rel="prefetch" href="/kevin-blog/assets/js/20.890583ea.js"><link rel="prefetch" href="/kevin-blog/assets/js/200.bc1e237a.js"><link rel="prefetch" href="/kevin-blog/assets/js/201.767e166e.js"><link rel="prefetch" href="/kevin-blog/assets/js/202.a52f0e94.js"><link rel="prefetch" href="/kevin-blog/assets/js/203.06f0ebab.js"><link rel="prefetch" href="/kevin-blog/assets/js/204.7ae45191.js"><link rel="prefetch" href="/kevin-blog/assets/js/205.b8412fbc.js"><link rel="prefetch" href="/kevin-blog/assets/js/206.682f9a3e.js"><link rel="prefetch" href="/kevin-blog/assets/js/207.8978346c.js"><link rel="prefetch" href="/kevin-blog/assets/js/208.35db8c05.js"><link rel="prefetch" href="/kevin-blog/assets/js/209.1eebeab0.js"><link rel="prefetch" href="/kevin-blog/assets/js/21.48328b6a.js"><link rel="prefetch" href="/kevin-blog/assets/js/210.b56db64f.js"><link rel="prefetch" href="/kevin-blog/assets/js/211.31da36f5.js"><link rel="prefetch" href="/kevin-blog/assets/js/212.2f2d2d1f.js"><link rel="prefetch" href="/kevin-blog/assets/js/213.be55b8cc.js"><link rel="prefetch" href="/kevin-blog/assets/js/214.aeffc247.js"><link rel="prefetch" href="/kevin-blog/assets/js/215.137bae15.js"><link rel="prefetch" href="/kevin-blog/assets/js/216.2692c636.js"><link rel="prefetch" href="/kevin-blog/assets/js/217.a6a9cf62.js"><link rel="prefetch" href="/kevin-blog/assets/js/218.7353ed7a.js"><link rel="prefetch" href="/kevin-blog/assets/js/219.f1fdfe8e.js"><link rel="prefetch" href="/kevin-blog/assets/js/22.5fd865e7.js"><link rel="prefetch" href="/kevin-blog/assets/js/220.e20ab2b5.js"><link rel="prefetch" href="/kevin-blog/assets/js/221.0d06c8b0.js"><link rel="prefetch" href="/kevin-blog/assets/js/222.e39491a9.js"><link rel="prefetch" href="/kevin-blog/assets/js/223.ae98df72.js"><link rel="prefetch" href="/kevin-blog/assets/js/224.4ba5d334.js"><link rel="prefetch" href="/kevin-blog/assets/js/225.913ee059.js"><link rel="prefetch" href="/kevin-blog/assets/js/226.b8d730bd.js"><link rel="prefetch" href="/kevin-blog/assets/js/227.69ee92e2.js"><link rel="prefetch" href="/kevin-blog/assets/js/228.1cf17cff.js"><link rel="prefetch" href="/kevin-blog/assets/js/229.6ce44fac.js"><link rel="prefetch" href="/kevin-blog/assets/js/23.9ef4ab20.js"><link rel="prefetch" href="/kevin-blog/assets/js/230.30c28e05.js"><link rel="prefetch" href="/kevin-blog/assets/js/231.ef327150.js"><link rel="prefetch" href="/kevin-blog/assets/js/232.6cb791d8.js"><link rel="prefetch" href="/kevin-blog/assets/js/233.473fa94b.js"><link rel="prefetch" href="/kevin-blog/assets/js/234.848de787.js"><link rel="prefetch" href="/kevin-blog/assets/js/235.f5db4ed9.js"><link rel="prefetch" href="/kevin-blog/assets/js/236.5da3f87c.js"><link rel="prefetch" href="/kevin-blog/assets/js/237.018a543d.js"><link rel="prefetch" href="/kevin-blog/assets/js/238.74d22845.js"><link rel="prefetch" href="/kevin-blog/assets/js/239.fca187a6.js"><link rel="prefetch" href="/kevin-blog/assets/js/24.3dff5faa.js"><link rel="prefetch" href="/kevin-blog/assets/js/240.0dbbfe84.js"><link rel="prefetch" href="/kevin-blog/assets/js/241.8b1ccf29.js"><link rel="prefetch" href="/kevin-blog/assets/js/242.f5216a9f.js"><link rel="prefetch" href="/kevin-blog/assets/js/243.8e5c5e34.js"><link rel="prefetch" href="/kevin-blog/assets/js/244.8f78ae9a.js"><link rel="prefetch" href="/kevin-blog/assets/js/245.e0b2e7b9.js"><link rel="prefetch" href="/kevin-blog/assets/js/246.7700207e.js"><link rel="prefetch" href="/kevin-blog/assets/js/247.c1e13b57.js"><link rel="prefetch" href="/kevin-blog/assets/js/248.63d6adf8.js"><link rel="prefetch" href="/kevin-blog/assets/js/249.500fdd00.js"><link rel="prefetch" href="/kevin-blog/assets/js/25.0ebddc27.js"><link rel="prefetch" href="/kevin-blog/assets/js/250.ebbb5c92.js"><link rel="prefetch" href="/kevin-blog/assets/js/251.4e51605e.js"><link rel="prefetch" href="/kevin-blog/assets/js/252.2534bb33.js"><link rel="prefetch" href="/kevin-blog/assets/js/253.330d0073.js"><link rel="prefetch" href="/kevin-blog/assets/js/254.da99904b.js"><link rel="prefetch" href="/kevin-blog/assets/js/255.f9a1774e.js"><link rel="prefetch" href="/kevin-blog/assets/js/256.7ee8ac66.js"><link rel="prefetch" href="/kevin-blog/assets/js/257.41594669.js"><link rel="prefetch" href="/kevin-blog/assets/js/258.9d8beffc.js"><link rel="prefetch" href="/kevin-blog/assets/js/259.1539043a.js"><link rel="prefetch" href="/kevin-blog/assets/js/26.7e91ac9d.js"><link rel="prefetch" href="/kevin-blog/assets/js/260.034695f0.js"><link rel="prefetch" href="/kevin-blog/assets/js/261.953910a0.js"><link rel="prefetch" href="/kevin-blog/assets/js/262.e2b0764f.js"><link rel="prefetch" href="/kevin-blog/assets/js/263.fe9b0b70.js"><link rel="prefetch" href="/kevin-blog/assets/js/264.489e20f7.js"><link rel="prefetch" href="/kevin-blog/assets/js/265.43596b34.js"><link rel="prefetch" href="/kevin-blog/assets/js/266.07bb7008.js"><link rel="prefetch" href="/kevin-blog/assets/js/267.5caf5b93.js"><link rel="prefetch" href="/kevin-blog/assets/js/268.fc6e09e2.js"><link rel="prefetch" href="/kevin-blog/assets/js/269.764500c0.js"><link rel="prefetch" href="/kevin-blog/assets/js/27.55c7093f.js"><link rel="prefetch" href="/kevin-blog/assets/js/270.9760648a.js"><link rel="prefetch" href="/kevin-blog/assets/js/271.019b1f9a.js"><link rel="prefetch" href="/kevin-blog/assets/js/272.bce07ec6.js"><link rel="prefetch" href="/kevin-blog/assets/js/273.038ff1e3.js"><link rel="prefetch" href="/kevin-blog/assets/js/274.2cb7fd59.js"><link rel="prefetch" href="/kevin-blog/assets/js/275.3c831af6.js"><link rel="prefetch" href="/kevin-blog/assets/js/276.8d0732f8.js"><link rel="prefetch" href="/kevin-blog/assets/js/277.5aa0c664.js"><link rel="prefetch" href="/kevin-blog/assets/js/278.a3cdd3b8.js"><link rel="prefetch" href="/kevin-blog/assets/js/279.d049a479.js"><link rel="prefetch" href="/kevin-blog/assets/js/28.da28db4a.js"><link rel="prefetch" href="/kevin-blog/assets/js/280.6b7f68c4.js"><link rel="prefetch" href="/kevin-blog/assets/js/281.eff251cb.js"><link rel="prefetch" href="/kevin-blog/assets/js/282.f0dc7866.js"><link rel="prefetch" href="/kevin-blog/assets/js/283.36ca2fb9.js"><link rel="prefetch" href="/kevin-blog/assets/js/284.470e6db4.js"><link rel="prefetch" href="/kevin-blog/assets/js/285.a9c60b36.js"><link rel="prefetch" href="/kevin-blog/assets/js/286.3eff6f51.js"><link rel="prefetch" href="/kevin-blog/assets/js/287.f406cf63.js"><link rel="prefetch" href="/kevin-blog/assets/js/288.d6bb5731.js"><link rel="prefetch" href="/kevin-blog/assets/js/289.518409f3.js"><link rel="prefetch" href="/kevin-blog/assets/js/290.e4795980.js"><link rel="prefetch" href="/kevin-blog/assets/js/291.6ca97e3d.js"><link rel="prefetch" href="/kevin-blog/assets/js/292.f434852f.js"><link rel="prefetch" href="/kevin-blog/assets/js/293.256f39e1.js"><link rel="prefetch" href="/kevin-blog/assets/js/294.0e051edc.js"><link rel="prefetch" href="/kevin-blog/assets/js/295.d6a1cfbb.js"><link rel="prefetch" href="/kevin-blog/assets/js/296.9a3f4bb2.js"><link rel="prefetch" href="/kevin-blog/assets/js/297.374bbc2d.js"><link rel="prefetch" href="/kevin-blog/assets/js/298.c37b0145.js"><link rel="prefetch" href="/kevin-blog/assets/js/299.008098d2.js"><link rel="prefetch" href="/kevin-blog/assets/js/3.0c6053de.js"><link rel="prefetch" href="/kevin-blog/assets/js/30.24e20f30.js"><link rel="prefetch" href="/kevin-blog/assets/js/300.ab07139a.js"><link rel="prefetch" href="/kevin-blog/assets/js/301.69ee5ffa.js"><link rel="prefetch" href="/kevin-blog/assets/js/302.05af46d8.js"><link rel="prefetch" href="/kevin-blog/assets/js/303.cec1cf65.js"><link rel="prefetch" href="/kevin-blog/assets/js/304.7c82ba6c.js"><link rel="prefetch" href="/kevin-blog/assets/js/305.7ac25f4a.js"><link rel="prefetch" href="/kevin-blog/assets/js/306.82149841.js"><link rel="prefetch" href="/kevin-blog/assets/js/307.f56afc9c.js"><link rel="prefetch" href="/kevin-blog/assets/js/308.7c084ed0.js"><link rel="prefetch" href="/kevin-blog/assets/js/309.feb89623.js"><link rel="prefetch" href="/kevin-blog/assets/js/31.19d1e3af.js"><link rel="prefetch" href="/kevin-blog/assets/js/310.1e33889a.js"><link rel="prefetch" href="/kevin-blog/assets/js/311.416e7d20.js"><link rel="prefetch" href="/kevin-blog/assets/js/312.ee11dbec.js"><link rel="prefetch" href="/kevin-blog/assets/js/313.f58bb112.js"><link rel="prefetch" href="/kevin-blog/assets/js/314.543b2b1c.js"><link rel="prefetch" href="/kevin-blog/assets/js/315.18b9a70e.js"><link rel="prefetch" href="/kevin-blog/assets/js/316.6dfba854.js"><link rel="prefetch" href="/kevin-blog/assets/js/317.19590777.js"><link rel="prefetch" href="/kevin-blog/assets/js/318.a3ec0c19.js"><link rel="prefetch" href="/kevin-blog/assets/js/319.f990a61a.js"><link rel="prefetch" href="/kevin-blog/assets/js/32.07887ecb.js"><link rel="prefetch" href="/kevin-blog/assets/js/320.a3c5cbbf.js"><link rel="prefetch" href="/kevin-blog/assets/js/321.1f58e49c.js"><link rel="prefetch" href="/kevin-blog/assets/js/322.032ff5a2.js"><link rel="prefetch" href="/kevin-blog/assets/js/323.cdd3ba68.js"><link rel="prefetch" href="/kevin-blog/assets/js/324.5238a4e1.js"><link rel="prefetch" href="/kevin-blog/assets/js/325.df06c071.js"><link rel="prefetch" href="/kevin-blog/assets/js/33.9539a78e.js"><link rel="prefetch" href="/kevin-blog/assets/js/34.fa08dd12.js"><link rel="prefetch" href="/kevin-blog/assets/js/35.d6823664.js"><link rel="prefetch" href="/kevin-blog/assets/js/36.5e074071.js"><link rel="prefetch" href="/kevin-blog/assets/js/37.f4a65a95.js"><link rel="prefetch" href="/kevin-blog/assets/js/38.4f127420.js"><link rel="prefetch" href="/kevin-blog/assets/js/39.a5427f94.js"><link rel="prefetch" href="/kevin-blog/assets/js/4.a60d4c06.js"><link rel="prefetch" href="/kevin-blog/assets/js/40.859a530c.js"><link rel="prefetch" href="/kevin-blog/assets/js/41.b61d8247.js"><link rel="prefetch" href="/kevin-blog/assets/js/42.cd204014.js"><link rel="prefetch" href="/kevin-blog/assets/js/43.8076c8fc.js"><link rel="prefetch" href="/kevin-blog/assets/js/44.8a85cf72.js"><link rel="prefetch" href="/kevin-blog/assets/js/45.f46f354b.js"><link rel="prefetch" href="/kevin-blog/assets/js/46.5990e5be.js"><link rel="prefetch" href="/kevin-blog/assets/js/47.9381b746.js"><link rel="prefetch" href="/kevin-blog/assets/js/48.77d95473.js"><link rel="prefetch" href="/kevin-blog/assets/js/49.fc6dff0d.js"><link rel="prefetch" href="/kevin-blog/assets/js/5.6b8c7ebc.js"><link rel="prefetch" href="/kevin-blog/assets/js/50.297dac6d.js"><link rel="prefetch" href="/kevin-blog/assets/js/51.c6ed15a6.js"><link rel="prefetch" href="/kevin-blog/assets/js/52.8bb5ec6f.js"><link rel="prefetch" href="/kevin-blog/assets/js/53.32ab5818.js"><link rel="prefetch" href="/kevin-blog/assets/js/54.1fe541f9.js"><link rel="prefetch" href="/kevin-blog/assets/js/55.6084b23b.js"><link rel="prefetch" href="/kevin-blog/assets/js/56.242cd75a.js"><link rel="prefetch" href="/kevin-blog/assets/js/57.a3aa61b8.js"><link rel="prefetch" href="/kevin-blog/assets/js/58.5dc813ec.js"><link rel="prefetch" href="/kevin-blog/assets/js/59.0649b9f5.js"><link rel="prefetch" href="/kevin-blog/assets/js/6.8f60ce79.js"><link rel="prefetch" href="/kevin-blog/assets/js/60.e912e60f.js"><link rel="prefetch" href="/kevin-blog/assets/js/61.2348484b.js"><link rel="prefetch" href="/kevin-blog/assets/js/62.43b03d30.js"><link rel="prefetch" href="/kevin-blog/assets/js/63.6e56096d.js"><link rel="prefetch" href="/kevin-blog/assets/js/64.c45908b4.js"><link rel="prefetch" href="/kevin-blog/assets/js/65.aab0a20e.js"><link rel="prefetch" href="/kevin-blog/assets/js/66.2555ebea.js"><link rel="prefetch" href="/kevin-blog/assets/js/67.80828b1b.js"><link rel="prefetch" href="/kevin-blog/assets/js/68.5b1b38ff.js"><link rel="prefetch" href="/kevin-blog/assets/js/69.d735686b.js"><link rel="prefetch" href="/kevin-blog/assets/js/7.8fc0c0e7.js"><link rel="prefetch" href="/kevin-blog/assets/js/70.fd567fdf.js"><link rel="prefetch" href="/kevin-blog/assets/js/71.3dc39cbd.js"><link rel="prefetch" href="/kevin-blog/assets/js/72.6fe3454c.js"><link rel="prefetch" href="/kevin-blog/assets/js/73.80c96fab.js"><link rel="prefetch" href="/kevin-blog/assets/js/74.7b652913.js"><link rel="prefetch" href="/kevin-blog/assets/js/75.a9cc5506.js"><link rel="prefetch" href="/kevin-blog/assets/js/76.81bca567.js"><link rel="prefetch" href="/kevin-blog/assets/js/77.1851c464.js"><link rel="prefetch" href="/kevin-blog/assets/js/78.06a9be2e.js"><link rel="prefetch" href="/kevin-blog/assets/js/79.89ac9186.js"><link rel="prefetch" href="/kevin-blog/assets/js/8.d7f3575e.js"><link rel="prefetch" href="/kevin-blog/assets/js/80.76b8cfc2.js"><link rel="prefetch" href="/kevin-blog/assets/js/81.7c87b7a7.js"><link rel="prefetch" href="/kevin-blog/assets/js/82.1995f469.js"><link rel="prefetch" href="/kevin-blog/assets/js/83.dd77915d.js"><link rel="prefetch" href="/kevin-blog/assets/js/84.d167dd7d.js"><link rel="prefetch" href="/kevin-blog/assets/js/85.b858e7d4.js"><link rel="prefetch" href="/kevin-blog/assets/js/86.c4508e18.js"><link rel="prefetch" href="/kevin-blog/assets/js/87.e5015ac2.js"><link rel="prefetch" href="/kevin-blog/assets/js/88.03ea7184.js"><link rel="prefetch" href="/kevin-blog/assets/js/89.6c4aecd6.js"><link rel="prefetch" href="/kevin-blog/assets/js/9.541bf307.js"><link rel="prefetch" href="/kevin-blog/assets/js/90.e64c083e.js"><link rel="prefetch" href="/kevin-blog/assets/js/91.208ff0cf.js"><link rel="prefetch" href="/kevin-blog/assets/js/92.0247f769.js"><link rel="prefetch" href="/kevin-blog/assets/js/93.1d51e9e8.js"><link rel="prefetch" href="/kevin-blog/assets/js/94.52fd5e59.js"><link rel="prefetch" href="/kevin-blog/assets/js/95.3641a4fe.js"><link rel="prefetch" href="/kevin-blog/assets/js/96.a96da06a.js"><link rel="prefetch" href="/kevin-blog/assets/js/97.877152bf.js"><link rel="prefetch" href="/kevin-blog/assets/js/98.4fe249c2.js"><link rel="prefetch" href="/kevin-blog/assets/js/99.400d0dc4.js">
    <link rel="stylesheet" href="/kevin-blog/assets/css/0.styles.267bc68b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/kevin-blog/" class="home-link router-link-active"><!----> <span class="site-name">Kevin-Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kevin-blog/ES6/Map 数据结构.html" class="nav-link">
  ES6
</a></li></ul></div></div><div class="nav-item"><a href="/kevin-blog/Python/DBUtils 数据库连接池模块.html" class="nav-link">
  Python
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Django" class="dropdown-title"><span class="title">Django</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kevin-blog/Django/Ajax.html" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/kevin-blog/Django ORM/ORM-ContentType.html" class="nav-link">
  ORM
</a></li><li class="dropdown-item"><!----> <a href="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens.html" class="nav-link">
  Rest-Framework
</a></li></ul></div></div><div class="nav-item"><a href="/kevin-blog/Flask/Flask 文件上传.html" class="nav-link">
  Flask
</a></div><div class="nav-item"><a href="/kevin-blog/Git GitHub/Git.html" class="nav-link">
  Git GitHub
</a></div><div class="nav-item"><a href="/kevin-blog/Linux/CentOS 下载和安装.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/kevin-blog/MySQL/distinct 去重.html" class="nav-link">
  MySQL
</a></div><div class="nav-item"><a href="/kevin-blog/爬虫/Anaconda环境.html" class="nav-link">
  爬虫
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kevin-blog/ES6/Map 数据结构.html" class="nav-link">
  ES6
</a></li></ul></div></div><div class="nav-item"><a href="/kevin-blog/Python/DBUtils 数据库连接池模块.html" class="nav-link">
  Python
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Django" class="dropdown-title"><span class="title">Django</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kevin-blog/Django/Ajax.html" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/kevin-blog/Django ORM/ORM-ContentType.html" class="nav-link">
  ORM
</a></li><li class="dropdown-item"><!----> <a href="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens.html" class="nav-link">
  Rest-Framework
</a></li></ul></div></div><div class="nav-item"><a href="/kevin-blog/Flask/Flask 文件上传.html" class="nav-link">
  Flask
</a></div><div class="nav-item"><a href="/kevin-blog/Git GitHub/Git.html" class="nav-link">
  Git GitHub
</a></div><div class="nav-item"><a href="/kevin-blog/Linux/CentOS 下载和安装.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/kevin-blog/MySQL/distinct 去重.html" class="nav-link">
  MySQL
</a></div><div class="nav-item"><a href="/kevin-blog/爬虫/Anaconda环境.html" class="nav-link">
  爬虫
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Django Rest-Framework</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens.html" class="active sidebar-link">JWT - JSON Web Tokens</a></li><li><a href="/kevin-blog/Django Rest-Framework/ModelSerializer 序列化组件.html" class="sidebar-link">ModelSerializer 序列化组件</a></li><li><a href="/kevin-blog/Django Rest-Framework/RESTful 规范.html" class="sidebar-link">RESTful 规范</a></li><li><a href="/kevin-blog/Django Rest-Framework/Serializers 序列化组件.html" class="sidebar-link">Serializers 序列化组件</a></li><li><a href="/kevin-blog/Django Rest-Framework/rest-framework token认证.html" class="sidebar-link">rest-framework token认证</a></li><li><a href="/kevin-blog/Django Rest-Framework/rest-framework 的基本使用.html" class="sidebar-link">rest-framework 的基本使用</a></li><li><a href="/kevin-blog/Django Rest-Framework/为什么要使用 token 认证 而不是 session 认证.html" class="sidebar-link">为什么要使用 token 认证 而不是 session 认证</a></li><li><a href="/kevin-blog/Django Rest-Framework/分页.html" class="sidebar-link">分页</a></li><li><a href="/kevin-blog/Django Rest-Framework/权限组件.html" class="sidebar-link">权限组件</a></li><li><a href="/kevin-blog/Django Rest-Framework/注册url的新方法.html" class="sidebar-link">注册url的新方法</a></li><li><a href="/kevin-blog/Django Rest-Framework/渲染器.html" class="sidebar-link">渲染器</a></li><li><a href="/kevin-blog/Django Rest-Framework/版本.html" class="sidebar-link">版本</a></li><li><a href="/kevin-blog/Django Rest-Framework/视图四部曲.html" class="sidebar-link">视图四部曲</a></li><li><a href="/kevin-blog/Django Rest-Framework/解析器.html" class="sidebar-link">解析器</a></li><li><a href="/kevin-blog/Django Rest-Framework/认证组件.html" class="sidebar-link">认证组件</a></li><li><a href="/kevin-blog/Django Rest-Framework/频率组件.html" class="sidebar-link">频率组件</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div><span><div><div><div><h2 style="margin:10px 0px 12px;padding:0px 0px 0px 15px;font-size:21px;background-color:#3eaf7c;border-radius:3px;text-align:center;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><span style="font-size:21px;background-color:#3eaf7c;border-radius:3px;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;color:white;font-family:&quot;Helvetica Neue&quot;, Helvetica, Verdana, Arial, sans-serif;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;line-height:1.5;">JWT 的介绍</span></h2><div><br></div><div><span style="font-size:14pt;color:rgb(227, 0, 0);">注意: JWT 不局限于在 Django 下使用，也可以在 Flask 等其他框架 或 其他语言下使用</span></div><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">1.</span> <span style="font-size:14pt;font-weight:bold;">JWT 的简介</span></div><div><span style="font-size:14pt;"><br></span></div><ul><li><div><span style="font-size:12pt;">jwt（JSON Web Tokens），是一种开发的行业标准 RFC 7519 ，用于安全的表示双方之间的声明</span></div></li></ul><div><br></div><ul><li><div><span style="font-size:12pt;">目前，jwt广泛应用在系统的用户认证方面，特别是现在前后端分离项目</span></div></li></ul><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">2.</span> <span style="font-size:14pt;font-weight:bold;">JWT 认证流程</span></div><div><span style="font-size:14pt;"><br></span></div><div><span style="font-size:14pt;"><span style="font-size:14pt;font-weight:bold;"><img data-filename="Image.png" src="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens_files/Image.png" type="image/png"></span></span></div><div><span style="font-size:14pt;"><br></span></div><div>在项目开发中，一般会按照上图所示的过程进行认证，即：用户登录成功之后，服务端给用户浏览器返回一个token，以后用户浏览器要携带token再去向服务端发送请求，服务端校验token的合法性，合法则给用户看数据，否则，返回一些错误信息</div><div><br></div><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">3.</span> <span style="font-size:14pt;"><span style="font-size:14pt;font-weight:bold;">传统 token方式 和 JWT 在认证方面有什么差异？</span></span></div><div><span style="font-size:14pt;"><br></span></div><ul><li><div>传统token方式</div></li></ul><div><br></div><ul><ul><li><div>用户登录成功后，服务端生成一个随机 token 给用户，并且在服务端<span style="color:rgb(250, 122, 0);">（</span><span style="color:rgb(250, 122, 0);">数据库或缓存</span><span style="color:rgb(250, 122, 0);">）中保存一份token</span>，以后用户再来访问时需携带 token，服务端接收到 token 之后，去 数据库 或 缓存 中进行校验 token 的是否超时、是否合法</div></li></ul></ul><div><br></div><ul><li><div>jwt方式</div></li></ul><div><br></div><ul><ul><li><div>用户登录成功后，服务端通过 jwt 生成一个随机 token 给用户（<span style="color:rgb(250, 122, 0);">服务端无需保留token</span>），以后用户再来访问时需携带 token，服务端接收到 token 之后，通过 jwt 对 token 进行校验是否超时、是否合法</div></li></ul></ul><div><span style="font-size:14pt;"><br></span></div><h2 style="margin:10px 0px 12px;padding:0px 0px 0px 15px;font-size:21px;background-color:#3eaf7c;border-radius:3px;text-align:center;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><span style="font-size:21px;background-color:#3eaf7c;border-radius:3px;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;color:white;font-family:&quot;Helvetica Neue&quot;, Helvetica, Verdana, Arial, sans-serif;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;line-height:1.5;">JWT 的原理</span></h2><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">1.</span> <span style="font-size:14pt;font-weight:bold;">用户提交用户名和密码给客户端进行验证，如果登陆成功，使用 JWT 创建一个 token，并且返回给用户</span></div><div><span style="font-size:14pt;"><br></span></div><ul><li><div>jwt 生成的 token 是由三段字符串组成的，并且用 “.” 连接起来</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="color:rgb(227, 0, 0);">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</font>.<font style="color:rgb(186, 0, 255);">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ</font>.<font style="color:rgb(26, 173, 224);">SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</font></div></div><div><br></div><ul><li><div><span style="font-weight:bold;">第一段字符串: HEADER 部分 </span></div></li></ul><div><br></div><ul><ul><li><div>内容包括: 算法类型 和 token 类型</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#E30000">{</font></div><div><font color="#E30000">  &quot;alg&quot;: &quot;HS256&quot;, </font> <font color="#41AD1C"># 算法类型</font></div><div><font color="#E30000">  &quot;typ&quot;: &quot;JWT&quot; </font> <font color="#41AD1C"># token 类型</font></div><div><font color="#E30000">}</font></div></div><div><br></div><ul><ul><li><div>然后，对 HEADER 部分进行 base64url 加密，然后得到第一部分的字符串（密文）</div></li></ul></ul><div><br></div><ul><ul><ul><li><div>base64url 加密是先做 base64加密，然后再将 - 替代 + 及 _ 替代 / 。</div></li></ul></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#E30000">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</font></div></div><div><br></div><ul><li><div><span style="font-weight:bold;">第二段字符串: PAYLOAD 部分</span></div></li></ul><div><br></div><ul><ul><li><div>一般存储着自定义的内容（即: 想返回给前端的内容）</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#BA00FF">{</font></div><div><font color="#BA00FF">  &quot;id&quot;: &quot;1&quot;,</font></div><div><font color="#BA00FF">  &quot;name&quot;: &quot;Kevin&quot;,</font></div><div><font color="#BA00FF">  &quot;exp&quot;: 1516239022 </font> <font color="#41AD1C"># token 的超时时间，一般都要有该属性</font></div><div><font color="#BA00FF">  ...</font></div><div><font color="#BA00FF">}</font></div></div><div><br></div><ul><ul><li><div>然后，对 PAYLOAD 部分进行 base64url 加密，然后得到第二部分的字符串（密文）</div></li></ul></ul><div><br></div><ul><ul><ul><li><div>base64url 加密是先做 base64加密，然后再将 - 替代 + 及 _ 替代 / 。</div></li></ul></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#BA00FF">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ</font></div></div><div><br></div><ul><li><div><span style="font-weight:bold;">第三段字符串: SIGNATURE 部分</span></div></li></ul><div><br></div><ul><ul><li><div>第一步: 将 <span style="color:rgb(227, 0, 0);">第一段密文 </span>和 <span style="color:rgb(186, 0, 255);">第二段密文 </span>用 “.” 拼接起来</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color:rgb(227, 0, 0);">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span>.<span style="color:rgb(186, 0, 255);">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ</span></div></div><div><br></div><ul><ul><li><div>第二步: 对第一步拼接后得到的字符串进行 HS256 加密 + 加盐</div></li></ul></ul><div><br></div><ul><ul><li><div>第三步: 对 HS256 加密后的密文再做 base64url 加密，然后得到第三部分的字符串（密文）</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#1AADE0">SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</font></div></div><div><br></div><ul><ul><li><div>jwt 的源码表现</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>base64url(</div><div>    HMACSHA256(</div><div>      base64UrlEncode(<font color="#E30000">header</font>) + &quot;.&quot; + base64UrlEncode(<font color="#BA00FF">payload</font>),</div><div>      your-256-bit-secret (秘钥加盐)</div><div>    )</div><div>)</div></div><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">2.</span> <span style="font-size:14pt;font-weight:bold;">以后用户访问接口的时候都需要携带 token 进行访问，然后后端需要对 token 进行校验</span></div><div><span style="font-size:14pt;"><br></span></div><ul><li><div>校验 token 的第一步: 获取 token</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color:rgb(227, 0, 0);">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span>.<span style="color:rgb(186, 0, 255);">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ</span>.<span style="color:rgb(26, 173, 224);">SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span></div></div><div><br></div><ul><li><div>校验 token 的第二步: 以 “.” 作为分隔符对 token 进行分割</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>第一部分:<span style="color:rgb(227, 0, 0);"> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span></div><div><br></div><div>第二部分: <span style="color:rgb(186, 0, 255);">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ</span></div><div><br></div><div>第三部分: <span style="color:rgb(26, 173, 224);">SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span></div></div><div><br></div><ul><li><div>校验 token 的第三步: 对 token 的第二部分进行 base64url 解密，并获取到 PAYLOAD 信息（即: 自定义的内容信息，返回给前端的内容），然后检测 token 是否过期</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color:rgb(186, 0, 255);">{</span></div><div><span style="color:rgb(186, 0, 255);">  &quot;id&quot;: &quot;1&quot;,</span></div><div><span style="color:rgb(186, 0, 255);">  &quot;name&quot;: &quot;Kevin&quot;,</span></div><div><span style="color:rgb(186, 0, 255);">  &quot;exp&quot;: 1516239022 </span> <span style="color:rgb(65, 173, 28);"># token 的超时时间，一般都要有该属性</span></div><div><span style="color:rgb(186, 0, 255);">  ...</span></div><div><span style="color:rgb(186, 0, 255);">}</span></div></div><div><br></div><ul><li><div>校验 token 的第四步: </div></li></ul><div><br></div><ul><ul><li><div>第一步: 将 <span style="color:rgb(227, 0, 0);">token 的第一部分字符串</span> 和 <span style="color:rgb(186, 0, 255);">token 的第一部分字符串</span> 用 “.” 拼接起来</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color:rgb(227, 0, 0);">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span>.<span style="color:rgb(186, 0, 255);">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ</span></div></div><div><br></div><ul><ul><li><div>第二步: 对第一步拼接后得到的字符串进行 HS256 加密 + 加盐，得到 密文一</div></li></ul></ul><div><br></div><ul><ul><li><div>第三步: 对 token 的第三部分进行 base64url 解密，得到 密文二</div></li></ul></ul><div><br></div><ul><ul><li><div>第四步: 判断 密文一 和 密文二 是否相等，如果相等，表示 token 未被修改过（认证通过）</div></li></ul></ul><div><br></div><h2 style="margin:10px 0px 12px;padding:0px 0px 0px 15px;font-size:21px;background-color:#3eaf7c;border-radius:3px;text-align:center;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><span style="font-size:21px;background-color:#3eaf7c;border-radius:3px;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;color:white;font-family:&quot;Helvetica Neue&quot;, Helvetica, Verdana, Arial, sans-serif;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;line-height:1.5;">JWT 的使用</span></h2><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">1.</span> <span style="font-size:14pt;font-weight:bold;">JWT 的安装</span></div><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>pip3 install pyjwt -i https://pypi.douban.com/simple <font color="#41AD1C"># 使用豆瓣的镜像</font></div></div><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">2.</span> <span style="font-size:14pt;font-weight:bold;">JWT 的使用（未对代码进行封装处理）</span></div><div><span style="font-size:14pt;"><br></span></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#41AD1C"># views.py</font></div><div><br></div><div>from rest_framework.views import APIView</div><div>from rest_framework.response import Response</div><div>from app01 import models</div><div>from django.conf import settings</div><div><br></div><div>import <font color="#FA7A00">jwt</font></div><div>from jwt import <font color="#FA7A00">exceptions</font></div><div>import datetime</div><div><br></div><div><br></div><div>class LoginView(APIView):</div><div>    def post(self, request):</div><div>        username = request.data.get('username')</div><div>        password = request.data.get('password')</div><div><br></div><div>        user_obj = models.UserInfo.objects.filter(username=username, password=password).first()</div><div><br></div><div>        if not user_obj:</div><div>            return Response({'code': 1000, 'error': '用户名或密码错误'})</div><div><br></div><div><font color="#FA7A00"># -------------------- 使用 jwt 构造 token -----------------------</font></div><div><br></div><div><font color="#41AD1C"># 盐</font></div><div>        SALT = settings.SECRET_KEY</div><div><br></div><div><font color="#41AD1C"># 构造 header</font></div><div>        headers = {</div><div>            'typ': 'jwt',  <font color="#41AD1C"># token 类型</font></div><div>            'alg': 'HS256'  <font color="#41AD1C"># 算法类型</font></div><div>        }</div><div><br></div><div><font color="#41AD1C"># 构造 payload</font></div><div>        payload = {</div><div>            'user_id': user_obj.pk,  <font color="#41AD1C"># 自定义用户id</font></div><div>            'username': user_obj.username, <font color="#41AD1C"> # 自定义用户名</font></div><div>            'exp': datetime.datetime.utcnow() + datetime.timedelta(minutes=1)  <font color="#41AD1C"># token 超时时间</font></div><div>        }</div><div><br></div><div>        token = <font color="#FA7A00">jwt.encode</font>(</div><div>            headers=headers,  <font color="#41AD1C"># 头部信息</font></div><div>            payload=payload, <font color="#41AD1C"> # 自定义内容（即: 返回给前端的内容）</font></div><div>            key=SALT,  <font color="#41AD1C"># 盐，使用 django 配置文件中的 SECRET_KEY 作为盐</font></div><div>            algorithm=&quot;HS256&quot;,  <font color="#41AD1C"># 加密方式</font></div><div>        ).decode('utf-8')</div><div><br></div><div>        return Response({'code': 1001, 'token': token})</div><div><br></div><div><br></div><div>class OrderView(APIView):</div><div>    def get(self, request):</div><div><br></div><div><font color="#FA7A00"># -------------------- 使用 jwt 验证 token -----------------------</font></div><div><br></div><div><font color="#41AD1C"># 从 url 参数中获取 token</font></div><div>        token = request.query_params.get('token')</div><div><font color="#41AD1C"># 从 请求头 中获取 token</font></div><div><font color="#41AD1C">        #</font> token = request.META.get('HTTP_AUTHORIZATION')</div><div><br></div><div><font color="#41AD1C"># 盐</font></div><div>        SALT = settings.SECRET_KEY</div><div><br></div><div>        payload = None</div><div>        msg = ''</div><div>        try:</div><div><font color="#41AD1C"> # 验证 token 是否正确，如果 token 校验成功会返回 payload 中的内容（即: 自定义的内容）</font></div><div>            payload = <font color="#FA7A00">jwt.decode</font>(token, SALT, True)  <font color="#41AD1C"># True 表示进行 token 的校验</font></div><div>        except exceptions.ExpiredSignatureError:</div><div>            msg = 'token已失效（已过期）'</div><div>        except jwt.DecodeError:</div><div>            msg = 'token认证失败'</div><div>        except jwt.InvalidTokenError:</div><div>            msg = '非法的token'</div><div><br></div><div>        if not payload:</div><div>            return Response({'code': 1002, 'error': msg})</div><div><br></div><div>        return Response({'code': 1003, 'data': payload})</div></div><div><span style="font-size:14pt;"><br></span></div><div><span style="font-size:14pt;"><img data-filename="Image.png" src="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens_files/Image [1].png" type="image/png"></span></div><div><span style="font-size:14pt;"><br></span></div><div><span style="font-size:14pt;"><img data-filename="Image.png" src="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens_files/Image [2].png" type="image/png"></span></div><div><span style="font-size:14pt;"><br></span></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">3.</span> <span style="font-size:14pt;font-weight:bold;">JWT 的使用（对代码进行了封装处理）</span></div><div><br></div><ul><li><div>获取 token</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#41AD1C"># utils/auth_token.py</font></div><div><br></div><div>import jwt</div><div>import datetime</div><div>from django.conf import settings</div><div><br></div><div><br></div><div>def get_token(payload, timeout):</div><div><font color="#41AD1C">&quot;&quot;&quot;</font></div><div><font color="#41AD1C">    :param payload: 自定义的内容（即: 返回给前端的内容）</font></div><div><font color="#41AD1C">    :param timeout: 超时时间</font></div><div><font color="#41AD1C">    :return: token</font></div><div><font color="#41AD1C">    &quot;&quot;&quot;</font></div><div><br></div><div><font color="#41AD1C"> # 盐</font></div><div>    SALT = settings.SECRET_KEY</div><div><br></div><div><font color="#41AD1C"># 构造 header</font></div><div>    headers = {</div><div>        'typ': 'jwt',  # token 类型</div><div>        'alg': 'HS256'  # 算法类型</div><div>    }</div><div><br></div><div><font color="#41AD1C"># 将超时时间添加到 payload 中</font></div><div>    payload['exp'] = datetime.datetime.utcnow() + datetime.timedelta(minutes=timeout)  <font color="#41AD1C"># token 超时时间</font></div><div><br></div><div>    token = jwt.encode(</div><div>        headers=headers,  <font color="#41AD1C"># 头部信息</font></div><div>        payload=payload,  <font color="#41AD1C"># 自定义内容（即: 返回给前端的内容）</font></div><div>        key=SALT,  <font color="#41AD1C"># 盐，使用 django 配置文件中的 SECRET_KEY 作为盐</font></div><div>        algorithm=&quot;HS256&quot;,  <font color="#41AD1C"># 加密方式</font></div><div>    ).decode('utf-8')</div><div><br></div><div>    return token</div></div><div><br></div><ul><li><div>token 的校验</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#41AD1C"># extensions/auth.py</font></div><div><br></div><div>from rest_framework.authentication import BaseAuthentication</div><div>from rest_framework import exceptions as rf_exceptions</div><div><br></div><div>import jwt</div><div>from jwt import exceptions as jwt_exceptions</div><div>from django.conf import settings</div><div><br></div><div><br></div><div>class TokenAuth(BaseAuthentication):</div><div>    def authenticate(self, request):</div><div><br></div><div><font color="#41AD1C"> # 从 url 参数中获取 token</font></div><div>        token = request.query_params.get('token')</div><div><font color="#41AD1C"># 从 请求头 中获取 token</font></div><div><font color="#41AD1C"># </font>token = request.META.get('HTTP_AUTHORIZATION')</div><div><br></div><div><font color="#41AD1C"># 盐</font></div><div>        SALT = settings.SECRET_KEY</div><div><br></div><div>        try:</div><div><font color="#41AD1C"># 验证 token 是否正确，如果 token 校验成功会返回 payload 中的内容（即: 自定义的内容）</font></div><div>            payload = jwt.decode(token, SALT, True)  <font color="#41AD1C"># True 表示进行 token 的校验</font></div><div><br></div><div><font color="#FA7A00">return payload, token</font></div><div><br></div><div>        except jwt_exceptions.ExpiredSignatureError:</div><div>            raise rf_exceptions.AuthenticationFailed({'code': 1003, 'msg': 'token已失效（已过期）'})</div><div><br></div><div>        except jwt.DecodeError:</div><div>            raise rf_exceptions.AuthenticationFailed({'code': 1004, 'msg': 'token认证失败'})</div><div><br></div><div>        except jwt.InvalidTokenError:</div><div>            raise rf_exceptions.AuthenticationFailed({'code': 1005, 'msg': '非法的token'})</div></div><div><br></div><ul><li><div>视图</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#41AD1C"># views.py</font></div><div><br></div><div>from rest_framework.views import APIView</div><div>from rest_framework.response import Response</div><div>from app01 import models</div><div><br></div><div>from app01.utils.auth_token import <font color="#FA7A00">get_token</font></div><div>from app01.extensions.auth import <font color="#FA7A00">TokenAuth</font></div><div><br></div><div><br></div><div>class LoginView(APIView):</div><div>    def post(self, request):</div><div>        username = request.data.get('username')</div><div>        password = request.data.get('password')</div><div><br></div><div>        user_obj = models.UserInfo.objects.filter(username=username, password=password).first()</div><div><br></div><div>        if not user_obj:</div><div>            return Response({'code': 1000, 'error': '用户名或密码错误'})</div><div><br></div><div><font color="#41AD1C"># 获取 token</font></div><div>        token = <font color="#FA7A00">get_token</font>({</div><div>            'user_id': user_obj.pk,  <font color="#41AD1C"># 自定义用户id</font></div><div>            'username': user_obj.username,  <font color="#41AD1C"># 自定义用户名</font></div><div>        }, 1)</div><div><br></div><div>        return Response({'code': 1001, 'token': token})</div><div><br></div><div><br></div><div>class OrderView(APIView):</div><div>    authentication_classes = [<font color="#FA7A00">TokenAuth</font>]</div><div><br></div><div>    def get(self, request):</div><div>        return Response({</div><div>            'code': 1006,</div><div>            'data': {</div><div>                'user_id': request.user['user_id'],</div><div>                'username': request.user['username']</div><div>            }</div><div>        })</div></div><div><br></div></div><div><img data-filename="Image.png" src="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens_files/Image [3].png" type="image/png"></div><div><br></div><div><img data-filename="Image.png" src="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens_files/Image [4].png" type="image/png"></div><div><br></div><h2 style="margin:10px 0px 12px;padding:0px 0px 0px 15px;font-size:21px;background-color:#3eaf7c;border-radius:3px;text-align:center;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><span style="font-size:21px;color:white;font-family:&quot;Helvetica Neue&quot;, Helvetica, Verdana, Arial, sans-serif;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;line-height:1.5;">JWT 刷新 Token 的思路与实现</span></h2><div><br></div><div><a href="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens_files/auto_jwt_demo.rar"><img alt="auto_jwt_demo.rar" src="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens_files/e4bc678948d367903e61a342014e35d4.png"></a></div><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">1.</span> <span style="font-size:14pt;font-weight:bold;">思路</span></div><div><span style="font-size:14pt;"><br></span></div><ul><li><div>准备两个 token</div></li></ul><div><br></div><ul><ul><li><div>token（过期时间短） -&gt; 用于平常的验证过期</div></li></ul></ul><div><br></div><ul><ul><li><div>refresh_token（过期时间长） -&gt; refresh_token 用于当 token 过期时，换取新的 token 值，以及一个新的 refresh_token 值</div></li></ul></ul><div><br></div><ul><li><div>当客户端在发送请求前，需要检测 token 是否过期</div></li></ul><div><br></div><ul><ul><li><div>情况一: 当 token 没有过期，继续发送请求</div></li></ul></ul><div><br></div><ul><ul><li><div>情况二: 当 token 已过期，发送刷新 token 的请求，根据返回的状态码进行判断是否继续请求或重新登陆</div></li></ul></ul><div><br></div><ul><ul><ul><li><div>① 如果后端检测 refresh_token 正确且没有过期，返回正确的状态码，然后前端更新 Vuex 中的 token 继续发送请求</div></li></ul></ul></ul><div><br></div><ul><ul><ul><li><div>② 如果后端检测 refresh_token 错误或者过期，返回错确的状态码，然后前端需要重新登陆获取 token</div></li></ul></ul></ul><div><br></div><ul><li><div>当服务端接收到 token 时</div></li></ul><div><br></div><ul><ul><li><div>情况一: 当 token 正确且没有过期，返回对应的数据信息</div></li></ul></ul><div><br></div><ul><ul><li><div>情况二: 当 token 错误或者过期，返回错误的数据信息</div></li></ul></ul><div><br></div><ul><li><div>当服务端刷新 token 是</div></li></ul><div><br></div><ul><ul><li><div>情况一: 当 refresh_token 正确且没有过期，返回新的 token、refresh_token、token 过期时间 </div></li></ul></ul><div><br></div><ul><ul><li><div>情况二: 当 refresh_token 错误或者过期，返回错误的数据信息</div></li></ul></ul><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">2.</span> <span style="font-size:14pt;font-weight:bold;">后端</span><span style="font-size:14pt;font-weight:bold;">实现</span></div><div><br></div><ul><li><div>获取 token 和 token 过期时间</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#41AD1C"># utils/auth_token.py</font></div><div><br></div><div>import jwt</div><div>import datetime</div><div>from django.conf import settings</div><div><br></div><div><br></div><div>class MyToken(object):</div><div>    def __init__(self):</div><div>        self.typ = 'jwt'  <font color="#41AD1C"># token 类型</font></div><div>        self.alg = &quot;HS256&quot;  <font color="#41AD1C"># 算法类型</font></div><div>        self.SALT = settings.SECRET_KEY  <font color="#41AD1C"># 盐，使用 django 配置文件中的 SECRET_KEY 作为盐</font></div><div><br></div><div><font color="#41AD1C"> # 获取 token 超时时间</font></div><div>    def get_token_time(self, time_type, exp, is_utc=True):</div><div>        if is_utc:</div><div>            not_time = datetime.datetime.utcnow()</div><div>        else:</div><div>            not_time = datetime.datetime.now()</div><div>        if time_type == 'days':</div><div>            return not_time + datetime.timedelta(days=exp)</div><div>        elif time_type == 'hours':</div><div>            return not_time + datetime.timedelta(hours=exp)</div><div>        elif time_type == 'minutes':</div><div>            return not_time + datetime.timedelta(minutes=exp)</div><div>        elif time_type == 'seconds':</div><div>            return not_time + datetime.timedelta(seconds=exp)</div><div><br></div><div><font color="#41AD1C"># 获取 token 信息（包括: token、token 过期时间）</font></div><div>    def get_token_info(self, payload, time_type, exp):</div><div><font color="#41AD1C"># 构造 header</font></div><div>        headers = {</div><div>            'typ': self.typ,  <font color="#41AD1C"># token 类型</font></div><div>            'alg': self.alg  <font color="#41AD1C"># 算法类型</font></div><div>        }</div><div><br></div><div><font color="#41AD1C"># 将超时时间添加到 payload 中</font></div><div>        payload['exp'] = self.get_token_time(time_type, exp)  <font color="#41AD1C"># token 超时时间</font></div><div><br></div><div><font color="#41AD1C"># 获取不是 utc 的 token 超时时间</font></div><div>        token_time = self.get_token_time(time_type, exp, is_utc=False)</div><div><br></div><div>        token = jwt.encode(</div><div>            headers=headers,  <font color="#41AD1C"># 头部信息</font></div><div>            payload=payload,  <font color="#41AD1C"># 自定义内容（即: 返回给前端的内容）</font></div><div>            key=self.SALT,  <font color="#41AD1C"># 盐，使用 django 配置文件中的 SECRET_KEY 作为盐</font></div><div>            algorithm=self.alg,  <font color="#41AD1C"># 加密方式</font></div><div>        ).decode('utf-8')</div><div><br></div><div>        return {</div><div>            'token': token,  <font color="#41AD1C"># token</font></div><div>            'token_time': token_time  <font color="#41AD1C"># token 过期时间</font></div><div>        }</div></div><div><br></div><ul><li><div>token 的校验</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color:rgb(65, 173, 28);"># extensions/auth.py</span></div><div><br></div><div>from rest_framework.authentication import BaseAuthentication</div><div>from rest_framework import exceptions as rf_exceptions</div><div><br></div><div>import jwt</div><div>from jwt import exceptions as jwt_exceptions</div><div>from django.conf import settings</div><div><br></div><div><br></div><div>class TokenAuth(BaseAuthentication):</div><div>    def authenticate(self, request):</div><div><br></div><div><span style="color:rgb(65, 173, 28);"> # 从 url 参数中获取 token</span></div><div>        token = request.query_params.get('token')</div><div><span style="color:rgb(65, 173, 28);"># 从 请求头 中获取 token</span></div><div><span style="color:rgb(65, 173, 28);"># </span>token = request.META.get('HTTP_AUTHORIZATION')</div><div><br></div><div><span style="color:rgb(65, 173, 28);"># 盐</span></div><div>        SALT = settings.SECRET_KEY</div><div><br></div><div>        try:</div><div><span style="color:rgb(65, 173, 28);"># 验证 token 是否正确，如果 token 校验成功会返回 payload 中的内容（即: 自定义的内容）</span></div><div>            payload = jwt.decode(token, SALT, True)  <span style="color:rgb(65, 173, 28);"># True 表示进行 token 的校验</span></div><div><br></div><div><span style="color:rgb(250, 122, 0);">return payload, token</span></div><div><br></div><div>        except jwt_exceptions.ExpiredSignatureError:</div><div>            raise rf_exceptions.AuthenticationFailed({'code': 1003, 'msg': 'token已失效（已过期）'})</div><div><br></div><div>        except jwt.DecodeError:</div><div>            raise rf_exceptions.AuthenticationFailed({'code': 1004, 'msg': 'token认证失败'})</div><div><br></div><div>        except jwt.InvalidTokenError:</div><div>            raise rf_exceptions.AuthenticationFailed({'code': 1005, 'msg': '非法的token'})</div></div><div><br></div><ul><li><div>视图</div></li></ul><div><br></div></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size:9pt;font-family:Monaco;"><font color="#41AD1C"># views.py</font></span></div><div><span style="font-size:9pt;color:rgb(51, 51, 51);font-family:Monaco;"><br></span></div><div>from rest_framework.views import APIView</div><div>from rest_framework.response import Response</div><div>from api import models</div><div><br></div><div>from api.utils.auth_token import MyToken</div><div>from api.extensions.auth import TokenAuth</div><div><br></div><div>import jwt</div><div>from jwt import exceptions</div><div>from django.conf import settings</div><div><br></div><div><br></div><div><font color="#41AD1C"># 登陆</font></div><div>class LoginView(APIView):</div><div>    def post(self, request):</div><div>        username = request.data.get('username')</div><div>        password = request.data.get('password')</div><div><br></div><div>        user_obj = models.UserInfo.objects.filter(username=username, password=password).first()</div><div><br></div><div>        if not user_obj:</div><div>            return Response({'code': 1000, 'error': '用户名或密码错误'})</div><div><br></div><div><font color="#41AD1C"># 获取 token</font></div><div>        my_token = MyToken()</div><div><br></div><div><font color="#41AD1C"> # 短时间的 token，用于校验 token</font></div><div>        token_info = my_token.get_token_info(</div><div>            payload={</div><div>                'user_id': user_obj.pk,  # 自定义用户id</div><div>                'username': user_obj.username,  # 自定义用户名</div><div>            },</div><div>            time_type='seconds',</div><div>            exp=3</div><div>        )</div><div><br></div><div><font color="#41AD1C"> # 长时间的 token，用于更新 token</font></div><div>        refresh_token_info = my_token.get_token_info(</div><div>            payload={</div><div>                'user_id': user_obj.pk,  # 自定义用户id</div><div>                'username': user_obj.username,  # 自定义用户名</div><div>            },</div><div>            time_type='seconds',</div><div>            exp=5</div><div>        )</div><div><br></div><div>        return Response({'code': 1001, 'data': {</div><div>            'token': token_info['token'],</div><div>            'refresh_token': refresh_token_info['token'],</div><div>            'token_time': token_info['token_time'],</div><div>        '+'}'+'}'}})</div><div><br></div><div><br></div><div><font color="#41AD1C"># 更新 Token</font></div><div>class UpdateTokenView(APIView):</div><div>    def post(self, request):</div><div><font color="#41AD1C"># 获取请求头中 token</font></div><div>        refresh_token = request.META.get('HTTP_REFRESHAUTHORIZATION')</div><div><br></div><div><font color="#41AD1C"># 盐</font></div><div>        SALT = settings.SECRET_KEY</div><div><br></div><div>        payload = None</div><div>        msg = ''</div><div><br></div><div>        try:</div><div><font color="#41AD1C"># 验证 token 是否正确，如果 token 校验成功会返回 payload 中的内容（即: 自定义的内容）</font></div><div>            payload = jwt.decode(refresh_token, SALT, True)  <font color="#41AD1C"># True 表示进行 token 的校验</font></div><div><br></div><div><font color="#41AD1C"># 获取 token</font></div><div>            my_token = MyToken()</div><div><br></div><div><font color="#41AD1C"> # 短时间的 token，用于校验 token</font></div><div>            token_info = my_token.get_token_info(</div><div>                payload={</div><div>                    'user_id': payload['user_id'],  <font color="#41AD1C"># 自定义用户id</font></div><div>                    'username': payload['username'],  <font color="#41AD1C"># 自定义用户名</font></div><div>                },</div><div>                time_type='seconds',</div><div>                exp=3</div><div>            )</div><div><br></div><div><font color="#41AD1C"> # 长时间的 token，用于更新 token</font></div><div>            refresh_token_info = my_token.get_token_info(</div><div>                payload={</div><div>                    'user_id': payload['user_id'],  <font color="#41AD1C"># 自定义用户id</font></div><div>                    'username': payload['username'],  <font color="#41AD1C"># 自定义用户名</font></div><div>                },</div><div>                time_type='seconds',</div><div>                exp=5</div><div>            )</div><div><br></div><div>            return Response({</div><div>                'code': 1007,</div><div>                'data': {</div><div>                    'token': token_info['token'],</div><div>                    'refresh_token': refresh_token_info['token'],</div><div>                    'token_time': token_info['token_time'],</div><div>                }</div><div>            })</div><div><br></div><div>        except exceptions.ExpiredSignatureError:</div><div>            msg = 'token已失效（已过期）'</div><div>        except jwt.DecodeError:</div><div>            msg = 'token认证失败'</div><div>        except jwt.InvalidTokenError:</div><div>            msg = '非法的token'</div><div><br></div><div>        if not payload:</div><div>            return Response({'code': 1008, 'error': msg})</div><div><br></div><div><br></div><div><font color="#41AD1C"># 订单</font></div><div>class OrderView(APIView):</div><div>    authentication_classes = [TokenAuth]</div><div><br></div><div>    def get(self, request):</div><div>        return Response({</div><div>            'code': 1006,</div><div>            'data': '订单数据'</div><div>        })</div></div><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">2.</span> <span style="font-size:14pt;font-weight:bold;">前端</span><span style="font-size:14pt;font-weight:bold;">实现（Vue）</span></div><div><br></div><ul><li><div>通过 axios 拦截器进行实现，在每次请求前验证 token 是否过期，如果已过期那么就刷新 token 后再发送请求</div></li></ul><div><br></div><ul><li><div>注意: 如果出现了跨域问题，一定要用前端方法进行解决，不要使用后端方法进行解决，否则会没有效果</div></li></ul><div><br></div><ul><li><div>使用前需要修改的地方</div></li></ul><div><br></div><ul><ul><li><div>拦截器中的白名单</div></li></ul></ul><div><br></div><ul><ul><li><div>拦截器中的刷新token的请求网址</div></li></ul></ul><div><br></div><ul><ul><li><div>拦截器中刷新token请求成功后返回的状态码</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#41AD1C"># src/api/ajax.js</font></div><div><br></div><div>import axios from 'axios'</div><div>import store from '../store'</div><div>import this_vue from '../main'</div><div>import {RECEIVE_TOKEN} from &quot;../store/mutations-types&quot;;</div><div><br></div><div><font color="#41AD1C">// axios.defaults.baseURL = 'http://127.0.0.1:8010/api';</font></div><div>axios.defaults.baseURL = `./api`;</div><div><br></div><div><font color="#41AD1C">// axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';</font></div><div><br></div><div>export default function (url, data = {}, type = &quot;GET&quot;) {</div><div>    return new Promise((resolve, reject) =&gt; {</div><div>        let promise;</div><div><br></div><div><font color="#41AD1C"></font><font color="#FA7A00">// 获取token的相关信息</font></div><div>        const token = store.state.token;</div><div>        const refresh_token = store.state.refresh_token;</div><div>        const token_time = store.state.token_time;</div><div><br></div><div><font color="#41AD1C"></font><font color="#FA7A00">// axios 取消请求的相关参数</font></div><div>        const CancelToken = axios.CancelToken;</div><div>        const source = CancelToken.source();</div><div><br></div><div><font color="#41AD1C"></font><font color="#FA7A00">// 每次请求都携带token</font></div><div>        axios.defaults.headers.common['Authorization'] = token;</div><div>        axios.defaults.headers.common['RefreshAuthorization'] = refresh_token;</div><div><br></div><div><font color="#FA7A00">// axios 请求拦截器</font></div><div>        let myInterceptor = axios.interceptors.request.use(async config =&gt; {</div><div><br></div><div><font color="#41AD1C">// 白名单</font></div><div>            let whitelist = [</div><div>                '/login/',</div><div>                '/update_token/',</div><div>            ];</div><div><br></div><div>            if (token &amp;&amp; whitelist.indexOf(config.url) == -1) {</div><div><br></div><div>                let token_time_obj = new Date(token_time); <font color="#41AD1C">// token 过期时间的时间戳</font></div><div>                let this_time_obj = new Date(); <font color="#41AD1C">// 当前时间的时间戳</font></div><div><br></div><div><font color="#41AD1C">// 如果当前时间大于token过期时间那么就刷新 token</font></div><div>                if (token_time_obj.getTime() &lt; this_time_obj.getTime()) {</div><div><font color="#41AD1C">// 请求刷新 token 的接口</font></div><div>                    let response = await axios.post('/update_token/');</div><div>                    let res = response.data;</div><div>                    if (res.code == '1007') {</div><div>                        this_vue.$store.commit(RECEIVE_TOKEN, {</div><div>                            token: res.data.token,</div><div>                            refresh_token: res.data.refresh_token,</div><div>                            token_time: res.data.token_time</div><div>                        });</div><div>                        config.headers.Authorization = res.data.token;</div><div>                        config.headers.RefreshAuthorization = res.data.refresh_token;</div><div>                        return config;</div><div>                    } else {</div><div><font color="#41AD1C">// 如果连 refresh_token 都过期，那么就需要重新登陆</font></div><div>                        config.cancelToken = source.token;</div><div>                        source.cancel('token已过期，请重新登陆');</div><div>                        this_vue.$router.replace({path: 'login'});</div><div>                        return config</div><div>                    }</div><div>                } else {</div><div>                    return config;</div><div>                }</div><div>            } else {</div><div>                return config;</div><div>            }</div><div><br></div><div>        }, error =&gt; {</div><div><font color="#41AD1C"> // 对请求错误做些什么</font></div><div>            return Promise.reject(error);</div><div>        });</div><div><br></div><div><font color="#41AD1C"> // 请求</font></div><div>        if (type === 'GET') {</div><div>            let dataStr = '';</div><div>            Object.keys(data).forEach(key =&gt; {</div><div>                dataStr += key + '=' + data[key] + '&amp;';</div><div>            });</div><div>            if (dataStr !== '') {</div><div>                dataStr = dataStr.substring(0, dataStr.lastIndexOf('&amp;'));</div><div>                url += '?' + dataStr;</div><div>            }</div><div>            promise = axios.get(url)</div><div>        } else {</div><div>            let type_lower = type.toLowerCase();</div><div>            promise = axios[type_lower](url, data)</div><div>        }</div><div><br></div><div><font color="#FA7A00">// 移除 axios 拦截器</font></div><div>        axios.interceptors.request.eject(myInterceptor);</div><div><br></div><div>        promise.then((response) =&gt; {</div><div>            resolve(response.data);</div><div>        }).catch((error) =&gt; {</div><div>            resolve(error);</div><div>        })</div><div>    });</div><div>}</div></div><div><br></div><div><br></div><div><br></div></div><div><br></div></span></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/kevin-blog/Django Rest-Framework/ModelSerializer 序列化组件.html">
        ModelSerializer 序列化组件
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/kevin-blog/assets/js/app.dd46475d.js" defer></script><script src="/kevin-blog/assets/js/2.97d04891.js" defer></script><script src="/kevin-blog/assets/js/29.37ea8137.js" defer></script>
  </body>
</html>
