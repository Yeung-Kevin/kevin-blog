<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nginx 负载均衡 | Kevin-Blog</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/kevin-blog/logo.png">
    <meta name="description" content="">
    <link rel="preload" href="/kevin-blog/assets/css/0.styles.267bc68b.css" as="style"><link rel="preload" href="/kevin-blog/assets/js/app.dd46475d.js" as="script"><link rel="preload" href="/kevin-blog/assets/js/2.97d04891.js" as="script"><link rel="preload" href="/kevin-blog/assets/js/143.2e682c5b.js" as="script"><link rel="prefetch" href="/kevin-blog/assets/js/10.2b686438.js"><link rel="prefetch" href="/kevin-blog/assets/js/100.cfc5acd5.js"><link rel="prefetch" href="/kevin-blog/assets/js/101.628bd39e.js"><link rel="prefetch" href="/kevin-blog/assets/js/102.41585307.js"><link rel="prefetch" href="/kevin-blog/assets/js/103.5d18350a.js"><link rel="prefetch" href="/kevin-blog/assets/js/104.85cd65cf.js"><link rel="prefetch" href="/kevin-blog/assets/js/105.9d303bac.js"><link rel="prefetch" href="/kevin-blog/assets/js/106.73f6a263.js"><link rel="prefetch" href="/kevin-blog/assets/js/107.9dfe114c.js"><link rel="prefetch" href="/kevin-blog/assets/js/108.315e8c63.js"><link rel="prefetch" href="/kevin-blog/assets/js/109.ef21ffa0.js"><link rel="prefetch" href="/kevin-blog/assets/js/11.2b0f6358.js"><link rel="prefetch" href="/kevin-blog/assets/js/110.dfe062a3.js"><link rel="prefetch" href="/kevin-blog/assets/js/111.08f0c3e7.js"><link rel="prefetch" href="/kevin-blog/assets/js/112.0e180f10.js"><link rel="prefetch" href="/kevin-blog/assets/js/113.295f1fca.js"><link rel="prefetch" href="/kevin-blog/assets/js/114.5645d09d.js"><link rel="prefetch" href="/kevin-blog/assets/js/115.ebe19212.js"><link rel="prefetch" href="/kevin-blog/assets/js/116.b3eb5cab.js"><link rel="prefetch" href="/kevin-blog/assets/js/117.076c6372.js"><link rel="prefetch" href="/kevin-blog/assets/js/118.226fb513.js"><link rel="prefetch" href="/kevin-blog/assets/js/119.298c0302.js"><link rel="prefetch" href="/kevin-blog/assets/js/12.01390043.js"><link rel="prefetch" href="/kevin-blog/assets/js/120.943d0d71.js"><link rel="prefetch" href="/kevin-blog/assets/js/121.2d1bd8ef.js"><link rel="prefetch" href="/kevin-blog/assets/js/122.84b9dff1.js"><link rel="prefetch" href="/kevin-blog/assets/js/123.85d93d87.js"><link rel="prefetch" href="/kevin-blog/assets/js/124.4913aefd.js"><link rel="prefetch" href="/kevin-blog/assets/js/125.cf667169.js"><link rel="prefetch" href="/kevin-blog/assets/js/126.eefd3250.js"><link rel="prefetch" href="/kevin-blog/assets/js/127.f9697daf.js"><link rel="prefetch" href="/kevin-blog/assets/js/128.aff6033d.js"><link rel="prefetch" href="/kevin-blog/assets/js/129.fa7ec9a8.js"><link rel="prefetch" href="/kevin-blog/assets/js/13.e55a4126.js"><link rel="prefetch" href="/kevin-blog/assets/js/130.9d50b78d.js"><link rel="prefetch" href="/kevin-blog/assets/js/131.f384aa34.js"><link rel="prefetch" href="/kevin-blog/assets/js/132.e60091dc.js"><link rel="prefetch" href="/kevin-blog/assets/js/133.09a9de16.js"><link rel="prefetch" href="/kevin-blog/assets/js/134.a7739a99.js"><link rel="prefetch" href="/kevin-blog/assets/js/135.bea491db.js"><link rel="prefetch" href="/kevin-blog/assets/js/136.92af3a82.js"><link rel="prefetch" href="/kevin-blog/assets/js/137.dbda7b02.js"><link rel="prefetch" href="/kevin-blog/assets/js/138.9fea4ca4.js"><link rel="prefetch" href="/kevin-blog/assets/js/139.0a81aff9.js"><link rel="prefetch" href="/kevin-blog/assets/js/14.efd69f3b.js"><link rel="prefetch" href="/kevin-blog/assets/js/140.3f048218.js"><link rel="prefetch" href="/kevin-blog/assets/js/141.002d7568.js"><link rel="prefetch" href="/kevin-blog/assets/js/142.aec10062.js"><link rel="prefetch" href="/kevin-blog/assets/js/144.d05092f0.js"><link rel="prefetch" href="/kevin-blog/assets/js/145.358437b8.js"><link rel="prefetch" href="/kevin-blog/assets/js/146.af219f24.js"><link rel="prefetch" href="/kevin-blog/assets/js/147.061cb5fe.js"><link rel="prefetch" href="/kevin-blog/assets/js/148.422d1f87.js"><link rel="prefetch" href="/kevin-blog/assets/js/149.c97f27f4.js"><link rel="prefetch" href="/kevin-blog/assets/js/15.271f58eb.js"><link rel="prefetch" href="/kevin-blog/assets/js/150.177533a9.js"><link rel="prefetch" href="/kevin-blog/assets/js/151.d70f314c.js"><link rel="prefetch" href="/kevin-blog/assets/js/152.ca40e6fc.js"><link rel="prefetch" href="/kevin-blog/assets/js/153.a2bca317.js"><link rel="prefetch" href="/kevin-blog/assets/js/154.22edbf9f.js"><link rel="prefetch" href="/kevin-blog/assets/js/155.e59b2d87.js"><link rel="prefetch" href="/kevin-blog/assets/js/156.d5a38de8.js"><link rel="prefetch" href="/kevin-blog/assets/js/157.cbe5199a.js"><link rel="prefetch" href="/kevin-blog/assets/js/158.31c5b8b2.js"><link rel="prefetch" href="/kevin-blog/assets/js/159.0763ed0c.js"><link rel="prefetch" href="/kevin-blog/assets/js/16.e92cdd55.js"><link rel="prefetch" href="/kevin-blog/assets/js/160.a05ced02.js"><link rel="prefetch" href="/kevin-blog/assets/js/161.7e52ed13.js"><link rel="prefetch" href="/kevin-blog/assets/js/162.f5df7208.js"><link rel="prefetch" href="/kevin-blog/assets/js/163.78a78de8.js"><link rel="prefetch" href="/kevin-blog/assets/js/164.54fd347c.js"><link rel="prefetch" href="/kevin-blog/assets/js/165.a0347ed3.js"><link rel="prefetch" href="/kevin-blog/assets/js/166.0702e96e.js"><link rel="prefetch" href="/kevin-blog/assets/js/167.69136cd0.js"><link rel="prefetch" href="/kevin-blog/assets/js/168.d0aa7e0d.js"><link rel="prefetch" href="/kevin-blog/assets/js/169.6229f0ca.js"><link rel="prefetch" href="/kevin-blog/assets/js/17.9a006e5d.js"><link rel="prefetch" href="/kevin-blog/assets/js/170.b6571721.js"><link rel="prefetch" href="/kevin-blog/assets/js/171.600f9683.js"><link rel="prefetch" href="/kevin-blog/assets/js/172.6e1792a7.js"><link rel="prefetch" href="/kevin-blog/assets/js/173.cef126b3.js"><link rel="prefetch" href="/kevin-blog/assets/js/174.97b3e897.js"><link rel="prefetch" href="/kevin-blog/assets/js/175.fcefca30.js"><link rel="prefetch" href="/kevin-blog/assets/js/176.31862a66.js"><link rel="prefetch" href="/kevin-blog/assets/js/177.089b09c0.js"><link rel="prefetch" href="/kevin-blog/assets/js/178.a5dcd25c.js"><link rel="prefetch" href="/kevin-blog/assets/js/179.a9d685f2.js"><link rel="prefetch" href="/kevin-blog/assets/js/18.a1c24192.js"><link rel="prefetch" href="/kevin-blog/assets/js/180.4ad69266.js"><link rel="prefetch" href="/kevin-blog/assets/js/181.691d48a2.js"><link rel="prefetch" href="/kevin-blog/assets/js/182.e77aa679.js"><link rel="prefetch" href="/kevin-blog/assets/js/183.2b4341f4.js"><link rel="prefetch" href="/kevin-blog/assets/js/184.b3610e8b.js"><link rel="prefetch" href="/kevin-blog/assets/js/185.08107897.js"><link rel="prefetch" href="/kevin-blog/assets/js/186.9f5a3f65.js"><link rel="prefetch" href="/kevin-blog/assets/js/187.ac2fe2c2.js"><link rel="prefetch" href="/kevin-blog/assets/js/188.09023a78.js"><link rel="prefetch" href="/kevin-blog/assets/js/189.409b4ed0.js"><link rel="prefetch" href="/kevin-blog/assets/js/19.c733cdfe.js"><link rel="prefetch" href="/kevin-blog/assets/js/190.ca5d775c.js"><link rel="prefetch" href="/kevin-blog/assets/js/191.8052fe42.js"><link rel="prefetch" href="/kevin-blog/assets/js/192.31ebe059.js"><link rel="prefetch" href="/kevin-blog/assets/js/193.9bf32e11.js"><link rel="prefetch" href="/kevin-blog/assets/js/194.0667554a.js"><link rel="prefetch" href="/kevin-blog/assets/js/195.ea249ba4.js"><link rel="prefetch" href="/kevin-blog/assets/js/196.6278ec5a.js"><link rel="prefetch" href="/kevin-blog/assets/js/197.90f6af7b.js"><link rel="prefetch" href="/kevin-blog/assets/js/198.2e358b6a.js"><link rel="prefetch" href="/kevin-blog/assets/js/199.a0bd0085.js"><link rel="prefetch" href="/kevin-blog/assets/js/20.890583ea.js"><link rel="prefetch" href="/kevin-blog/assets/js/200.bc1e237a.js"><link rel="prefetch" href="/kevin-blog/assets/js/201.767e166e.js"><link rel="prefetch" href="/kevin-blog/assets/js/202.a52f0e94.js"><link rel="prefetch" href="/kevin-blog/assets/js/203.06f0ebab.js"><link rel="prefetch" href="/kevin-blog/assets/js/204.7ae45191.js"><link rel="prefetch" href="/kevin-blog/assets/js/205.b8412fbc.js"><link rel="prefetch" href="/kevin-blog/assets/js/206.682f9a3e.js"><link rel="prefetch" href="/kevin-blog/assets/js/207.8978346c.js"><link rel="prefetch" href="/kevin-blog/assets/js/208.35db8c05.js"><link rel="prefetch" href="/kevin-blog/assets/js/209.1eebeab0.js"><link rel="prefetch" href="/kevin-blog/assets/js/21.48328b6a.js"><link rel="prefetch" href="/kevin-blog/assets/js/210.b56db64f.js"><link rel="prefetch" href="/kevin-blog/assets/js/211.31da36f5.js"><link rel="prefetch" href="/kevin-blog/assets/js/212.2f2d2d1f.js"><link rel="prefetch" href="/kevin-blog/assets/js/213.be55b8cc.js"><link rel="prefetch" href="/kevin-blog/assets/js/214.aeffc247.js"><link rel="prefetch" href="/kevin-blog/assets/js/215.137bae15.js"><link rel="prefetch" href="/kevin-blog/assets/js/216.2692c636.js"><link rel="prefetch" href="/kevin-blog/assets/js/217.a6a9cf62.js"><link rel="prefetch" href="/kevin-blog/assets/js/218.7353ed7a.js"><link rel="prefetch" href="/kevin-blog/assets/js/219.f1fdfe8e.js"><link rel="prefetch" href="/kevin-blog/assets/js/22.5fd865e7.js"><link rel="prefetch" href="/kevin-blog/assets/js/220.e20ab2b5.js"><link rel="prefetch" href="/kevin-blog/assets/js/221.0d06c8b0.js"><link rel="prefetch" href="/kevin-blog/assets/js/222.e39491a9.js"><link rel="prefetch" href="/kevin-blog/assets/js/223.ae98df72.js"><link rel="prefetch" href="/kevin-blog/assets/js/224.4ba5d334.js"><link rel="prefetch" href="/kevin-blog/assets/js/225.913ee059.js"><link rel="prefetch" href="/kevin-blog/assets/js/226.b8d730bd.js"><link rel="prefetch" href="/kevin-blog/assets/js/227.69ee92e2.js"><link rel="prefetch" href="/kevin-blog/assets/js/228.1cf17cff.js"><link rel="prefetch" href="/kevin-blog/assets/js/229.6ce44fac.js"><link rel="prefetch" href="/kevin-blog/assets/js/23.9ef4ab20.js"><link rel="prefetch" href="/kevin-blog/assets/js/230.30c28e05.js"><link rel="prefetch" href="/kevin-blog/assets/js/231.ef327150.js"><link rel="prefetch" href="/kevin-blog/assets/js/232.6cb791d8.js"><link rel="prefetch" href="/kevin-blog/assets/js/233.473fa94b.js"><link rel="prefetch" href="/kevin-blog/assets/js/234.848de787.js"><link rel="prefetch" href="/kevin-blog/assets/js/235.f5db4ed9.js"><link rel="prefetch" href="/kevin-blog/assets/js/236.5da3f87c.js"><link rel="prefetch" href="/kevin-blog/assets/js/237.018a543d.js"><link rel="prefetch" href="/kevin-blog/assets/js/238.74d22845.js"><link rel="prefetch" href="/kevin-blog/assets/js/239.fca187a6.js"><link rel="prefetch" href="/kevin-blog/assets/js/24.3dff5faa.js"><link rel="prefetch" href="/kevin-blog/assets/js/240.0dbbfe84.js"><link rel="prefetch" href="/kevin-blog/assets/js/241.8b1ccf29.js"><link rel="prefetch" href="/kevin-blog/assets/js/242.f5216a9f.js"><link rel="prefetch" href="/kevin-blog/assets/js/243.8e5c5e34.js"><link rel="prefetch" href="/kevin-blog/assets/js/244.8f78ae9a.js"><link rel="prefetch" href="/kevin-blog/assets/js/245.e0b2e7b9.js"><link rel="prefetch" href="/kevin-blog/assets/js/246.7700207e.js"><link rel="prefetch" href="/kevin-blog/assets/js/247.c1e13b57.js"><link rel="prefetch" href="/kevin-blog/assets/js/248.63d6adf8.js"><link rel="prefetch" href="/kevin-blog/assets/js/249.500fdd00.js"><link rel="prefetch" href="/kevin-blog/assets/js/25.0ebddc27.js"><link rel="prefetch" href="/kevin-blog/assets/js/250.ebbb5c92.js"><link rel="prefetch" href="/kevin-blog/assets/js/251.4e51605e.js"><link rel="prefetch" href="/kevin-blog/assets/js/252.2534bb33.js"><link rel="prefetch" href="/kevin-blog/assets/js/253.330d0073.js"><link rel="prefetch" href="/kevin-blog/assets/js/254.da99904b.js"><link rel="prefetch" href="/kevin-blog/assets/js/255.f9a1774e.js"><link rel="prefetch" href="/kevin-blog/assets/js/256.7ee8ac66.js"><link rel="prefetch" href="/kevin-blog/assets/js/257.41594669.js"><link rel="prefetch" href="/kevin-blog/assets/js/258.9d8beffc.js"><link rel="prefetch" href="/kevin-blog/assets/js/259.1539043a.js"><link rel="prefetch" href="/kevin-blog/assets/js/26.7e91ac9d.js"><link rel="prefetch" href="/kevin-blog/assets/js/260.034695f0.js"><link rel="prefetch" href="/kevin-blog/assets/js/261.953910a0.js"><link rel="prefetch" href="/kevin-blog/assets/js/262.e2b0764f.js"><link rel="prefetch" href="/kevin-blog/assets/js/263.fe9b0b70.js"><link rel="prefetch" href="/kevin-blog/assets/js/264.489e20f7.js"><link rel="prefetch" href="/kevin-blog/assets/js/265.43596b34.js"><link rel="prefetch" href="/kevin-blog/assets/js/266.07bb7008.js"><link rel="prefetch" href="/kevin-blog/assets/js/267.5caf5b93.js"><link rel="prefetch" href="/kevin-blog/assets/js/268.fc6e09e2.js"><link rel="prefetch" href="/kevin-blog/assets/js/269.764500c0.js"><link rel="prefetch" href="/kevin-blog/assets/js/27.55c7093f.js"><link rel="prefetch" href="/kevin-blog/assets/js/270.9760648a.js"><link rel="prefetch" href="/kevin-blog/assets/js/271.019b1f9a.js"><link rel="prefetch" href="/kevin-blog/assets/js/272.bce07ec6.js"><link rel="prefetch" href="/kevin-blog/assets/js/273.038ff1e3.js"><link rel="prefetch" href="/kevin-blog/assets/js/274.2cb7fd59.js"><link rel="prefetch" href="/kevin-blog/assets/js/275.3c831af6.js"><link rel="prefetch" href="/kevin-blog/assets/js/276.8d0732f8.js"><link rel="prefetch" href="/kevin-blog/assets/js/277.5aa0c664.js"><link rel="prefetch" href="/kevin-blog/assets/js/278.a3cdd3b8.js"><link rel="prefetch" href="/kevin-blog/assets/js/279.d049a479.js"><link rel="prefetch" href="/kevin-blog/assets/js/28.da28db4a.js"><link rel="prefetch" href="/kevin-blog/assets/js/280.6b7f68c4.js"><link rel="prefetch" href="/kevin-blog/assets/js/281.eff251cb.js"><link rel="prefetch" href="/kevin-blog/assets/js/282.f0dc7866.js"><link rel="prefetch" href="/kevin-blog/assets/js/283.36ca2fb9.js"><link rel="prefetch" href="/kevin-blog/assets/js/284.470e6db4.js"><link rel="prefetch" href="/kevin-blog/assets/js/285.a9c60b36.js"><link rel="prefetch" href="/kevin-blog/assets/js/286.3eff6f51.js"><link rel="prefetch" href="/kevin-blog/assets/js/287.f406cf63.js"><link rel="prefetch" href="/kevin-blog/assets/js/288.d6bb5731.js"><link rel="prefetch" href="/kevin-blog/assets/js/289.518409f3.js"><link rel="prefetch" href="/kevin-blog/assets/js/29.37ea8137.js"><link rel="prefetch" href="/kevin-blog/assets/js/290.e4795980.js"><link rel="prefetch" href="/kevin-blog/assets/js/291.6ca97e3d.js"><link rel="prefetch" href="/kevin-blog/assets/js/292.f434852f.js"><link rel="prefetch" href="/kevin-blog/assets/js/293.256f39e1.js"><link rel="prefetch" href="/kevin-blog/assets/js/294.0e051edc.js"><link rel="prefetch" href="/kevin-blog/assets/js/295.d6a1cfbb.js"><link rel="prefetch" href="/kevin-blog/assets/js/296.9a3f4bb2.js"><link rel="prefetch" href="/kevin-blog/assets/js/297.374bbc2d.js"><link rel="prefetch" href="/kevin-blog/assets/js/298.c37b0145.js"><link rel="prefetch" href="/kevin-blog/assets/js/299.008098d2.js"><link rel="prefetch" href="/kevin-blog/assets/js/3.0c6053de.js"><link rel="prefetch" href="/kevin-blog/assets/js/30.24e20f30.js"><link rel="prefetch" href="/kevin-blog/assets/js/300.ab07139a.js"><link rel="prefetch" href="/kevin-blog/assets/js/301.69ee5ffa.js"><link rel="prefetch" href="/kevin-blog/assets/js/302.05af46d8.js"><link rel="prefetch" href="/kevin-blog/assets/js/303.cec1cf65.js"><link rel="prefetch" href="/kevin-blog/assets/js/304.7c82ba6c.js"><link rel="prefetch" href="/kevin-blog/assets/js/305.7ac25f4a.js"><link rel="prefetch" href="/kevin-blog/assets/js/306.82149841.js"><link rel="prefetch" href="/kevin-blog/assets/js/307.f56afc9c.js"><link rel="prefetch" href="/kevin-blog/assets/js/308.7c084ed0.js"><link rel="prefetch" href="/kevin-blog/assets/js/309.feb89623.js"><link rel="prefetch" href="/kevin-blog/assets/js/31.19d1e3af.js"><link rel="prefetch" href="/kevin-blog/assets/js/310.1e33889a.js"><link rel="prefetch" href="/kevin-blog/assets/js/311.416e7d20.js"><link rel="prefetch" href="/kevin-blog/assets/js/312.ee11dbec.js"><link rel="prefetch" href="/kevin-blog/assets/js/313.f58bb112.js"><link rel="prefetch" href="/kevin-blog/assets/js/314.543b2b1c.js"><link rel="prefetch" href="/kevin-blog/assets/js/315.18b9a70e.js"><link rel="prefetch" href="/kevin-blog/assets/js/316.6dfba854.js"><link rel="prefetch" href="/kevin-blog/assets/js/317.19590777.js"><link rel="prefetch" href="/kevin-blog/assets/js/318.a3ec0c19.js"><link rel="prefetch" href="/kevin-blog/assets/js/319.f990a61a.js"><link rel="prefetch" href="/kevin-blog/assets/js/32.07887ecb.js"><link rel="prefetch" href="/kevin-blog/assets/js/320.a3c5cbbf.js"><link rel="prefetch" href="/kevin-blog/assets/js/321.1f58e49c.js"><link rel="prefetch" href="/kevin-blog/assets/js/322.032ff5a2.js"><link rel="prefetch" href="/kevin-blog/assets/js/323.cdd3ba68.js"><link rel="prefetch" href="/kevin-blog/assets/js/324.5238a4e1.js"><link rel="prefetch" href="/kevin-blog/assets/js/325.df06c071.js"><link rel="prefetch" href="/kevin-blog/assets/js/33.9539a78e.js"><link rel="prefetch" href="/kevin-blog/assets/js/34.fa08dd12.js"><link rel="prefetch" href="/kevin-blog/assets/js/35.d6823664.js"><link rel="prefetch" href="/kevin-blog/assets/js/36.5e074071.js"><link rel="prefetch" href="/kevin-blog/assets/js/37.f4a65a95.js"><link rel="prefetch" href="/kevin-blog/assets/js/38.4f127420.js"><link rel="prefetch" href="/kevin-blog/assets/js/39.a5427f94.js"><link rel="prefetch" href="/kevin-blog/assets/js/4.a60d4c06.js"><link rel="prefetch" href="/kevin-blog/assets/js/40.859a530c.js"><link rel="prefetch" href="/kevin-blog/assets/js/41.b61d8247.js"><link rel="prefetch" href="/kevin-blog/assets/js/42.cd204014.js"><link rel="prefetch" href="/kevin-blog/assets/js/43.8076c8fc.js"><link rel="prefetch" href="/kevin-blog/assets/js/44.8a85cf72.js"><link rel="prefetch" href="/kevin-blog/assets/js/45.f46f354b.js"><link rel="prefetch" href="/kevin-blog/assets/js/46.5990e5be.js"><link rel="prefetch" href="/kevin-blog/assets/js/47.9381b746.js"><link rel="prefetch" href="/kevin-blog/assets/js/48.77d95473.js"><link rel="prefetch" href="/kevin-blog/assets/js/49.fc6dff0d.js"><link rel="prefetch" href="/kevin-blog/assets/js/5.6b8c7ebc.js"><link rel="prefetch" href="/kevin-blog/assets/js/50.297dac6d.js"><link rel="prefetch" href="/kevin-blog/assets/js/51.c6ed15a6.js"><link rel="prefetch" href="/kevin-blog/assets/js/52.8bb5ec6f.js"><link rel="prefetch" href="/kevin-blog/assets/js/53.32ab5818.js"><link rel="prefetch" href="/kevin-blog/assets/js/54.1fe541f9.js"><link rel="prefetch" href="/kevin-blog/assets/js/55.6084b23b.js"><link rel="prefetch" href="/kevin-blog/assets/js/56.242cd75a.js"><link rel="prefetch" href="/kevin-blog/assets/js/57.a3aa61b8.js"><link rel="prefetch" href="/kevin-blog/assets/js/58.5dc813ec.js"><link rel="prefetch" href="/kevin-blog/assets/js/59.0649b9f5.js"><link rel="prefetch" href="/kevin-blog/assets/js/6.8f60ce79.js"><link rel="prefetch" href="/kevin-blog/assets/js/60.e912e60f.js"><link rel="prefetch" href="/kevin-blog/assets/js/61.2348484b.js"><link rel="prefetch" href="/kevin-blog/assets/js/62.43b03d30.js"><link rel="prefetch" href="/kevin-blog/assets/js/63.6e56096d.js"><link rel="prefetch" href="/kevin-blog/assets/js/64.c45908b4.js"><link rel="prefetch" href="/kevin-blog/assets/js/65.aab0a20e.js"><link rel="prefetch" href="/kevin-blog/assets/js/66.2555ebea.js"><link rel="prefetch" href="/kevin-blog/assets/js/67.80828b1b.js"><link rel="prefetch" href="/kevin-blog/assets/js/68.5b1b38ff.js"><link rel="prefetch" href="/kevin-blog/assets/js/69.d735686b.js"><link rel="prefetch" href="/kevin-blog/assets/js/7.8fc0c0e7.js"><link rel="prefetch" href="/kevin-blog/assets/js/70.fd567fdf.js"><link rel="prefetch" href="/kevin-blog/assets/js/71.3dc39cbd.js"><link rel="prefetch" href="/kevin-blog/assets/js/72.6fe3454c.js"><link rel="prefetch" href="/kevin-blog/assets/js/73.80c96fab.js"><link rel="prefetch" href="/kevin-blog/assets/js/74.7b652913.js"><link rel="prefetch" href="/kevin-blog/assets/js/75.a9cc5506.js"><link rel="prefetch" href="/kevin-blog/assets/js/76.81bca567.js"><link rel="prefetch" href="/kevin-blog/assets/js/77.1851c464.js"><link rel="prefetch" href="/kevin-blog/assets/js/78.06a9be2e.js"><link rel="prefetch" href="/kevin-blog/assets/js/79.89ac9186.js"><link rel="prefetch" href="/kevin-blog/assets/js/8.d7f3575e.js"><link rel="prefetch" href="/kevin-blog/assets/js/80.76b8cfc2.js"><link rel="prefetch" href="/kevin-blog/assets/js/81.7c87b7a7.js"><link rel="prefetch" href="/kevin-blog/assets/js/82.1995f469.js"><link rel="prefetch" href="/kevin-blog/assets/js/83.dd77915d.js"><link rel="prefetch" href="/kevin-blog/assets/js/84.d167dd7d.js"><link rel="prefetch" href="/kevin-blog/assets/js/85.b858e7d4.js"><link rel="prefetch" href="/kevin-blog/assets/js/86.c4508e18.js"><link rel="prefetch" href="/kevin-blog/assets/js/87.e5015ac2.js"><link rel="prefetch" href="/kevin-blog/assets/js/88.03ea7184.js"><link rel="prefetch" href="/kevin-blog/assets/js/89.6c4aecd6.js"><link rel="prefetch" href="/kevin-blog/assets/js/9.541bf307.js"><link rel="prefetch" href="/kevin-blog/assets/js/90.e64c083e.js"><link rel="prefetch" href="/kevin-blog/assets/js/91.208ff0cf.js"><link rel="prefetch" href="/kevin-blog/assets/js/92.0247f769.js"><link rel="prefetch" href="/kevin-blog/assets/js/93.1d51e9e8.js"><link rel="prefetch" href="/kevin-blog/assets/js/94.52fd5e59.js"><link rel="prefetch" href="/kevin-blog/assets/js/95.3641a4fe.js"><link rel="prefetch" href="/kevin-blog/assets/js/96.a96da06a.js"><link rel="prefetch" href="/kevin-blog/assets/js/97.877152bf.js"><link rel="prefetch" href="/kevin-blog/assets/js/98.4fe249c2.js"><link rel="prefetch" href="/kevin-blog/assets/js/99.400d0dc4.js">
    <link rel="stylesheet" href="/kevin-blog/assets/css/0.styles.267bc68b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/kevin-blog/" class="home-link router-link-active"><!----> <span class="site-name">Kevin-Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kevin-blog/ES6/Map 数据结构.html" class="nav-link">
  ES6
</a></li></ul></div></div><div class="nav-item"><a href="/kevin-blog/Python/DBUtils 数据库连接池模块.html" class="nav-link">
  Python
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Django" class="dropdown-title"><span class="title">Django</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kevin-blog/Django/Ajax.html" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/kevin-blog/Django ORM/ORM-ContentType.html" class="nav-link">
  ORM
</a></li><li class="dropdown-item"><!----> <a href="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens.html" class="nav-link">
  Rest-Framework
</a></li></ul></div></div><div class="nav-item"><a href="/kevin-blog/Flask/Flask 文件上传.html" class="nav-link">
  Flask
</a></div><div class="nav-item"><a href="/kevin-blog/Git GitHub/Git.html" class="nav-link">
  Git GitHub
</a></div><div class="nav-item"><a href="/kevin-blog/Linux/CentOS 下载和安装.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/kevin-blog/MySQL/distinct 去重.html" class="nav-link">
  MySQL
</a></div><div class="nav-item"><a href="/kevin-blog/爬虫/Anaconda环境.html" class="nav-link">
  爬虫
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kevin-blog/ES6/Map 数据结构.html" class="nav-link">
  ES6
</a></li></ul></div></div><div class="nav-item"><a href="/kevin-blog/Python/DBUtils 数据库连接池模块.html" class="nav-link">
  Python
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Django" class="dropdown-title"><span class="title">Django</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kevin-blog/Django/Ajax.html" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/kevin-blog/Django ORM/ORM-ContentType.html" class="nav-link">
  ORM
</a></li><li class="dropdown-item"><!----> <a href="/kevin-blog/Django Rest-Framework/JWT - JSON Web Tokens.html" class="nav-link">
  Rest-Framework
</a></li></ul></div></div><div class="nav-item"><a href="/kevin-blog/Flask/Flask 文件上传.html" class="nav-link">
  Flask
</a></div><div class="nav-item"><a href="/kevin-blog/Git GitHub/Git.html" class="nav-link">
  Git GitHub
</a></div><div class="nav-item"><a href="/kevin-blog/Linux/CentOS 下载和安装.html" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/kevin-blog/MySQL/distinct 去重.html" class="nav-link">
  MySQL
</a></div><div class="nav-item"><a href="/kevin-blog/爬虫/Anaconda环境.html" class="nav-link">
  爬虫
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Linux</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/kevin-blog/Linux/CentOS 下载和安装.html" class="sidebar-link">CentOS 下载和安装</a></li><li><a href="/kevin-blog/Linux/Linux 介绍.html" class="sidebar-link">Linux 介绍</a></li><li><a href="/kevin-blog/Linux/Linux 注意事项.html" class="sidebar-link">Linux 注意事项</a></li><li><a href="/kevin-blog/Linux/Linux 的快捷键.html" class="sidebar-link">Linux 的快捷键</a></li><li><a href="/kevin-blog/Linux/Linux 的目录和路径.html" class="sidebar-link">Linux 的目录和路径</a></li><li><a href="/kevin-blog/Linux/Linux的命令结构.html" class="sidebar-link">Linux的命令结构</a></li><li><a href="/kevin-blog/Linux/Linux的基本命令.html" class="sidebar-link">Linux的基本命令</a></li><li><a href="/kevin-blog/Linux/Linux系统基础优化及常用命令.html" class="sidebar-link">Linux系统基础优化及常用命令</a></li><li><a href="/kevin-blog/Linux/MySQL(MariaDB)数据库.html" class="sidebar-link">MySQL(MariaDB)数据库</a></li><li><a href="/kevin-blog/Linux/PATH 环境变量.html" class="sidebar-link">PATH 环境变量</a></li><li><a href="/kevin-blog/Linux/Python3 的安装.html" class="sidebar-link">Python3 的安装</a></li><li><a href="/kevin-blog/Linux/VMware 安装和使用.html" class="sidebar-link">VMware 安装和使用</a></li><li><a href="/kevin-blog/Linux/XShell 的使用.html" class="sidebar-link">XShell 的使用</a></li><li><a href="/kevin-blog/Linux/ipython 与 jupyter 的安装.html" class="sidebar-link">ipython 与 jupyter 的安装</a></li><li><a href="/kevin-blog/Linux/ip地址和端口得到说明.html" class="sidebar-link">ip地址和端口得到说明</a></li><li><a href="/kevin-blog/Linux/nginx.html" class="sidebar-link">nginx</a></li><li><a href="/kevin-blog/Linux/nginx 负载均衡.html" class="active sidebar-link">nginx 负载均衡</a></li><li><a href="/kevin-blog/Linux/redis.html" class="sidebar-link">redis</a></li><li><a href="/kevin-blog/Linux/redis 主从复制.html" class="sidebar-link">redis 主从复制</a></li><li><a href="/kevin-blog/Linux/redis 发布订阅.html" class="sidebar-link">redis 发布订阅</a></li><li><a href="/kevin-blog/Linux/redis 安全配置.html" class="sidebar-link">redis 安全配置</a></li><li><a href="/kevin-blog/Linux/redis 持久化存储.html" class="sidebar-link">redis 持久化存储</a></li><li><a href="/kevin-blog/Linux/redis-cluster 集群.html" class="sidebar-link">redis-cluster 集群</a></li><li><a href="/kevin-blog/Linux/redis-sentinel 哨兵模式.html" class="sidebar-link">redis-sentinel 哨兵模式</a></li><li><a href="/kevin-blog/Linux/supervisor 进程管理工具.html" class="sidebar-link">supervisor 进程管理工具</a></li><li><a href="/kevin-blog/Linux/uWSGI.html" class="sidebar-link">uWSGI</a></li><li><a href="/kevin-blog/Linux/vi  vim 编辑器.html" class="sidebar-link">vi  vim 编辑器</a></li><li><a href="/kevin-blog/Linux/virtualenv 与 virtualenvwrapper 虚拟环境的讲解.html" class="sidebar-link">virtualenv 与 virtualenvwrapper 虚拟环境的讲解</a></li><li><a href="/kevin-blog/Linux/web server 基础知识.html" class="sidebar-link">web server 基础知识</a></li><li><a href="/kevin-blog/Linux/关闭防火墙.html" class="sidebar-link">关闭防火墙</a></li><li><a href="/kevin-blog/Linux/必须掌握的 etc 下的 Linux 目录知识.html" class="sidebar-link">必须掌握的 etc 下的 Linux 目录知识</a></li><li><a href="/kevin-blog/Linux/文件、文件夹的相关命令.html" class="sidebar-link">文件、文件夹的相关命令</a></li><li><a href="/kevin-blog/Linux/管理网络的命令.html" class="sidebar-link">管理网络的命令</a></li><li><a href="/kevin-blog/Linux/网址.html" class="sidebar-link">网址</a></li><li><a href="/kevin-blog/Linux/计划任务 crond 服务.html" class="sidebar-link">计划任务 crond 服务</a></li><li><a href="/kevin-blog/Linux/软件的下载及安装.html" class="sidebar-link">软件的下载及安装</a></li><li><a href="/kevin-blog/Linux/远程连接Linux.html" class="sidebar-link">远程连接Linux</a></li><li><a href="/kevin-blog/Linux/重定向符号.html" class="sidebar-link">重定向符号</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div><span><div><div><h2 style="margin:10px 0px 12px;padding:0px 0px 0px 15px;font-size:21px;background-color:#3eaf7c;border-radius:3px;text-align:center;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><span style="font-size:21px;background-color:#3eaf7c;border-radius:3px;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;color:white;font-family:&quot;Helvetica Neue&quot;, Helvetica, Verdana, Arial, sans-serif;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;line-height:1.5;">集群</span></h2><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">1.</span> <span style="font-size:14pt;font-weight:bold;">集群的介绍</span></div><div><br></div><ul><li><div>简单地说，集群就是指一组（若干个）相互独立的计算机，利用高速通信网络组成的一个较大的计算机服务系统，每个集群节点（即集群中的每台计算机）都是运行各自服务的独立服务器。这些服务器之间可以彼此通信，协同向用户提供应用程序，系统资源和数据，并以单一系统的模式加以管理。当用户客户机请求集群系统时，集群给用户的感觉就是一个单一独立的服务器，而实际上用户请求的是一组集群服务器</div></li></ul><div><br></div><ul><li><div>打开谷歌，百度的页面，看起来好简单，也许你觉得用几分钟就可以制作出相似的网页，而实际上，这个页面的背后是由成千上万台服务器集群协同工作的结果。而这么多的服务器维护和管理，以及相互协调工作也许就是同学们未来的工作职责了</div></li></ul><div><br></div><ul><li><div>若要用一句话描述集群，即一堆服务器合作做同一件事，这些机器可能需要整个技术团队架构，设计和统一协调管理，这些机器可以分布在一个机房，也可以分布在全国全球各个地区的多个机房</div></li></ul><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">2.</span> <span style="font-size:14pt;font-weight:bold;">为什么要使用集群</span></div><div><span style="font-size:14pt;"><br></span></div><ul><li><div><font style="font-size:12pt;"><span style="font-size:12pt;font-weight:bold;">高性能</span></font></div></li></ul><div><font style="font-size:12pt;"><br></font></div><ul><ul><li><div><span style="font-size:12pt;">一些国家重要的计算密集型应用（如天气预报，核试验模拟等），需要计算机有很强的运算处理能力。以全世界现有的技术，即使是大型机，其计算能力也是有限的，很难单独完成此任务。因为计算时间可能会相当长，也许几天，甚至几年或更久。因此，对于这类复杂的计算业务，便使用了计算机集群技术，集中几十上百台，甚至成千上万台计算机进行计算</span></div></li></ul></ul><div><br></div><ul><ul><li><div>大家耳熟能详的大型网站谷歌、百度、淘宝等，都不是几台大型机可以构建的，都是上万台服务器组成的高性能集群，分布于不同的地点</div></li></ul></ul><div><br></div><ul><li><div><span style="font-weight:bold;">价格有效性</span></div></li></ul><div><br></div><ul><ul><li><div>通常一套系统集群架构，只需要几台或数十台服务器主机即可。与动辄价值上百万元的专用超级计算机相比便宜了很多。在达到同样性能需求的条件下，采用计算机集群架构比采用同等运算能力的大型计算机具有更高的性价比</div></li></ul></ul><div><br></div><ul><ul><li><div>早期的淘宝，支付宝的数据库等核心系统就是使用上百万元的小型机服务器。后因使用维护成本太高以及扩展设备费用成几何级数翻倍，甚至成为扩展瓶颈，人员维护也十分困难，最终使用PC服务器集群替换之，比如，把数据库系统从小机结合Oracle数据库迁移到MySQL开源数据库结合PC服务器上来。不但成本下降了，扩展和维护也更容易了</div></li></ul></ul><div><br></div><ul><li><div><span style="font-weight:bold;">可伸缩性</span></div></li></ul><div><br></div><ul><ul><li><div>当服务负载，压力增长时，针对集群系统进行较简单的扩展即可满足需求，且不会降低服务质量</div></li></ul></ul><div><br></div><ul><ul><li><div>通常情况下，硬件设备若想扩展性能，不得不增加新的CPU和存储器设备，如果加不上去了，就不得不够买更高性能的服务器，就拿我们现在的服务器来讲，可以增加的设备总是有限的。如果采用集群技术，则只需要将新的单个服务器加入现有集群架构中即可，从访问的客户角度来看，系统服务无论是连续性还是性能上都几乎没有变化，系统在不知不觉中完成了升级，加大了访问能力，轻松地实现了扩展。集群系统中的节点数目可以增长到几千乃至上万个，其伸缩性远超过单台超级计算机</div></li></ul></ul><div><br></div><ul><li><div><span style="font-weight:bold;">高可用性</span></div></li></ul><div><br></div><ul><ul><li><div>单一的计算机系统总会面临设备损毁的问题，如CPU，内存，主板，电源，硬盘等，只要一个部件坏掉，这个计算机系统就可能会宕机，无法正常提供服务。在集群系统中，尽管部分硬件和软件也还是会发生故障，但整个系统的服务可以是7*24小时可用的</div></li></ul></ul><div><br></div><ul><ul><li><div>集群架构技术可以使得系统在若干硬件设备故障发生时仍可以继续工作，这样就将系统的停机时间减少到了最小。集群系统在提高系统可靠性的同时，也大大减小了系统故障带来的业务损失，目前几乎100%的互联网网站都要求7*24小时提供服务</div></li></ul></ul><div><br></div><ul><li><div><span style="font-weight:bold;">透明性</span></div></li></ul><div><br></div><ul><ul><li><div>多个独立计算机组成的松耦合集群系统构成一个虚拟服务器。用户或客户端程序访问集群系统时，就像访问一台高性能，高可用的服务器一样，集群中一部分服务器的上线，下线不会中断整个系统服务，这对用户也是透明的</div></li></ul></ul><div><br></div><ul><li><div><span style="font-weight:bold;">可管理性</span></div></li></ul><div><br></div><ul><ul><li><div>整个系统可能在物理上很大，但其实容易管理，就像管理一个单一映像系统一样。在理想状况下，软硬件模块的插入能做到即插即用</div></li></ul></ul><div><br></div><ul><li><div><span style="font-weight:bold;">可编程性</span></div></li></ul><div><br></div><ul><ul><li><div>在集群系统上，容易开发及修改各类应用程序</div></li></ul></ul><div><br></div><h2 style="margin:10px 0px 12px;padding:0px 0px 0px 15px;font-size:21px;background-color:#3eaf7c;border-radius:3px;text-align:center;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><span style="font-size:21px;color:white;font-family:&quot;Helvetica Neue&quot;, Helvetica, Verdana, Arial, sans-serif;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;line-height:1.5;">负载均衡示意图</span></h2><div><br></div><div><img data-filename="1132884-20181122231803127-188968722.png" src="/kevin-blog/Linux/nginx 负载均衡_files/1132884-20181122231803127-188968722.png" type="image/png"></div><div><br></div><div><img data-filename="1132884-20181122231837300-1361831847.png" src="/kevin-blog/Linux/nginx 负载均衡_files/1132884-20181122231837300-1361831847.png" type="image/png"></div><div><br></div><div><img data-filename="1132884-20181122231933322-1866836813.jpg" src="/kevin-blog/Linux/nginx 负载均衡_files/1132884-20181122231933322-1866836813.jpg" type="image/jpeg"></div><div><br></div><div><img data-filename="1132884-20181122232211243-1810845203.jpg" src="/kevin-blog/Linux/nginx 负载均衡_files/1132884-20181122232211243-1810845203.jpg" type="image/jpeg"></div><div><br></div><h2 style="margin:10px 0px 12px;padding:0px 0px 0px 15px;font-size:21px;background-color:#3eaf7c;border-radius:3px;text-align:center;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><span style="font-size:21px;background-color:#3eaf7c;border-radius:3px;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;color:white;font-family:&quot;Helvetica Neue&quot;, Helvetica, Verdana, Arial, sans-serif;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;line-height:1.5;">nginx 负载均衡概述</span></h2><div><br></div><ul><li><div>Web服务器，直接面向用户，往往要承载大量并发请求，单台服务器难以负荷，我使用多台WEB服务器组成集群，前端使用Nginx负载均衡，将请求分散的打到我们的后端服务器集群中，实现负载的分发。那么会大大提升系统的吞吐率、请求性能、高容灾</div></li></ul><div><br></div><div><img data-filename="fzjh.jpg" src="/kevin-blog/Linux/nginx 负载均衡_files/fzjh.jpg" type="image/jpeg"></div><div><br></div><ul><li><div>Nginx要实现负载均衡需要用到 proxy_pass 代理模块配置</div></li></ul><div><br></div><ul><li><div>Nginx可以配置代理多台服务器，当一台服务器宕机之后，仍能保持系统可用</div></li></ul><div><br></div><ul><li><div>Nginx负载均衡与Nginx代理不同地方在于: Nginx代理仅代理一台服务器，而Nginx负载均衡则是将客户端请求代理转发至一组upstream虚拟服务池</div></li></ul><div><br></div><h2 style="margin:10px 0px 12px;padding:0px 0px 0px 15px;font-size:21px;background-color:#3eaf7c;border-radius:3px;text-align:center;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><span style="font-size:21px;background-color:#3eaf7c;border-radius:3px;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;color:white;font-family:&quot;Helvetica Neue&quot;, Helvetica, Verdana, Arial, sans-serif;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;line-height:1.5;">nginx 负载均衡的配置</span></h2><div><br></div><div><span style="font-size:14pt;box-sizing:border-box;-webkit-tap-highlight-color:transparent;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;white-space:pre-wrap;color:rgb(0, 0, 0);font-family:&quot;Courier New&quot;;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;">1.</span><span style="font-size:14pt;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:&quot;Courier New&quot;;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;"> 环境的准备</span></div><div><span style="font-size:14pt;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><br></span></div><ul><li><div><span style="font-size:12pt;">准备3台服务器，且都安装了 nginx</span></div></li></ul><div><font style="font-size:12pt;"><br></font></div><ul><ul><li><div><span style="font-size:12pt;">10.0.0.3 -&gt; 作为 nginx 的负载均衡器，用于将请求分发给其他服务器进行处理</span></div></li><li><div><span style="font-size:12pt;">10.0.0.5 -&gt; 作为处理请求减轻负载的服务器</span></div></li><li><div><span style="font-size:12pt;">10.0.0.6 -&gt; 作为处理请求减轻负载的服务器</span></div></li></ul></ul><div><br></div><ul><li><div>关闭所有服务器的防火墙</div></li></ul><div><font style="font-size:12pt;"><br></font></div><ul><li><div><span style="font-size:12pt;">所有负责减轻负载的服务器，所存放的网站项目要完全一样</span></div></li></ul><div><span style="font-size:14pt;"><br></span></div><div><span style="font-size:14pt;box-sizing:border-box;-webkit-tap-highlight-color:transparent;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;white-space:pre-wrap;color:rgb(0, 0, 0);font-family:&quot;Courier New&quot;;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;">2.</span><span style="font-size:14pt;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;color:rgb(0, 0, 0);font-family:&quot;Courier New&quot;;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;"> nginx 负载均衡器的配置 -&gt; 10.0.0.3 的配置</span></div><div><span style="font-size:14pt;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><br></span></div><ul><li><div>进入 nginx 的配置文件</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>vim /opt/nginx-1-12/conf/nginx.conf</div></div><div><br></div><ul><li><div><span style="font-size:12pt;">nginx 负载均衡器 的 nginx.conf 的配置文件设置</span></div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>http {</div><div><br></div><div><span style="color:rgb(65, 173, 28);">  ...</span><span style="color:rgb(65, 173, 28);"></span></div><div><br></div><div><font color="#41AD1C"># 定义一个名为 flask 的负载均衡池</font></div><div><font color="#E30000">upstream flask {</font></div><div><span style="color:rgb(227, 0, 0);"></span><font color="#E30000"></font> <font color="#41AD1C"># 池子中存放着两个处理请求减轻负载的服务器，默认轮询方式调用服务器</font></div><div><font color="#E30000">        server 10.0.0.5:8000;</font></div><div><font color="#E30000">        server 10.0.0.6:8000;</font></div><div><font color="#E30000">    }</font></div><div><br></div><div><span style="color:rgb(65, 173, 28);"># 使用server配置网站, 每个 server{} 代表一个网站 (简称虚拟主机)</span></div><div>    server {</div><div><span style="color:rgb(65, 173, 28);"># 监听端口, 默认80</span></div><div>        listen 80;</div><div><span style="color:rgb(65, 173, 28);"> # 提供服务的域名或主机名，即: 通过该域名或ip来访问当前配置的网站</span></div><div>        server_name 10.0.0.3;</div><div><span style="color:rgb(65, 173, 28);"># 控制网站访问路径</span></div><div>        location / {</div><div><span style="color:rgb(65, 173, 28);"># 将接收到的请求转交给名为flask的负载均衡池进行分发处理</span></div><div><font color="#E30000">proxy_pass http://flask;</font></div><div><span style="color:rgb(227, 0, 0);"></span><span style="color:rgb(227, 0, 0);"></span><font color="#E30000"></font> <font style="color:rgb(65, 173, 28);"># 将 proxy_params 配置文件添加到当前虚拟主机上，且这个 proxy_params 配置文件需要手动创建到 /opt/nginx-1-12/conf/ 下</font></div><div><font style="color:rgb(65, 173, 28);">            # include 参数的作用: 减少主配置文件 nginx.conf 的内容，将某部分的配置项单独写在一个配置文件中然后使用 include 参数进行导入，其效果和直接写在 nginx.conf 主配置文件下是一样的</font></div><div><font color="#41AD1C">            # include 参数如果不使用绝对路径，那么默认会在 /opt/nginx-1-12/conf/ 下寻找你所定义的配置文件</font></div><div><font style="color:rgb(227, 0, 0);">            include proxy_params;</font></div><div>        }</div><div>    }</div><div><br></div><div><span style="color:rgb(65, 173, 28);">...</span></div><div>}</div></div><div><br></div><ul><li><div>在 nginx 配置文件夹（即: /opt/nginx-1-12/conf/）下创建 proxy_params 配置文件</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>touch /opt/nginx-1-12/conf/proxy_params</div></div><div><span style="font-size:14pt;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><br></span></div><ul><li><div><span style="font-size:12pt;">打开 </span>proxy_params 配置文件</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>vim /opt/nginx-1-12/conf/proxy_params</div></div><div><br></div><ul><li><div>配置 proxy_params 配置文件</div></li></ul><div><br></div><ul><ul><li><div>存放请求头的相关参数</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>proxy_set_header Host $http_host;</div><div>proxy_set_header X-Real-IP $remote_addr;</div><div>proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</div><div><br></div><div>proxy_connect_timeout 30;</div><div>proxy_send_timeout 60;</div><div>proxy_read_timeout 60;</div><div><br></div><div>proxy_buffering on;</div><div>proxy_buffer_size 32k;</div><div>proxy_buffers 4 128k;</div></div><div><br></div><ul><li><div>检查<span style="font-size:12pt;">nginx 负载均衡器</span>配置文件是否有语法错误</div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/opt/nginx-1-12/sbin/nginx -t</div></div><div><br></div><ul><li><div>启动 <span style="font-size:12pt;">nginx 负载均衡器</span> 或 平滑重启 <span style="font-size:12pt;">nginx 负载均衡器</span></div></li></ul><div><br></div><ul><ul><li><div>如果没有启动 nginx，那么就启动 nginx</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/opt/nginx-1-12/sbin/nginx</div></div><div><br></div><ul><ul><li><div>如果已经启动了nginx，那么在修改配置文件后，就平滑重启 nginx</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/opt/nginx-1-12/sbin/nginx -s reload</div></div><div><br></div><div><span style="white-space:pre-wrap;font-size:14pt;font-weight:bold;">3.</span><span style="font-size:14pt;font-weight:bold;"> 处理请求减轻负载的服务器配置 -&gt; 10.0.0.5 的配置</span></div><div><span style="font-size:14pt;"><br></span></div><ul><li><div><span style="font-weight:bold;">方式一: 直接使用 flask 启动 web 服务</span></div></li></ul><div><font style="font-size:14pt;"><br></font></div><ul><ul><li><div>注意: 在线上部署的时候，<span style="font-size:12pt;">所有负责减轻负载的服务器，所存放的网站项目要完全一样，这里只是为了查看结果才做不一样的配置</span></div></li></ul></ul><div><br></div><ul><ul><li><div>在 /opt 文件夹下创建一个 flask_project 文件夹用于存放 flask 项目</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mkdir /opt/flask_project</div></div><div><br></div><ul><ul><li><div>在 /opt/flask_project 下创建一个 my_flask.py 文件</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>touch /opt/flask_project/my_flask.py</div></div><div><br></div><ul><ul><li><div>进入 my_flask.py 文件</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>vim /opt/flask_project/my_flask.py</div></div><div><br></div><ul><ul><li><div>编辑 my_flask.py 文件</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from flask import Flask</div><div>app=Flask(__name__)</div><div>@app.route('/')</div><div>def hello():</div><div>    return '&lt;h1 style=&quot;color:red&quot;&gt;i am flask....from nginx&lt;h1&gt;'</div><div>if __name__==&quot;__main__&quot;:</div><div>    app.run(host='0.0.0.0',port=8000)</div></div><div><br></div><ul><ul><li><div>启动 flask </div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>python3 /opt/flask_project/my_flask.py</div></div><div><br></div><ul><li><div><span style="font-weight:bold;">方式二: 使用 nginx 启动 web 服务</span></div></li></ul><div><br></div><ul><ul><li><div>在 /opt/nginx-1-12/html 创建一个 nginx_fzjh.html 文件</div></li></ul></ul><div><br></div><ul><ul><ul><li><div>创建 nginx_fzjh.html 文件</div></li></ul></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>touch /opt/nginx-1-12/html/nginx_fzjh.html</div></div><div><br></div><ul><ul><ul><li><div>修改 nginx_fzjh.html 的内容</div></li></ul></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>vim /opt/nginx-1-12/html/nginx_fzjh.html</div></div><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#41AD1C"># nginx_fzjh.html</font></div><div><br></div><div>&lt;h1 style=&quot;color:red&quot;&gt;i am flask....from nginx&lt;h1&gt;</div></div><div><br></div><ul><ul><li><div><span style="font-size:12pt;">nginx 的 nginx.conf 的配置文件设置</span></div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>http {</div><div><br></div><div><span style="color:rgb(65, 173, 28);">  ...</span><span style="color:rgb(65, 173, 28);"></span></div><div><br></div><div><span style="color:rgb(65, 173, 28);"># 使用server配置网站, 每个 server{} 代表一个网站 (简称虚拟主机)</span></div><div>    server {</div><div><span style="color:rgb(65, 173, 28);"># 监听端口, 默认80</span></div><div>        listen 8000;</div><div><span style="color:rgb(65, 173, 28);"> # 提供服务的域名或主机名，即: 通过该域名或ip来访问当前配置的网站</span></div><div>        server_name 10.0.0.5;</div><div><span style="color:rgb(65, 173, 28);"># 控制网站访问路径</span></div><div>        location / {</div><div><span style="color:rgb(65, 173, 28);"># 存放网站代码路径</span></div><div>            root /opt/nginx-1-12/html/;</div><div><span style="color:rgb(65, 173, 28);"># 服务器返回的默认页面文件, 即: 当浏览器访问 10.0.0.5 的时候就会返回一个 index.html 页面 </span></div><div>            index nginx_fzjh.html;  </div><div>        }</div><div>    }</div><div><br></div><div><span style="color:rgb(65, 173, 28);">...</span></div><div>}</div></div><div><br></div><ul><ul><li><div>检查nginx配置文件是否有语法错误</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/opt/nginx-1-12/sbin/nginx -t</div></div><div><br></div><ul><ul><li><div>启动nginx 或 平滑重启 nginx</div></li></ul></ul><div><br></div><ul><ul><ul><li><div>如果没有启动 nginx，那么就启动 nginx</div></li></ul></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/opt/nginx-1-12/sbin/nginx</div></div><div><br></div><ul><ul><ul><li><div>如果已经启动了nginx，那么在修改配置文件后，就平滑重启 nginx</div></li></ul></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/opt/nginx-1-12/sbin/nginx -s reload</div></div><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">4.</span><span style="font-size:14pt;font-weight:bold;"> 处理请求减轻负载的服务器配置 -&gt; 10.0.0.6 的配置</span></div><div><span style="font-size:14pt;"><br></span></div><ul><li><div><span style="font-weight:bold;">方式一: 直接使用 flask 启动 web 服务</span></div></li></ul><div><br></div><ul><ul><li><div>注意: 在线上部署的时候，<span style="font-size:12pt;">所有负责减轻负载的服务器，所存放的网站项目要完全一样，这里只是为了查看结果才做不一样的配置</span></div></li></ul></ul><div><br></div><ul><ul><li><div>在 /opt 文件夹下创建一个 flask_project 文件夹用于存放 flask 项目</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mkdir /opt/flask_project</div></div><div><br></div><ul><ul><li><div>在 /opt/flask_project 下创建一个 my_flask.py 文件</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>touch /opt/flask_project/my_flask.py</div></div><div><br></div><ul><ul><li><div>进入 my_flask.py 文件</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>vim /opt/flask_project/my_flask.py</div></div><div><br></div><ul><ul><li><div>编辑 my_flask.py 文件</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>from flask import Flask</div><div>app=Flask(__name__)</div><div>@app.route('/')</div><div>def hello():</div><div>    return '&lt;h1 style=&quot;color:green&quot;&gt;i am flask....from nginx&lt;h1&gt;'</div><div>if __name__==&quot;__main__&quot;:</div><div>    app.run(host='0.0.0.0',port=8000)</div></div><div><br></div><ul><ul><li><div>启动 flask </div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>python3 /opt/flask_project/my_flask.py</div></div><div><br></div><ul><li><div><span style="font-weight:bold;">方式二: 使用 nginx 启动 web 服务</span></div></li></ul><div><br></div><ul><ul><li><div>在 /opt/nginx-1-12/html 创建一个 nginx_fzjh.html 文件</div></li></ul></ul><div><br></div><ul><ul><ul><li><div>创建 nginx_fzjh.html 文件</div></li></ul></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>touch /opt/nginx-1-12/html/nginx_fzjh.html</div></div><div><br></div><ul><ul><ul><li><div>修改 nginx_fzjh.html 的内容</div></li></ul></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>vim /opt/nginx-1-12/html/nginx_fzjh.html</div></div><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color:rgb(65, 173, 28);"># nginx_fzjh.html</span></div><div><br></div><div>&lt;h1 style=&quot;color:green&quot;&gt;i am flask....from nginx&lt;h1&gt;</div></div><div><br></div><ul><ul><li><div><span style="font-size:12pt;">nginx 的 nginx.conf 的配置文件设置</span></div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>http {</div><div><br></div><div><span style="color:rgb(65, 173, 28);">  ...</span><span style="color:rgb(65, 173, 28);"></span></div><div><br></div><div><span style="color:rgb(65, 173, 28);"># 使用server配置网站, 每个 server{} 代表一个网站 (简称虚拟主机)</span></div><div>    server {</div><div><span style="color:rgb(65, 173, 28);"># 监听端口, 默认80</span></div><div>        listen 8000;</div><div><span style="color:rgb(65, 173, 28);"> # 提供服务的域名或主机名，即: 通过该域名或ip来访问当前配置的网站</span></div><div>        server_name 10.0.0.6;</div><div><span style="color:rgb(65, 173, 28);"># 控制网站访问路径</span></div><div>        location / {</div><div><span style="color:rgb(65, 173, 28);"># 存放网站代码路径</span></div><div>            root /opt/nginx-1-12/html/;</div><div><span style="color:rgb(65, 173, 28);"># 服务器返回的默认页面文件, 即: 当浏览器访问 10.0.0.6 的时候就会返回一个 index.html 页面 </span></div><div>            index nginx_fzjh.html;  </div><div>        }</div><div>    }</div><div><br></div><div><span style="color:rgb(65, 173, 28);">...</span></div><div>}</div></div><div><br></div><ul><ul><li><div>检查nginx配置文件是否有语法错误</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/opt/nginx-1-12/sbin/nginx -t</div></div><div><br></div><ul><ul><li><div>启动nginx 或 平滑重启 nginx</div></li></ul></ul><div><br></div><ul><ul><ul><li><div>如果没有启动 nginx，那么就启动 nginx</div></li></ul></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/opt/nginx-1-12/sbin/nginx</div></div><div><br></div><ul><ul><ul><li><div>如果已经启动了nginx，那么在修改配置文件后，就平滑重启 nginx</div></li></ul></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/opt/nginx-1-12/sbin/nginx -s reload</div></div><div><br></div><div><span style="font-size:14pt;white-space:pre-wrap;font-weight:bold;">5.</span><span style="font-size:14pt;font-weight:bold;"> 通过浏览器访问网站</span></div><div><span style="font-size:14pt;"><br></span></div><ul><li><div>轮询访问<span style="font-size:12pt;">处理请求减轻负载的服务器（即: 如果有两台</span><span style="font-size:12pt;">处理请求减轻负载的服务器</span><span style="font-size:12pt;">，浏览器第一次发送请求，服务器A处理，</span><span style="font-size:12pt;">浏览器</span><span style="font-size:12pt;">第二次</span><span style="font-size:12pt;">发送请求后，服务器B处理</span><span style="font-size:12pt;">）</span></div></li></ul><div><br></div><ul><li><div>浏览器第一次发送请求</div></li></ul><div><br></div><div><img data-filename="Image.png" src="/kevin-blog/Linux/nginx 负载均衡_files/Image.png" type="image/png"></div><div><br></div><ul><li><div>浏览器第二次发送请求</div></li></ul><div><br></div><div><img data-filename="Image.png" src="/kevin-blog/Linux/nginx 负载均衡_files/Image [1].png" type="image/png"></div><div><br></div><ul><li><div>浏览器第三次发送请求</div></li></ul><div><br></div><div><img data-filename="Image.png" src="/kevin-blog/Linux/nginx 负载均衡_files/Image [2].png" type="image/png"></div><div><br></div><h2 style="margin:10px 0px 12px;padding:0px 0px 0px 15px;font-size:21px;background-color:#3eaf7c;border-radius:3px;text-align:center;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;"><span style="font-size:21px;background-color:#3eaf7c;border-radius:3px;text-shadow:rgb(34, 34, 34) 1px 1px 2px;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;color:white;font-family:&quot;Helvetica Neue&quot;, Helvetica, Verdana, Arial, sans-serif;font-variant-caps:normal;font-variant-ligatures:normal;font-weight:bold;line-height:1.5;">nginx 负载均衡调度算法</span></h2><div><div><br></div><table style="border-collapse:collapse;min-width:100%;"><colgroup><col style="width:130px;"><col style="width:816px;"></colgroup><tbody><tr><td style="vertical-align:middle;background-color:rgb(234, 234, 234);border:1px solid rgb(187, 187, 187);width:130px;padding:8px;"><div style="text-align:center;">调度算法</div></td><td style="vertical-align:middle;background-color:rgb(234, 234, 234);border:1px solid rgb(187, 187, 187);width:816px;padding:8px;"><div style="text-align:center;">说明</div></td></tr><tr><td style="vertical-align:middle;width:130px;padding:8px;border:1px solid;"><div style="text-align:center;">轮询</div></td><td style="vertical-align:middle;width:816px;padding:8px;border:1px solid;"><div>按时间顺序逐一分配到不同的后端服务器(默认调度方式)</div></td></tr><tr><td style="vertical-align:middle;width:130px;padding:8px;border:1px solid;"><div style="text-align:center;">weight</div></td><td style="vertical-align:middle;width:816px;padding:8px;border:1px solid;"><div>加权轮询, weight值越大, 分配到的访问几率越高</div></td></tr><tr><td style="vertical-align:middle;width:130px;padding:8px;border:1px solid;"><div style="text-align:center;">ip_hash</div></td><td style="vertical-align:middle;width:816px;padding:8px;border:1px solid;"><div>每个请求按访问IP的hash结果分配,这样来自同一IP的固定访问一个后端服务器，且不能和 weight 一起使用</div></td></tr><tr><td style="vertical-align:middle;width:130px;padding:8px;border:1px solid;"><div style="text-align:center;">url_hash</div></td><td style="vertical-align:middle;width:816px;padding:8px;border:1px solid;"><div>按照访问URL的hash结果来分配请求,是每个URL定向到同一个后端服务器</div></td></tr><tr><td style="vertical-align:middle;width:130px;padding:8px;border:1px solid;"><div style="text-align:center;">least_conn</div></td><td style="vertical-align:middle;width:816px;padding:8px;border:1px solid;"><div>最少链接数,那个机器链接数少就分发</div></td></tr></tbody></table><div><br></div></div><ul><li><div><span style="font-size:12pt;">weight</span></div></li></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>http {</div><div><br></div><div><span style="color:rgb(65, 173, 28);">  ...</span><span style="color:rgb(65, 173, 28);"></span></div><div><br></div><div><span style="color:rgb(65, 173, 28);"># 定义一个名为 flask 的负载均衡池</span></div><div><font color="#464646">upstream flask {</font></div><div><span style="color:rgb(227, 0, 0);"></span><span style="color:rgb(227, 0, 0);"></span> <span style="color:rgb(65, 173, 28);"># 池子中存放着两个处理请求减轻负载的服务器，默认轮询方式调用服务器</span></div><div><span style="color:rgb(227, 0, 0);"></span><font color="#464646"> server 10.0.0.5:8000 </font><font color="#E30000">weight=3</font><font color="#464646">;</font></div><div><font color="#464646">        server 10.0.0.6:8000 </font><font color="#E30000">weight=7</font><font color="#464646">;</font></div><div><font color="#464646">    }</font></div><div><br></div><div><span style="color:rgb(65, 173, 28);"># 使用server配置网站, 每个 server{} 代表一个网站 (简称虚拟主机)</span></div><div>    server {</div><div><span style="color:rgb(65, 173, 28);"># 监听端口, 默认80</span></div><div>        listen 80;</div><div><span style="color:rgb(65, 173, 28);"> # 提供服务的域名或主机名，即: 通过该域名或ip来访问当前配置的网站</span></div><div>        server_name 10.0.0.5;</div><div><span style="color:rgb(65, 173, 28);"># 控制网站访问路径</span></div><div>        location / {</div><div><span style="color:rgb(65, 173, 28);"># 将接收到的请求转交给名为flask的负载均衡池进行分发处理</span></div><div><font color="#464646">proxy_pass http://flask;</font></div><div><span style="color:rgb(227, 0, 0);"></span><span style="color:rgb(227, 0, 0);"></span><span style="color:rgb(227, 0, 0);"></span> <span style="color:rgb(65, 173, 28);"># 将 proxy_params 配置文件添加到当前虚拟主机上，且这个 proxy_params 配置文件需要手动创建到 /opt/nginx-1-12/conf/ 下</span></div><div><span style="color:rgb(65, 173, 28);">            # include 参数的作用: 减少主配置文件 nginx.conf 的内容，将某部分的配置项单独写在一个配置文件中然后使用 include 参数进行导入，其效果和直接写在 nginx.conf 主配置文件下是一样的</span></div><div><span style="color:rgb(65, 173, 28);">            # include 参数如果不使用绝对路径，那么默认会在 /opt/nginx-1-12/conf/ 下寻找你所定义的配置文件</span></div><div><span style="color:rgb(227, 0, 0);"></span><font color="#464646">include proxy_params;</font></div><div>        }</div><div>    }</div><div><br></div><div><span style="color:rgb(65, 173, 28);">...</span></div><div>}</div></div><div><br></div></div><ul><li><div>ip_hash</div></li></ul><div><br></div><ul><ul><li><div>根据客户端ip哈希分配，不能和 weight 一起使用</div></li></ul></ul><div><br></div><div style="box-sizing:border-box;padding:8px;font-family:Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;font-size:12px;color:rgb(51, 51, 51);border-radius:4px;background-color:rgb(251, 250, 248);border:1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>http {</div><div><br></div><div><span style="color:rgb(65, 173, 28);">  ...</span><span style="color:rgb(65, 173, 28);"></span></div><div><br></div><div><span style="color:rgb(65, 173, 28);"># 定义一个名为 flask 的负载均衡池</span></div><div><span style="color:rgb(70, 70, 70);">upstream flask {</span></div><div><span style="color:rgb(70, 70, 70);"></span><font color="#464646"></font> <font color="#E30000">ip_hash;</font></div><div><span style="color:rgb(227, 0, 0);"></span><span style="color:rgb(227, 0, 0);"></span> <span style="color:rgb(65, 173, 28);"># 池子中存放着两个处理请求减轻负载的服务器，默认轮询方式调用服务器</span></div><div><span style="color:rgb(227, 0, 0);"></span><span style="color:rgb(70, 70, 70);"> server 10.0.0.5:8000</span><span style="color:rgb(70, 70, 70);">;</span></div><div><span style="color:rgb(70, 70, 70);">        server 10.0.0.6:8000</span><span style="color:rgb(70, 70, 70);">;</span></div><div><span style="color:rgb(70, 70, 70);">    }</span></div><div><br></div><div><span style="color:rgb(65, 173, 28);"># 使用server配置网站, 每个 server{} 代表一个网站 (简称虚拟主机)</span></div><div>    server {</div><div><span style="color:rgb(65, 173, 28);"># 监听端口, 默认80</span></div><div>        listen 80;</div><div><span style="color:rgb(65, 173, 28);"> # 提供服务的域名或主机名，即: 通过该域名或ip来访问当前配置的网站</span></div><div>        server_name 10.0.0.5;</div><div><span style="color:rgb(65, 173, 28);"># 控制网站访问路径</span></div><div>        location / {</div><div><span style="color:rgb(65, 173, 28);"># 将接收到的请求转交给名为flask的负载均衡池进行分发处理</span></div><div><span style="color:rgb(70, 70, 70);">proxy_pass </span>http://flask;</div><div><span style="color:rgb(227, 0, 0);"></span><span style="color:rgb(227, 0, 0);"></span><span style="color:rgb(227, 0, 0);"></span> <span style="color:rgb(65, 173, 28);"># 将 proxy_params 配置文件添加到当前虚拟主机上，且这个 proxy_params 配置文件需要手动创建到 /opt/nginx-1-12/conf/ 下</span></div><div><span style="color:rgb(65, 173, 28);">            # include 参数的作用: 减少主配置文件 nginx.conf 的内容，将某部分的配置项单独写在一个配置文件中然后使用 include 参数进行导入，其效果和直接写在 nginx.conf 主配置文件下是一样的</span></div><div><span style="color:rgb(65, 173, 28);">            # include 参数如果不使用绝对路径，那么默认会在 /opt/nginx-1-12/conf/ 下寻找你所定义的配置文件</span></div><div><span style="color:rgb(227, 0, 0);"></span><span style="color:rgb(70, 70, 70);">include proxy_params;</span></div><div>        }</div><div>    }</div><div><br></div><div><span style="color:rgb(65, 173, 28);">...</span></div><div>}</div></div><div><br></div><div><br></div></div><div><br></div></span></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/kevin-blog/Linux/nginx.html" class="prev">
        nginx
      </a></span> <span class="next"><a href="/kevin-blog/Linux/redis.html">
        redis
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/kevin-blog/assets/js/app.dd46475d.js" defer></script><script src="/kevin-blog/assets/js/2.97d04891.js" defer></script><script src="/kevin-blog/assets/js/143.2e682c5b.js" defer></script>
  </body>
</html>
