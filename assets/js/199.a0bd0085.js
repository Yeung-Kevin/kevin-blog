(window.webpackJsonp=window.webpackJsonp||[]).push([[199],{552:function(t,o,i){"use strict";i.r(o);var r=i(25),e=Object(r.a)({},(function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[i("div",[i("span",[i("div",[i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[t._v("importlib 模块: 图像处理模块")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap"}},[i("br")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),t._v(" "),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("PIL的安装")])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[t._v("pip3 install pillow -i https://pypi.douban.com/simple "),i("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 使用豆瓣的镜像")])])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),t._v(" "),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("Image")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("ul",[i("li",[i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[t._v("生成一个纯色背景图片对象")])],1)])]),i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[i("br")])],1),i("ul",[i("li",[i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[t._v("语法: ")]),t._v("Image.new(mode='模式', size=尺寸, color=RGB色值 或 颜色的英文单词) -> Image.new('RGB', (245, 34), (255, 255, 0))")],1)])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[t._v("img_obj = Image.new('RGB', (245, 34), get_random_color())  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片对象")])],1)]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),t._v(" "),i("span",{staticStyle:{"font-size":"14pt"}},[i("b",[t._v("ImageDraw")])])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("b",[i("br")])])]),i("ul",[i("li",[i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[t._v("生成一个图像画笔对象")])],1)])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("作用: 一般用于在"),i("span",{staticStyle:{"font-size":"12pt"}},[t._v("纯色背景图片对象上添加文字，画点或画线等")])])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("语法: ImageDraw.Draw(图片对象)")])])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[t._v("draw_obj = ImageDraw.Draw(img_obj)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片画笔对象")])],1)]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),t._v(" "),i("span",{staticStyle:{"font-size":"14pt"}},[i("b",[t._v("ImageFont")])])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("b",[i("br")])])]),i("ul",[i("li",[i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[t._v("加载字体文件得到一个字体对象")])],1)])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("作用: 一般用于在"),i("span",{staticStyle:{"font-size":"12pt"}},[t._v("纯色背景图片对象上添加文字")])])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("语法: ImageFont.truetype('字体文件路径', 字体大小)  -> ImageFont.truetype('blog/static/font/kumo.ttf', 28)")])])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[t._v("font_obj = ImageFont.truetype('blog/static/font/kumo.ttf', 28)")])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),t._v(" "),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("在图片对象上添加文字")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("ul",[i("li",[i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[t._v("语法: 图像画笔对象.text(xy=坐标, text='需要添加的文字', fill=")]),t._v("RGB色值 或 颜色的英文单词"),i("font",{staticStyle:{"font-size":"12pt"}},[t._v(", font=文字对象)")])],1)])]),i("div",[i("span"),i("span"),i("span",{staticStyle:{color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-size":"16px","font-variant-ligatures":"normal","font-variant-caps":"normal","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t._v("图像画笔对象")]),i("span",{staticStyle:{color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-size":"16px","font-variant-ligatures":"normal","font-variant-caps":"normal","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t._v(".text(xy=(0, 0), text='文字', fill=(0, 0, 0), font=font_obj)")]),i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[t._v("from PIL import Image, ImageDraw, ImageFont")]),i("div",[i("br")]),i("div",[t._v("img_obj = Image.new('RGB', (245, 34), (255, 255, 0)) "),i("font",{attrs:{color:"#41AD1C"}},[t._v(" # 生成一个图片对象")])],1),i("div",[t._v("draw_obj = ImageDraw.Draw(img_obj) "),i("font",{attrs:{color:"#41AD1C"}},[t._v(" # 生成一个图片画笔对象")])],1),i("div",[t._v("font_obj = ImageFont.truetype('static/font/kumo.ttf', 28)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 加载字体文件得到一个字体对象")])],1),i("div",[i("br")]),i("div",[t._v("draw_obj.text(xy=(0, 0), text='文字', fill=(0, 0, 0), font=font_obj)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 在图片对象上添加文字")])],1)]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("5.")]),t._v(" "),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("在图片对象上画弧线")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("语法: 图像画笔对象.arc(xy=(num_x, num_y, num_x2, num_y2), start=num, end=num, fill=")]),t._v("RGB色值 或 颜色的英文单词"),i("span",{staticStyle:{"font-size":"12pt"}},[t._v(")")])])])]),i("div",[i("span",{staticStyle:{color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-size":"16px","font-variant-ligatures":"normal","font-variant-caps":"normal","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t._v("图像画笔对象")]),t._v(".arc((50, 50, 100, 100), 0, 270, fill=(0, 0, 0))")]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("参数说明:")])]),i("ul",[i("li",[i("div",[t._v("xy 坐标: 需要传递两个点的xy坐标")])]),i("li",[i("div",[t._v("start 和 end: 是确定弧度的值")])])])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[t._v("from PIL import Image, ImageDraw, ImageFont")]),i("div",[i("br")]),i("div",[t._v("img_obj = Image.new('RGB', (500, 500), (255, 255, 0))  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片对象")])],1),i("div",[t._v("draw_obj = ImageDraw.Draw(img_obj)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片画笔对象")])],1),i("div",[t._v("font_obj = ImageFont.truetype('static/font/kumo.ttf', 28)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 加载字体文件得到一个字体对象")])],1),i("div",[i("br")]),i("div",[t._v("draw_obj.arc((50, 50, 100, 100), 0, 270, fill=(0, 0, 0))  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 在图片对象上画弧线")])],1)]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("6.")]),t._v(" "),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("在图片对象上画线")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("语法: 图像画笔对象.line(xy=(num_x, num_y, num_x2, num_y2), fill=")]),t._v("RGB色值 或 颜色的英文单词"),i("span",{staticStyle:{"font-size":"12pt"}},[t._v(")")])])])]),i("div",[i("span",{staticStyle:{color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-size":"16px","font-variant-ligatures":"normal","font-variant-caps":"normal","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t._v("图像画笔对象")]),t._v(".line((10, 10, 100, 100), fill=(0, 0, 0))")]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("参数说明:")])]),i("ul",[i("li",[i("div",[t._v("xy 坐标: 需要传递两个点的xy坐标，因为两点确定一条直线")])])])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[t._v("from PIL import Image, ImageDraw, ImageFont")]),i("div",[i("br")]),i("div",[t._v("img_obj = Image.new('RGB', (500, 500), (255, 255, 0))  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片对象")])],1),i("div",[t._v("draw_obj = ImageDraw.Draw(img_obj)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片画笔对象")])],1),i("div",[t._v("font_obj = ImageFont.truetype('static/font/kumo.ttf', 28)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 加载字体文件得到一个字体对象")])],1),i("div",[i("br")]),i("div",[t._v("draw_obj.line((10, 10, 100, 100), fill=(0, 0, 0))  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 在图片对象上画线")])],1)]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("7.")]),t._v(" "),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("将图片对象保存到文件中或内存中")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("ul",[i("li",[i("div",[t._v("语法: 图片对象.save(文件句柄, '图片格式')")])])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("ul",[i("li",[i("div",[t._v("将图片对象保存到文件中，并且生成一张图片")])])]),i("div",[i("br")]),i("ul",[i("ul",[i("li",[i("div",[t._v("注意: 使用bytes类型写入，因为将图片发送给浏览器时需要发送bytes类型的数据")])])])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[t._v("from PIL import Image, ImageDraw, ImageFont")]),i("div",[i("br")]),i("div",[t._v("image = Image.new('RGB', (245, 34), (255, 255, 0))  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片对象")])],1),i("div",[i("br")]),i("div",[t._v("f = open('valid_code.png', 'wb')")]),i("div",[t._v("image.save(f, 'png')  "),i("font",{attrs:{color:"#FA7A00"}},[t._v("# 使用图片对象中的save方法，生成一张图片")])],1),i("div",[i("br")]),i("div",[t._v("f = open('valid_code.png', 'rb')")]),i("div",[t._v("data = f.read()  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 读取图片")])],1)]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("ul",[i("li",[i("div",[t._v("将图片对象保存到内存中")])])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[t._v("from PIL import Image, ImageDraw, ImageFont")]),i("div",[t._v("from io import BytesIO")]),i("div",[i("br")]),i("div",[t._v("image = Image.new('RGB', (245, 34), (255, 255, 0))  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片对象")])],1),i("div",[i("br")]),i("div",[t._v("io_obj = BytesIO()  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个内存对象，相当于文件句柄")])],1),i("div",[t._v("image.save(io_obj, 'png')  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 将图片保存到内存中")])],1),i("div",[i("br")]),i("div",[t._v("data = io_obj.getvalue()  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 从io对象里面取上一步保存的数据")])],1),i("div",[t._v("io_obj.close()  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 关闭")])],1)]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("8.")]),t._v(" "),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("Django的相关操作")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("ul",[i("li",[i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[t._v("将通过")]),t._v("PIL"),i("font",{staticStyle:{"font-size":"12pt"}},[t._v("模块生成的图片发送给浏览器")])],1)])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),i("div",[i("br")]),i("div",[t._v("from PIL import Image, ImageDraw, ImageFont")]),i("div",[t._v("from io import BytesIO")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("def views_fn(request):")]),i("div",[t._v("    image = Image.new('RGB', (245, 34), (255, 255, 0))  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片对象")])],1),i("div",[i("br")]),i("div",[t._v("    io_obj = BytesIO()  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个内存对象，相当于文件句柄")])],1),i("div",[t._v("    image.save(io_obj, 'png')  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 将图片保存到内存中")])],1),i("div",[i("br")]),i("div",[t._v("    data = io_obj.getvalue()  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 从io对象里面取上一步保存的数据")])],1),i("div",[t._v("    io_obj.close()  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 关闭")])],1),i("div",[i("br")]),i("div",[t._v("    return HttpResponse(data)  "),i("font",{staticStyle:{color:"rgb(250, 122, 0)"}},[t._v("# 将bytes类型数据的图片发送给浏览器")])],1)]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("9.")]),t._v(" "),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("生成一个图片验证码")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[t._v("import random")]),i("div",[t._v("from io import BytesIO")]),i("div",[t._v("from PIL import Image, ImageDraw, ImageFont")]),i("div",[t._v("from django.shortcuts import render, redirect, HttpResponse")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("def get_vaild_img(request):")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# 随机生成RGB色值")])],1),i("div",[t._v("    def get_random_color():")]),i("div",[t._v("        return random.randint(0, 255), random.randint(0, 255), random.randint(0, 255)")]),i("div",[i("br")]),i("div",[t._v("    img_obj = Image.new('RGB', (245, 34), get_random_color())  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片对象")])],1),i("div",[t._v("    draw_obj = ImageDraw.Draw(img_obj)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个图片画笔对象")])],1),i("div",[t._v("    font_obj = ImageFont.truetype('static/font/kumo.ttf', 28)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 加载字体文件得到一个字体对象")])],1),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成验证码的随机字符串并且写在图片上")])],1),i("div",[t._v("    tmp_list = []")]),i("div",[t._v("    for i in range(5):")]),i("div",[t._v("        u = chr(random.randint(65, 90))  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成大写字母")])],1),i("div",[t._v("        l = chr(random.randint(97, 122)) "),i("font",{attrs:{color:"#41AD1C"}},[t._v(" # 生成小写字母")])],1),i("div",[t._v("        n = str(random.randint(0, 9)) "),i("font",{attrs:{color:"#41AD1C"}},[t._v(" # 生成数字，注意要转换成字符串类型")])],1),i("div",[i("br")]),i("div",[t._v("        tmp = random.choice([u, l, n])  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 随机返回一个大小写字母或数字")])],1),i("div",[t._v("        tmp_list.append(tmp)")]),i("div",[t._v("        draw_obj.text((25 + 45 * i, 0), tmp, fill=get_random_color(), font=font_obj)")]),i("div",[i("br")]),i("div",[t._v("    request.session['valid_str'] = ''.join(tmp_list)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 将随机生成的字符串写入session中，用于登陆判断")])],1),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# 给验证图片添加干扰线")])],1),i("div",[t._v("    width = 245  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 图片宽度（防止越界）")])],1),i("div",[t._v("    height = 34  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 图片宽度（防止越界）")])],1),i("div",[t._v("    for i in range(5):")]),i("div",[t._v("        x1 = random.randint(0, width)")]),i("div",[t._v("        x2 = random.randint(0, width)")]),i("div",[t._v("        y1 = random.randint(0, height)")]),i("div",[t._v("        y2 = random.randint(0, height)")]),i("div",[t._v("        draw_obj.line((x1, y1, x2, y2), fill=get_random_color())")]),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# 给验证图片添加干扰点")])],1),i("div",[t._v("    for i in range(40):")]),i("div",[t._v("        draw_obj.point((random.randint(0, width), random.randint(0, height)), fill=get_random_color())")]),i("div",[t._v("        x = random.randint(0, width)")]),i("div",[t._v("        y = random.randint(0, height)")]),i("div",[t._v("        draw_obj.arc((x, y, x + 4, y + 4), 0, 90, fill=get_random_color())")]),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v(" # 在内存中生成图片")])],1),i("div",[t._v("    io_obj = BytesIO()  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 生成一个内存对象，相当于文件句柄")])],1),i("div",[t._v("    img_obj.save(io_obj, 'png')")]),i("div",[t._v("    data = io_obj.getvalue()  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 从io对象里面取上一步保存的数据")])],1),i("div",[t._v("    io_obj.close()  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 关闭")])],1),i("div",[i("br")]),i("div",[t._v("    return HttpResponse(data)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 将bytes类型数据的图片发送给浏览器")])],1)]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])])])])])])}),[],!1,null,null,null);o.default=e.exports}}]);