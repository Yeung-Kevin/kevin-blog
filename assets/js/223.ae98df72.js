(window.webpackJsonp=window.webpackJsonp||[]).push([[223],{576:function(e,t,o){"use strict";o.r(t);var r=o(25),s=Object(r.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("div",[o("span",[o("div",[o("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[e._v("socketserver 模块 -> 解决tcp协议在socket的")]),o("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[e._v("多个客户端不能同时对服务端进行通讯")]),o("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[e._v("的问题")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"white-space":"pre-wrap","font-size":"14pt","font-family":'"Courier New"',"font-weight":"bold","line-height":"1.75"}},[e._v("1.")]),e._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e._v("固定写法")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[e._v("# server.py")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[o("br")])]),o("div",[e._v("import socketserver")]),o("div",[o("br")]),o("div",[e._v("class Myserver(socketserver.BaseRequestHandler): "),o("font",{attrs:{color:"#41AD1C"}},[e._v(" # 继承socketserver中的BaseRequestHandler类")])],1),o("div",[e._v("    def handle(self):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[e._v(" # 在 handle 方法进行数据的收发")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}}),o("font",{attrs:{color:"#E30000"}},[e._v("# self.request 就相当于 socket 中的 conn")])],1),o("div",[e._v("        msg = self.request.recv(1024).decode('utf-8')")]),o("div",[e._v("        print(msg)")]),o("div",[e._v("        self.request.send(bytes('你好', encoding='utf-8'))")]),o("div",[o("br")]),o("div",[e._v("if __name__ == '__main__':")]),o("div",[e._v("    server = socketserver.ThreadingTCPServer(('127.0.0.1', 8080), Myserver)  "),o("font",{attrs:{color:"#41AD1C"}},[e._v("# 实例化一个server对象")])],1),o("div",[e._v("    server.allow_reuse_address = True "),o("font",{attrs:{color:"#41AD1C"}},[e._v(" # 允许服务端重用地址")])],1),o("div",[e._v("    server.serve_forever()  "),o("font",{attrs:{color:"#41AD1C"}},[e._v("# 让server永远运行下去，除非强制停止程序")])],1)]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"white-space":"pre-wrap","font-size":"14pt","font-family":'"Courier New"',"font-weight":"bold","line-height":"1.75"}},[e._v("2.")]),e._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e._v("仿qq -> ")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e._v("实现")]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e._v("多个客户端和服务端进行通讯 ")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[e._v("# server.py")]),o("div",[o("br")]),o("div",[e._v("import socketserver")]),o("div",[o("br")]),o("div",[e._v("class Myserver(socketserver.BaseRequestHandler):"),o("font",{attrs:{color:"#41AD1C"}},[e._v("  # 继承socketserver中的BaseRequestHandler类")])],1),o("div",[e._v("    def handle(self):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[e._v("# 在 handle 方法进行数据的收发")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}}),o("font",{attrs:{color:"#E30000"}},[e._v(" # self.request 就相当于 socket 中的 conn")])],1),o("div",[e._v("        while True:")]),o("div",[e._v("            msg = self.request.recv(1024).decode('utf-8')")]),o("div",[e._v("            print(msg)")]),o("div",[e._v("            if '再见' in msg:")]),o("div",[e._v("                self.request.send(bytes('再见', encoding='utf-8'))")]),o("div",[e._v("                break")]),o("div",[e._v("            info = input('%s>>>' % msg[:4])")]),o("div",[e._v("            self.request.send(bytes(info, encoding='utf-8'))")]),o("div",[o("br")]),o("div",[e._v("if __name__ == '__main__':")]),o("div",[e._v("    server = socketserver.ThreadingTCPServer(('127.0.0.1', 8080), Myserver)  "),o("font",{attrs:{color:"#41AD1C"}},[e._v("# 实例化一个server对象")])],1),o("div",[e._v("    server.allow_reuse_address = True  "),o("font",{attrs:{color:"#41AD1C"}},[e._v("# 允许服务端重用地址")])],1),o("div",[e._v("    server.serve_forever()  "),o("font",{attrs:{color:"#41AD1C"}},[e._v("# 让server永远运行下去，除非强制停止程序")])],1)]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[e._v("# client1.py")]),o("div",[o("br")]),o("div",[e._v("import socket")]),o("div",[o("br")]),o("div",[e._v("sk = socket.socket()")]),o("div",[e._v("sk.connect(('127.0.0.1', 8080))")]),o("div",[e._v("while True:")]),o("div",[e._v("    info = input('请输入向服务端发送的消息：')")]),o("div",[e._v("    sk.send(bytes('客户端1：' + info, encoding='utf-8'))")]),o("div",[e._v("    msg = sk.recv(1024).decode('utf-8')")]),o("div",[e._v("    print(msg)")]),o("div",[e._v("    if msg == '再见':")]),o("div",[e._v("        sk.send(bytes('客户端1：再见', encoding='utf-8'))")]),o("div",[e._v("        break")]),o("div",[o("br")]),o("div",[e._v("sk.close()")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[e._v("# client2.py")]),o("div",[o("br")]),o("div",[e._v("import socket")]),o("div",[o("br")]),o("div",[e._v("sk = socket.socket()")]),o("div",[e._v("sk.connect(('127.0.0.1', 8080))")]),o("div",[e._v("while True:")]),o("div",[e._v("    info = input('请输入向服务端发送的消息：')")]),o("div",[e._v("    sk.send(bytes('客户端2：' + info, encoding='utf-8'))")]),o("div",[e._v("    msg = sk.recv(1024).decode('utf-8')")]),o("div",[e._v("    print(msg)")]),o("div",[e._v("    if msg == '再见':")]),o("div",[e._v("        sk.send(bytes('客户端1：再见', encoding='utf-8'))")]),o("div",[e._v("        break")]),o("div",[o("br")]),o("div",[e._v("sk.close()")])]),o("div",[o("br")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);