(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{361:function(e,t,o){"use strict";o.r(t);var a=o(25),i=Object(a.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("div",[o("span",[o("div",[o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[e._v("分组查询的介绍")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[e._v("使用 .annotate() 进行分组查询")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[e._v("语法: ")])])]),o("ul",[o("li",[o("div",[e._v(".annotate(自定义key的名称=聚合函数方法名('表的类名')) -> 表的类名需要小写 -> 连表操作后进行分组")])]),o("li",[o("div",[e._v(".annotate(自定义key的名称=聚合函数方法名('表的类名__字段名')) -> 连表操作后进行分组")])]),o("li",[o("div",[e._v(".annotate(自定义key的名称=聚合函数方法名('字段名')) -> 对自身表进行分组")])])])]),o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[e._v("单表分组查询")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("font",{staticStyle:{color:"rgb(255, 0, 0)"}},[e._v("在单表分组查询中 .values('字段名') 里面填写这什么字段名，就以这个字段名进行分组")])],1)])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[e._v("查询每个部门的平均工资 -> 先将需要分组的部门字段数据查询出来")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[e._v("# models.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[e._v("# 员工表")])],1),o("div",[e._v("class Staff(models.Model):")]),o("div",[e._v("    name = models.CharField(max_length=10, verbose_name='姓名')")]),o("div",[e._v("    age = models.IntegerField(verbose_name='年龄')")]),o("div",[e._v("    salary = models.IntegerField(verbose_name='薪资')")]),o("div",[e._v("    address = models.CharField(max_length=10, verbose_name='地址')")]),o("div",[e._v("    dep = models.CharField(max_length=10, verbose_name='部门')")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[e._v("# views.py")])],1),o("div",[o("br")]),o("div",[e._v("from app01.models import *")]),o("div",[e._v("from django.db.models import Sum, Avg, Max, Min, Count")]),o("div",[o("br")]),o("div",[e._v("dep_data = Staff.objects.values('dep').annotate(avg=Avg('salary')).values('dep', 'avg')")]),o("div",[e._v("for dep in dep_data:")]),o("div",[e._v("    print('部门:{}, 薪资:{}'.format(dep['dep'], dep['avg']))")])]),o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[e._v("多表分组查询")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[e._v("多表分组查询，即: 连表查询")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[e._v("多表分组查询可以直接使用 .all() 方法")])]),o("div",[o("font",{staticStyle:{"font-size":"14pt"}},[o("br")])],1),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[e._v("多表分组查询的执行顺序: 先进行连表操作，然后将分组后得到的结果放到 .all() 方法查询出来的每一个对象下  ")])]),o("div",[o("font",{staticStyle:{"font-size":"14pt"}},[o("br")])],1),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[e._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e._v("多表分组查询的相关例子")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[e._v("统计每一名老师所带的班的个数")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[e._v("from app01.models import *")]),o("div",[e._v("from django.db.models import Sum, Avg, Max, Min, Count")]),o("div",[o("br")]),o("div",[e._v("teacher_data = Teacher.objects.all().annotate(class_num=Count('classes'))")]),o("div",[e._v("for teacher in teacher_data:")]),o("div",[e._v("    print('老师名称:{}, 班级个数:{}'.format(teacher.name, teacher.class_num))")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[e._v("统计每个班级有多少名学生")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[e._v("from app01.models import *")]),o("div",[e._v("from django.db.models import Sum, Avg, Max, Min, Count")]),o("div",[o("br")]),o("div",[e._v("classes_data = Classes.objects.all().annotate(student_num=Count('student'))")]),o("div",[e._v("for classes in classes_data:")]),o("div",[e._v("    print('班级名称:{}, 学生个数:{}'.format(classes.name, classes.student_num))")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[e._v("查询班级人数大于2的班级")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[e._v("from app01.models import *")]),o("div",[e._v("from django.db.models import Sum, Avg, Max, Min, Count")]),o("div",[o("br")]),o("div",[e._v("classes_data = Classes.objects.all().annotate(student_num=Count('student')).filter(student_num__gt=1)")]),o("div",[e._v("for classes in classes_data:")]),o("div",[e._v("    print('班级名称:{}, 学生个数:{}'.format(classes.name, classes.student_num))")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[e._v("统计每个班级的平均年龄")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[e._v("from app01.models import *")]),o("div",[e._v("from django.db.models import Sum, Avg, Max, Min, Count")]),o("div",[o("br")]),o("div",[e._v("classes_data = Classes.objects.all().annotate(student_avg=Avg('student__age')).values('name', 'student_avg')")]),o("div",[e._v("print(classes_data)  "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[e._v("# <QuerySet [{'student_avg': 21.5, 'name': '一班'}, {'student_avg': 23.0, 'name': '二班'}, {'student_avg': 25.0, 'name': '三班'}, {'student_avg': 30.0, 'name': '四班'}]>")])]),o("div",[e._v("for classes in classes_data:")]),o("div",[e._v("    print('班级名称:{}, 学生平均年龄:{}'.format(classes['name'], classes['student_avg']))")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[e._v("统计每个班级的平均年龄，然后以平均年龄进行倒序排序")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[e._v("from app01.models import *")]),o("div",[e._v("from django.db.models import Sum, Avg, Max, Min, Count")]),o("div",[o("br")]),o("div",[e._v("classes_data = Classes.objects.all().annotate(student_avg=Avg('student__age')).order_by('-student_avg')")]),o("div",[e._v("for classes in classes_data:")]),o("div",[e._v("    print('班级名称:{}, 学生平均年龄:{}'.format(classes.name, classes.student_avg))")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("br")])]),o("div",[o("br")])])])])}),[],!1,null,null,null);t.default=i.exports}}]);