(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{396:function(i,o,t){"use strict";t.r(o);var e=t(25),r=Object(e.a)({},(function(){var i=this,o=i.$createElement,t=i._self._c||o;return t("ContentSlotsDistributor",{attrs:{"slot-key":i.$parent.slotKey}},[t("div",[t("span",[t("div",[t("div",[t("div",[t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("什么是 JSON ？")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("JSON 指的是 JavaScript 对象表示法（JavaScript Object Notation）")])]),t("li",[t("div",[i._v("JSON 是轻量级的文本数据交换格式")])]),t("li",[t("div",[i._v("JSON 独立于语言")])]),t("li",[t("div",[i._v("JSON 具有自我描述性，更易理解")])]),t("li",[t("div",[i._v("JSON 为了实现跨语言传输数据")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("合格的JSON对象")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v('["one", "two", "three"]')]),t("div",[i._v('{ "one": 1, "two": 2, "three": 3 }')]),t("div",[i._v('{"names": ["张三", "李四"] }')]),t("div",[i._v('[ { "name": "张三"}, {"name": "李四"} ]　')])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("不合格的JSON对象")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("{ name: \"张三\", 'age': 32 }  "),t("font",{attrs:{color:"#41AD1C"}},[i._v("// 属性名必须使用双引号")])],1),t("div",[i._v("[32, 64, 128, 0xFFF] "),t("font",{attrs:{color:"#41AD1C"}},[i._v("// 不能使用十六进制值")])],1),t("div",[i._v('{ "name": "张三", "age": undefined }  '),t("font",{attrs:{color:"#41AD1C"}},[i._v("// 不能使用undefined")])],1),t("div",[i._v('{ "name": "张三",')]),t("div",[i._v("  \"birthday\": new Date('Fri, 26 Aug 2011 07:13:10 GMT'),")]),t("div",[i._v('  "getName":  function() {return this.name;}  '),t("font",{attrs:{color:"#41AD1C"}},[i._v("// 不能使用函数和日期对象")])],1),t("div",[i._v("}")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"867021-20180407213606833-7828970222.jpg",src:"/kevin-blog/Django/Ajax_files/867021-20180407213606833-7828970222.jpg",type:"image/jpeg",width:"795"}})]),t("div",[t("br")]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("和XML的比较")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[i._v("JSON 格式于2001年由 Douglas Crockford 提出，目的就是取代繁琐笨重的 XML 格式")]),i._v("。")]),t("div",[t("br")]),t("div",[i._v("JSON 格式有两个显著的优点：书写简单，一目了然；符合 JavaScript 原生语法，可以由解释引擎直接处理，不用另外添加解析代码。所以，JSON迅速被接受，已经成为各大网站交换数据的标准格式，并被写入ECMAScript 5，成为标准的一部分。")]),t("div",[t("br")]),t("div",[i._v("XML和JSON都使用结构化方法来标记数据，下面来做一个简单的比较。")]),t("div",[t("br")]),t("div",[i._v("用XML表示中国部分省市数据如下")]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v('<?xml version="1.0" encoding="utf-8"?>')]),t("div",[i._v("<country>")]),t("div",[i._v("    <name>中国</name>")]),t("div",[i._v("    <province>")]),t("div",[i._v("        <name>黑龙江</name>")]),t("div",[i._v("        <cities>")]),t("div",[i._v("            <city>哈尔滨</city>")]),t("div",[i._v("            <city>大庆</city>")]),t("div",[i._v("        </cities>")]),t("div",[i._v("    </province>")]),t("div",[i._v("    <province>")]),t("div",[i._v("        <name>广东</name>")]),t("div",[i._v("        <cities>")]),t("div",[i._v("            <city>广州</city>")]),t("div",[i._v("            <city>深圳</city>")]),t("div",[i._v("            <city>珠海</city>")]),t("div",[i._v("        </cities>")]),t("div",[i._v("    </province>")]),t("div",[i._v("    <province>")]),t("div",[i._v("        <name>台湾</name>")]),t("div",[i._v("        <cities>")]),t("div",[i._v("            <city>台北</city>")]),t("div",[i._v("            <city>高雄</city>")]),t("div",[i._v("        </cities>")]),t("div",[i._v("    </province>")]),t("div",[i._v("    <province>")]),t("div",[i._v("        <name>新疆</name>")]),t("div",[i._v("        <cities>")]),t("div",[i._v("            <city>乌鲁木齐</city>")]),t("div",[i._v("        </cities>")]),t("div",[i._v("    </province>")]),t("div",[i._v("</country>")])]),t("div",[t("br")]),t("div",[i._v("用JSON表示如下：")]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("{")]),t("div",[i._v('    "name": "中国",')]),t("div",[i._v('    "province": [{')]),t("div",[i._v('        "name": "黑龙江",')]),t("div",[i._v('        "cities": {')]),t("div",[i._v('            "city": ["哈尔滨", "大庆"]')]),t("div",[i._v("        }")]),t("div",[i._v("    }, {")]),t("div",[i._v('        "name": "广东",')]),t("div",[i._v('        "cities": {')]),t("div",[i._v('            "city": ["广州", "深圳", "珠海"]')]),t("div",[i._v("        }")]),t("div",[i._v("    }, {")]),t("div",[i._v('        "name": "台湾",')]),t("div",[i._v('        "cities": {')]),t("div",[i._v('            "city": ["台北", "高雄"]')]),t("div",[i._v("        }")]),t("div",[i._v("    }, {")]),t("div",[i._v('        "name": "新疆",')]),t("div",[i._v('        "cities": {')]),t("div",[i._v('            "city": ["乌鲁木齐"]')]),t("div",[i._v("        }")]),t("div",[i._v("    }]")]),t("div",[i._v("}")])]),t("div",[t("br")]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("AJAX的介绍")])]),t("div",[t("br")])]),t("div",[i._v("AJAX（Asynchronous Javascript And XML）翻译成中文就是“异步的Javascript和XML”。即使用Javascript语言与服务器进行异步交互，传输的数据为XML（当然，传输的数据不只是XML）。")]),t("div",[t("br")]),t("div",[i._v("AJAX 不是新的编程语言，而是一种使用现有标准的新方法。")]),t("div",[t("br")]),t("div",[i._v("AJAX 最大的优点是在不重新加载整个页面的情况下，可以与服务器交换数据并更新部分网页内容。（这一特点给用户的感受是在不知不觉中完成请求和响应过程）")]),t("div",[t("br")]),t("div",[i._v("AJAX 不需要任何浏览器插件，但需要用户允许JavaScript在浏览器上执行。")]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("同步交互：客户端发出一个请求后，需要等待服务器响应结束后，才能发出第二个请求；")])]),t("li",[t("div",[i._v("异步交互：客户端发出一个请求后，无需等待服务器响应结束，就可以发出第二个请求。")])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 登陆示例")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# login.html")])],1),t("div",[t("br")]),t("div",[i._v("<!DOCTYPE html>")]),t("div",[i._v("<html>")]),t("div",[i._v("<head>")]),t("div",[i._v('    <meta charset="utf-8">')]),t("div",[i._v('    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">')]),t("div",[i._v("    <title>Title</title>")]),t("div",[i._v('    <meta name="description" content="">')]),t("div",[i._v('    <meta name="keywords" content="">')]),t("div",[i._v('    <link rel="stylesheet" href="">')]),t("div",[i._v("    <script type=\"text/javascript\" src=''><\/script>")]),t("div",[i._v("</head>")]),t("div",[i._v("<body>")]),t("div",[i._v("<h1>登陆页面</h1>")]),t("div",[i._v('<input type="text" name="" id="username" placeholder="用户名">')]),t("div",[i._v('<input type="text" name="" id="password" placeholder="密码">')]),t("div",[i._v('<button type="button" id="login">登陆</button>')]),t("div",[t("br")]),t("div",[i._v("{% load static %}")]),t("div",[i._v('<script type="text/javascript" src="{% static \'js/jquery-3.2.1.min.js\' %}"><\/script>')]),t("div",[i._v('<script type="text/javascript">')]),t("div",[i._v("    $(function () {")]),t("div",[i._v("        $('#login').click(function () {")]),t("div",[i._v("            var username = $('#username').val();")]),t("div",[i._v("            var password = $('#password').val();")]),t("div",[i._v("            $.ajax({")]),t("div",[i._v("                url: '/check_login/',")]),t("div",[i._v("                type: 'get',")]),t("div",[i._v("                data: {")]),t("div",[i._v("                    username: username,")]),t("div",[i._v("                    password: password")]),t("div",[i._v("                },")]),t("div",[i._v("                success: function (res) {")]),t("div",[i._v("                    alert(res)")]),t("div",[i._v("                }")]),t("div",[i._v("            })")]),t("div",[i._v("        })")]),t("div",[i._v("    })")]),t("div",[i._v("<\/script>")]),t("div",[i._v("</body>")]),t("div",[i._v("</html>")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),t("div",[t("br")]),t("div",[i._v("from django.shortcuts import render, redirect, HttpResponse")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[i._v("def login(request):")]),t("div",[i._v("    return render(request, 'login.html')")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[i._v("def check_login(request):")]),t("div",[i._v("    username = request.GET.get('username')")]),t("div",[i._v("    password = request.GET.get('password')")]),t("div",[t("br")]),t("div",[i._v("    if username == 'Kevin' and password == '123':")]),t("div",[i._v("        res_str = '登陆成功'")]),t("div",[i._v("    else:")]),t("div",[i._v("        res_str = '登陆失败'")]),t("div",[t("br")]),t("div",[i._v("    return HttpResponse(res_str)")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# urls.py")])],1),t("div",[t("br")]),t("div",[i._v("from django.conf.urls import url, include")]),t("div",[i._v("from app01.views import *")]),t("div",[t("br")]),t("div",[i._v("urlpatterns = [")]),t("div",[i._v("    url(r'^login/$', login),")]),t("div",[i._v("    url(r'^check_login/$', check_login),")]),t("div",[i._v("]")])]),t("div",[t("br")]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("AJAX请求设置csrf_token")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)"}},[i._v("注意:")]),i._v(" "),t("span",{staticStyle:{"font-size":"14pt"}},[i._v("csrf_token验证只作用于POST的请求，GET等其他请求Django都会不进行验证，所以POST请求除外的都无需设置csrf_token")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 方法一")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("通过获取隐藏的input标签中的csrfmiddlewaretoken值，放置在data中发送")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("var csrf_token_val = $(\"[name = 'csrfmiddlewaretoken']\").val();")]),t("div",[i._v("$.ajax({")]),t("div",[i._v('    url: "/cookie_ajax/",')]),t("div",[i._v('    type: "POST",')]),t("div",[i._v("    data: {")]),t("div",[i._v('        "username": "Q1mi",')]),t("div",[i._v('        "password": 123456,')]),t("div",[i._v('        "csrfmiddlewaretoken": csrf_token_val // 使用jQuery取出csrfmiddlewaretoken的值，拼接到data中')]),t("div",[i._v("    },")]),t("div",[i._v("    success: function (data) {")]),t("div",[i._v("        console.log(data);")]),t("div",[i._v("    }")]),t("div",[i._v("})")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("2.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 方法二")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("通过获取返回的cookie中的字符串 放置在请求头中发送")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("使用jquery.cookie.js插件获取cookie")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("$.ajax({")]),t("div",[i._v('    url: "/cookie_ajax/",')]),t("div",[i._v('    type: "POST",')]),t("div",[i._v("    headers: {\"X-CSRFToken\": $.cookie('csrftoken')},  "),t("font",{attrs:{color:"#41AD1C"}},[i._v("// 从Cookie取csrf_token，并设置到请求头中")])],1),t("div",[i._v("    data: {")]),t("div",[i._v('        "username": "Q1mi",')]),t("div",[i._v('        "password": 123456')]),t("div",[i._v("    },")]),t("div",[i._v("    success: function (data) {")]),t("div",[i._v("        console.log(data);")]),t("div",[i._v("    }")]),t("div",[i._v("})")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("自己编写获取cookie的代码")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("function getCookie(name) {")]),t("div",[i._v("    var cookieValue = null;")]),t("div",[i._v("    if (document.cookie && document.cookie !== '') {")]),t("div",[i._v("        var cookies = document.cookie.split(';');")]),t("div",[i._v("        for (var i = 0; i < cookies.length; i++) {")]),t("div",[i._v("            var cookie = jQuery.trim(cookies[i]);")]),t("div",[i._v("            // Does this cookie string begin with the name we want?")]),t("div",[i._v("            if (cookie.substring(0, name.length + 1) === (name + '=')) {")]),t("div",[i._v("                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));")]),t("div",[i._v("                break;")]),t("div",[i._v("            }")]),t("div",[i._v("        }")]),t("div",[i._v("    }")]),t("div",[i._v("    return cookieValue;")]),t("div",[i._v("}")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[i._v("var csrftoken = getCookie('csrftoken');")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[i._v("$.ajax({")]),t("div",[i._v('    url: "/cookie_ajax/",')]),t("div",[i._v('    type: "POST",')]),t("div",[i._v('    headers: {"X-CSRFToken": csrftoken},  '),t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("// 从Cookie取csrf_token，并设置到请求头中")])],1),t("div",[i._v("    data: {")]),t("div",[i._v('        "username": "Q1mi",')]),t("div",[i._v('        "password": 123456')]),t("div",[i._v("    },")]),t("div",[i._v("    success: function (data) {")]),t("div",[i._v("        console.log(data);")]),t("div",[i._v("    }")]),t("div",[i._v("})")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("3.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 方法三 -> "),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold",color:"rgb(227, 0, 0)"}},[i._v("官方推荐方法")])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("a",{staticStyle:{"font-size":"12pt",color:"black","font-variant-caps":"normal","font-variant-ligatures":"normal","text-decoration":"underline"},attrs:{href:"https://docs.djangoproject.com/en/1.11/ref/csrf/"}},[i._v("Djagno官方文档中关于CSRF的内容")])])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[i._v("编写一个单独的js文件，用作于在每一次post的请求前，将 csrf_token 添加到请求头中，这样就无需在每一次编写AJAX的POST请求的时候添加请求头了（即: 方法二）")])])]),t("div",[t("br")]),t("div",[t("a",{attrs:{href:"Ajax_files/setupajax.js"}},[t("img",{attrs:{alt:"setupajax.js",src:"/kevin-blog/Django/Ajax_files/a340ebd5fdc3c835dcd05fec075cfc35.png"}})])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# setupajax.js")])],1),t("div",[t("br")]),t("div",[i._v("function getCookie(name) {")]),t("div",[i._v("    var cookieValue = null;")]),t("div",[i._v("    if (document.cookie && document.cookie !== '') {")]),t("div",[i._v("        var cookies = document.cookie.split(';');")]),t("div",[i._v("        for (var i = 0; i < cookies.length; i++) {")]),t("div",[i._v("            var cookie = jQuery.trim(cookies[i]);")]),t("div",[i._v("            if (cookie.substring(0, name.length + 1) === (name + '=')) {")]),t("div",[i._v("                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));")]),t("div",[i._v("                break;")]),t("div",[i._v("            }")]),t("div",[i._v("        }")]),t("div",[i._v("    }")]),t("div",[i._v("    return cookieValue;")]),t("div",[i._v("}")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[i._v("var csrftoken = getCookie('csrftoken');")]),t("div",[t("br")]),t("div",[i._v("function csrfSafeMethod(method) {")]),t("div",[i._v("    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));  "),t("font",{attrs:{color:"#41AD1C"}},[i._v("//验证是否是 GET|HEAD|OPTIONS|TRACE ，如果是就无需往请求头中添加csrf_token")])],1),t("div",[i._v("}")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[i._v("$.ajaxSetup({")]),t("div",[i._v("    beforeSend: function (xhr, settings) {")]),t("div",[i._v("        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {")]),t("div",[i._v('            xhr.setRequestHeader("X-CSRFToken", csrftoken);  '),t("font",{attrs:{color:"#41AD1C"}},[i._v("// 将 csrf_token 添加到请求头中")])],1),t("div",[i._v("        }")]),t("div",[i._v("    }")]),t("div",[i._v("});")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[t("font",{attrs:{color:"#41AD1C"}},[i._v("# xxx.html")])],1)]),t("div",[t("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[t("br")])]),t("div",[i._v("{% load static %}")]),t("div",[i._v('<script type="text/javascript" src="{% static \'js/jquery-3.2.1.min.js\' %}"><\/script>')]),t("div",[i._v('<script type="text/javascript" src="{% static \'js/setupajax.js\' %}"><\/script>')]),t("div",[t("br")]),t("div",[i._v('<script type="text/javascript">')]),t("div",[i._v("    $(function () {")]),t("div",[i._v("        $('#login').click(function () {")]),t("div",[i._v("            var username = $('#username').val();")]),t("div",[i._v("            var password = $('#password').val();")]),t("div",[i._v("            $.ajax({")]),t("div",[i._v("                url: '/check_login/',")]),t("div",[i._v("                type: 'post',")]),t("div",[i._v("                data: {")]),t("div",[i._v("                    username: username,")]),t("div",[i._v("                    password: password")]),t("div",[i._v("                },")]),t("div",[i._v("                success: function (res) {")]),t("div",[i._v("                    alert(res)")]),t("div",[i._v("                }")]),t("div",[i._v("            })")]),t("div",[i._v("        })")]),t("div",[i._v("    })")]),t("div",[i._v("<\/script>")])]),t("div",[t("br")])]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-size":"21px","font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("前端发送列表给Django的注意事项")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[i._v("注意:")]),i._v(" 前端发送列表给Django的时候最好先将列表转换为字符串再发送，不然Django是无法接受直接发送过来的列表，js对象也一样")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("$.ajax({")]),t("div",[i._v("    url: '/check_login/',")]),t("div",[i._v("    type: 'get',")]),t("div",[i._v("    dataType: 'json',")]),t("div",[i._v("    data: {")]),t("div",[i._v("        array: JSON.stringify([1, 2, 3, 4, 5])  "),t("font",{attrs:{color:"#41AD1C"}},[i._v("# 先将列表转换为字符串，然后再进行发送")])],1),t("div",[i._v("    },")]),t("div",[i._v("    success: function (res) {")]),t("div",[i._v("        alert(res)")]),t("div",[i._v("    }")]),t("div",[i._v("})")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),t("div",[t("br")]),t("div",[i._v("from django.shortcuts import render, redirect, HttpResponse")]),t("div",[i._v("import json")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[i._v("def check_login(request):")]),t("div",[i._v("    str_array = request.GET.get('array')")]),t("div",[i._v("    print(str_array)  "),t("font",{attrs:{color:"#41AD1C"}},[i._v("# 字符串类型的列表: [1,2,3,4,5]")])],1),t("div",[t("br")]),t("div",[i._v("    array = json.loads(str_array)")]),t("div",[i._v("    print(array)  "),t("font",{attrs:{color:"#41AD1C"}},[i._v("# list 类型: [1, 2, 3, 4, 5]")])],1),t("div",[t("br")]),t("div",[i._v("    return HttpResponse('xxx')")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("traditional: true -> 无需将列表转换为字符串，直接进行发送，但是不能发送多维列表，否则Django所接受到的列表格式是有问题的")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("$.ajax({")]),t("div",[i._v("    url: '/check_login/',")]),t("div",[i._v("    type: 'get',")]),t("div",[i._v("    traditional: true,  "),t("font",{attrs:{color:"#41AD1C"}},[i._v("# 加上此项")])],1),t("div",[i._v("    dataType: 'json',")]),t("div",[i._v("    data: {")]),t("div",[i._v("        array: [1, 2, 3, 4, 5],")]),t("div",[i._v("        m_array: [[1, 2], [3, 4]]")]),t("div",[i._v("    },")]),t("div",[i._v("    success: function (res) {")]),t("div",[i._v("        alert(res)")]),t("div",[i._v("    }")]),t("div",[i._v("})")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[t("br")])],1),t("div",[i._v("def check_login(request):")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# 接受普通列表")])],1),t("div",[i._v("    array = request.GET.getlist('array')")]),t("div",[i._v("    print(array)  "),t("font",{attrs:{color:"#41AD1C"}},[i._v("# ['1', '2', '3', '4', '5']")])],1),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# 接受多维列表 -> 有问题")])],1),t("div",[i._v("    m_array = request.GET.getlist('m_array')")]),t("div",[i._v("    print(m_array)  "),t("font",{attrs:{color:"#41AD1C"}},[i._v("# ['1,2', '3,4']")])],1),t("div",[t("br")]),t("div",[i._v("    return HttpResponse('xxx')")])]),t("div",[t("br")])]),t("div",[t("br")])])])])}),[],!1,null,null,null);o.default=r.exports}}]);