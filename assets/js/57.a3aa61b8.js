(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{408:function(o,i,t){"use strict";t.r(i);var r=t(25),e=Object(r.a)({},(function(){var o=this,i=o.$createElement,t=o._self._c||i;return t("ContentSlotsDistributor",{attrs:{"slot-key":o.$parent.slotKey}},[t("div",[t("span",[t("div",[t("div",[t("div",[t("div",[o._v("注意: 本章节会省略一些参数或方法的详细说明，因为在Form组件章节中提及到")]),t("div",[t("br")]),t("div",[o._v("ModelForm: ")]),t("div",[t("br")]),t("ul",[t("li",[t("div",[o._v("通过 Model类（即: models.py 中的表类） 生成 form类（即: Form组件中所要创建的类）")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[o._v("Form 组件有的，ModelForm 组件也有，Form 组件没有的，ModelForm 组件也有")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[o._v("不要认为用了")]),o._v("ModelForm"),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("组件就一定要用它的自动渲染form表单功能，")]),o._v("ModelForm"),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("组件只用于验证，不做form表单渲染也是可以的，因为最后都是从 request.POST 中获取数据进行验证，前提是 form表单中的 name 需要和 form类中的字段名一致")])])])]),t("div",[t("br")]),t("div",[o._v("ModelForm 的校验:")]),t("div",[t("br")]),t("ul",[t("li",[t("div",[o._v("ModelForm 的校验是根据 Model类（即: models.py 中的表类）中的 字段 或 字段参数来判断传递过来的数据是否正确（和Form组件中的校验情况差不多，只不过Form组件是用Form类中的字段进行校验，而ModelForm是用Model类中的字段进行校验）")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[o._v("在 Model类（即: models.py 中的表类）"),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("中，")]),t("span",{staticStyle:{"white-space":"pre-wrap","overflow-wrap":"break-word","font-size":"12pt","line-height":"1.5"}},[o._v("EmailField、")]),o._v(" "),t("span",{staticStyle:{"font-size":"12pt","white-space":"pre-wrap","overflow-wrap":"break-word","line-height":"1.5"}},[o._v("URLField、")]),o._v(" "),t("span",{staticStyle:{"font-size":"12pt","white-space":"pre-wrap","overflow-wrap":"break-word","line-height":"1.5"}},[o._v("UUIDField 等字段只有在使用ModelForm的时候才有意义，因为这些字段是在使用ModelForm的时候验证传递过来的数据是否正确的时候使用的")])])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("1.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 本章节所用到的表")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# models.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.db import models")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class Book(models.Model):")]),t("div",[o._v("    title = models.CharField(max_length=15)")]),t("div",[o._v("    price = models.IntegerField()")]),t("div",[o._v("    publish = models.ForeignKey(to='Publish')")]),t("div",[o._v("    author = models.ManyToManyField(to='Author')")]),t("div",[t("br")]),t("div",[o._v("    def __str__(self):")]),t("div",[o._v("        return self.title")]),t("div",[t("br")]),t("div",[o._v("    class Meta:")]),t("div",[o._v('        verbose_name = "书籍"')]),t("div",[o._v("        verbose_name_plural = verbose_name")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class Publish(models.Model):")]),t("div",[o._v("    title = models.CharField(max_length=15)")]),t("div",[t("br")]),t("div",[o._v("    def __str__(self):")]),t("div",[o._v("        return self.title")]),t("div",[t("br")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        verbose_name = '出版社'")]),t("div",[o._v("        verbose_name_plural = verbose_name")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class Author(models.Model):")]),t("div",[o._v("    name = models.CharField(max_length=15)")]),t("div",[o._v("    age = models.IntegerField()")]),t("div",[o._v("    authorDetail = models.OneToOneField(to=\"AuthorDetail\", on_delete=models.CASCADE, verbose_name='作者详情')  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 与AuthorDetail建立一对一的关系")])],1),t("div",[t("br")]),t("div",[o._v("    def __str__(self):")]),t("div",[o._v("        return self.name")]),t("div",[t("br")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        verbose_name = '作者'")]),t("div",[o._v("        verbose_name_plural = verbose_name")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class AuthorDetail(models.Model):")]),t("div",[o._v("    birthday = models.DateField(verbose_name='生日')")]),t("div",[o._v("    telephone = models.BigIntegerField(verbose_name='电话')")]),t("div",[o._v("    addr = models.CharField(max_length=64, verbose_name='地址')")]),t("div",[t("br")]),t("div",[o._v("    def __str__(self):")]),t("div",[o._v("        return str(self.telephone)")]),t("div",[t("br")]),t("div",[o._v("    class Meta:")]),t("div",[o._v('        verbose_name = "作者详情表"')]),t("div",[o._v("        verbose_name_plural = verbose_name")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("2.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 创建 ModelForm")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[o._v("通过Model类，生成form类")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py 或 forms.py")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[t("br")])],1),t("div",[o._v("from django.shortcuts import render, HttpResponse, redirect")]),t("div",[o._v("from .models import *")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[o._v("from django.forms import widgets as wid  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 因为widgets和ModelForm中的参数重名了，所以起个别名")])],1),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class BookForm(ModelForm):")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = Book  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 根据 Book 表类创建 Form 类")])],1),t("div",[o._v("        fields = '__all__'  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用 Book 表类的所有字段，")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("#")]),o._v(" fields = ['title', 'price', 'publish', 'author']  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用 Book 表类的某几个字段")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("#")]),o._v(" exclude = ['publish', 'author']  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 排除某些字段，一般和 fields = '__all__' 搭配使用")])],1),t("div",[o._v("        labels = {  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 和 Form 组件中的 label 作用是一样的")])],1),t("div",[o._v("            'title': '书籍名称',")]),t("div",[o._v("            'price': '价格',")]),t("div",[o._v("            'publish': '出版社',")]),t("div",[o._v("            'author': '作者'")]),t("div",[o._v("        }")]),t("div",[o._v("        error_messages = {  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 错误信息")])],1),t("div",[o._v("            'title': {'required': \"书籍名称不能为空\"},")]),t("div",[o._v("            'price': {'required': \"价格不能为空\"},")]),t("div",[o._v("            'publish': {'required': \"请选择出版社\"},")]),t("div",[o._v("            'author': {'required': \"请选择作者\"},")]),t("div",[o._v("        }")]),t("div",[o._v("        widgets = {  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 和 Form 组件中的 widgets作用是一样的")])],1),t("div",[o._v("            'title': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'price': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'publish': wid.Select(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'author': wid.CheckboxSelectMultiple(attrs={'class': 'form-control'})")]),t("div",[o._v("        }")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("3.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 使用 ModelForm 渲染 Form 表单")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[o._v("和 Form 组件的使用方式是一样的")])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.shortcuts import render, HttpResponse, redirect")]),t("div",[o._v("from .models import *")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[o._v("from django.forms import widgets as wid")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class BookForm(ModelForm):")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = Book")]),t("div",[o._v("        fields = '__all__'  ")]),t("div",[o._v("        labels = {")]),t("div",[o._v("            'title': '书籍名称',")]),t("div",[o._v("            'price': '价格',")]),t("div",[o._v("            'publish': '出版社',")]),t("div",[o._v("            'author': '作者'")]),t("div",[o._v("        }")]),t("div",[o._v("        error_messages = {  ")]),t("div",[o._v("            'title': {'required': \"书籍名称不能为空\"},")]),t("div",[o._v("            'price': {'required': \"价格不能为空\"},")]),t("div",[o._v("            'publish': {'required': \"请选择出版社\"},")]),t("div",[o._v("            'author': {'required': \"请选择作者\"},")]),t("div",[o._v("        }")]),t("div",[o._v("        widgets = {  ")]),t("div",[o._v("            'title': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'price': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'publish': wid.Select(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'author': wid.CheckboxSelectMultiple(attrs={'class': 'form-control'})")]),t("div",[o._v("        }")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def add_book(request):")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("book_form")]),o._v(" = BookForm()  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 实例化一个表单类")])],1),t("div",[o._v("    return render(request, 'add.html', {'book_form': "),t("font",{attrs:{color:"#FA7A00"}},[o._v("book_form")]),o._v("})  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 将表单类传递给HTML模板，然后渲染出form表单")])],1)]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# add.html")])],1),t("div",[t("br")]),t("div",[o._v('<form action="" method="post" novalidate>')]),t("div",[o._v("    {% csrf_token %}")]),t("div",[t("br")]),t("div",[o._v("    {% for field in book_form %}")]),t("div",[o._v("        <div>")]),t("div",[o._v("            "+o._s("{{ field.label }}"))]),t("div",[o._v("            "+o._s("{{ field }}"))]),t("div",[o._v("        </div>")]),t("div",[o._v("    {% endfor %}")]),t("div",[t("br")]),t("div",[o._v('    <input type="submit">')]),t("div",[o._v("</form>")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("4.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("使用 ModelForm 渲染 Form 表单，并且将对应数据自动填写到表单中（即: 修改页面）")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"16px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal"}},[o._v("通过")]),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("Form")]),t("span",{staticStyle:{"font-size":"16px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal"}},[o._v("组件渲染form表单，无法")]),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("将对应数据自动填写到表单中（即：无法")]),t("span",{staticStyle:{"font-size":"16px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal"}},[o._v("实现修改页面的自动填充数据效果")]),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("），但是 ModelForm 可以实现")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[o._v("instance 参数接收一个对象（即: 查询数据后得到的对象）")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.shortcuts import render, HttpResponse, redirect")]),t("div",[o._v("from .models import *")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[o._v("from django.forms import widgets as wid ")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class BookForm(ModelForm):")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = Book")]),t("div",[o._v("        fields = '__all__'  ")]),t("div",[o._v("        labels = {")]),t("div",[o._v("            'title': '书籍名称',")]),t("div",[o._v("            'price': '价格',")]),t("div",[o._v("            'publish': '出版社',")]),t("div",[o._v("            'author': '作者'")]),t("div",[o._v("        }")]),t("div",[o._v("        error_messages = {  ")]),t("div",[o._v("            'title': {'required': \"书籍名称不能为空\"},")]),t("div",[o._v("            'price': {'required': \"价格不能为空\"},")]),t("div",[o._v("            'publish': {'required': \"请选择出版社\"},")]),t("div",[o._v("            'author': {'required': \"请选择作者\"},")]),t("div",[o._v("        }")]),t("div",[o._v("        widgets = {  ")]),t("div",[o._v("            'title': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'price': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'publish': wid.Select(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'author': wid.CheckboxSelectMultiple(attrs={'class': 'form-control'})")]),t("div",[o._v("        }")]),t("div",[t("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[t("br")])]),t("div",[t("br")]),t("div",[o._v("def edit_book(request, edit_book_id):")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("edit_book_obj")]),o._v(" = Book.objects.filter(pk=edit_book_id).first()  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 查询指定的book数据")])],1),t("div",[o._v("    book_form = BookForm("),t("font",{staticStyle:{color:"rgb(250, 122, 0)"}},[o._v("instance")]),o._v("="),t("font",{attrs:{color:"#FA7A00"}},[o._v("edit_book_obj")]),o._v(")  "),t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 将查询到的数据传递给 instance 参数，从而实现将对应数据自动填写到表单中（即: 修改页面）")])],1),t("div",[o._v("    return render(request, 'add.html', {'book_form': book_form})")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# edit.html")])],1),t("div",[t("br")]),t("div",[o._v('<form action="" method="post" novalidate>')]),t("div",[o._v("    {% csrf_token %}")]),t("div",[t("br")]),t("div",[o._v("    {% for field in book_form %}")]),t("div",[o._v("        <div>")]),t("div",[o._v("            "+o._s("{{ field.label }}"))]),t("div",[o._v("            "+o._s("{{ field }}"))]),t("div",[o._v("        </div>")]),t("div",[o._v("    {% endfor %}")]),t("div",[t("br")]),t("div",[o._v('    <input type="submit">')]),t("div",[o._v("</form>")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("5.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 自定义字段所输出的表单 HTML")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# datetime_picker.html")])],1),t("div",[t("br")]),t("div",[o._v('<div class="input-group date form_date">')]),t("div",[o._v('    <input readonly class="form-control"')]),t("div",[o._v('           type="'+o._s("{{ widget.type }}")+'"')]),t("div",[o._v('           name="'+o._s("{{ widget.name }}")+'"')]),t("div",[o._v('            {% if widget.value != None %} value="'+o._s('{{ widget.value|stringformat:"s" }}')+'" {% endif %}')]),t("div",[o._v('            {% include "django/forms/widgets/attrs.html" %} />')]),t("div",[o._v('    <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>')]),t("div",[o._v("</div>")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# widgets.py")])],1),t("div",[t("br")]),t("div",[o._v("from django import forms")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class "),t("font",{attrs:{color:"#FA7A00"}},[o._v("DateTimePickerInput")]),o._v("(forms.TextInput):")],1),t("div",[o._v("    template_name = 'forms/widgets/datetime_picker.html'")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# forms/coupon.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[o._v("from jyld_backstage.models import *")]),t("div",[o._v("from django.forms import widgets as wid")]),t("div",[o._v("from xadmin.forms.widgets import "),t("font",{attrs:{color:"#FA7A00"}},[o._v("DateTimePickerInput")])],1),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class CouponModelForm(ModelForm):")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = Coupon")]),t("div",[o._v("        fields = '__all__'")]),t("div",[o._v("        widgets = {")]),t("div",[o._v("            'title': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'open_date': "),t("font",{attrs:{color:"#FA7A00"}},[o._v("DateTimePickerInput")]),o._v(",")],1),t("div",[o._v("        }")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django/ModelForm 组件_files/Image.png",type:"image/png"}})])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("6.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 获取 ModelForm 字段的相关信息")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.shortcuts import render")]),t("div",[o._v("from app01.models import *")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class UserInfoForm(ModelForm):")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = UserInfo")]),t("div",[o._v("        fields = '__all__'")]),t("div",[o._v("        labels = {")]),t("div",[o._v("            'username': '用户名',")]),t("div",[o._v("            'phone': '电话号码',")]),t("div",[o._v("            'age': '年龄',")]),t("div",[o._v("        }")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def edit_data(request):")]),t("div",[o._v("    user = UserInfo.objects.all().first()")]),t("div",[o._v("    form = UserInfoForm(instance=user)")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 获取当前标签的相关信息")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("    # form['username'] 等同于 html 模板中循环出来的 field")])],1),t("div",[o._v("    print(form['username'].__dict__)  "),t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# {'label': '用户名', 'name': 'username', ……}")])],1),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 获取当前标签属性的内容（如: class, id, value 等）")])],1),t("div",[o._v("    for data in form['username']:")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v(" # data 等同于 html 模板中循环出来的 field")])],1),t("div",[o._v("        print(data.__dict__)  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# {")]),t("font",{attrs:{color:"#FA7A00"}},[o._v("'data'")]),t("font",{attrs:{color:"#41AD1C"}},[o._v(": {'required': True, 'type': 'text', 'name': 'username', 'template_name': 'django/forms/widgets/text.html', 'is_hidden': False, 'value': 'Amy', 'attrs': {'maxlength': '32', 'id': 'id_username', 'required': True'+'}'+'}'}}, ……}")])],1),t("div",[t("br")]),t("div",[o._v("    return render(request, 'change.html', {")]),t("div",[o._v("        'form': form")]),t("div",[o._v("    })")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# xxx.html")])],1),t("div",[t("br")]),t("div",[o._v('<form method="post" novalidate>')]),t("div",[o._v("    {% csrf_token %}")]),t("div",[o._v("    {% for field in form %}")]),t("div",[o._v("        <p>")]),t("div",[o._v("            "+o._s("{{ field.label }}")+"：")]),t("div",[o._v("            <input")]),t("div",[o._v("                    type=\"{{'{'+'{'+' "),t("font",{attrs:{color:"#FA7A00"}},[o._v("field.0.data")]),o._v(".type '+'}'+'}'}}\"")],1),t("div",[o._v("                    value=\"{{'{'+'{'+' "),t("font",{attrs:{color:"#FA7A00"}},[o._v("field.0.data")]),o._v(".value '+'}'+'}'}}\"")],1),t("div",[o._v("                    id=\"{{'{'+'{'+' "),t("font",{attrs:{color:"#FA7A00"}},[o._v("field.0.data")]),o._v(".attrs.id '+'}'+'}'}}\"")],1),t("div",[o._v("                    maxlength=\"{{'{'+'{'+' "),t("font",{attrs:{color:"#FA7A00"}},[o._v("field.0.data")]),o._v(".attrs.maxlength '+'}'+'}'}}\"")],1),t("div",[o._v('                    name="'+o._s("{{ field.name }}")+'"')]),t("div",[o._v("            >")]),t("div",[o._v("        </p>")]),t("div",[o._v("    {% endfor %}")]),t("div",[o._v('    <input type="submit" value="提交">')]),t("div",[o._v("</form>")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("7.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 添加数据")])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[o._v("直接通过 ModelForm 中的 .save() 方法将提交过来的数据添加到数据库中，如果是使用 form 组件就需要自己写 orm 语句将提交过来的数据添加数据库中")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[o._v(".save() 方法的返回值就是所添加的该条数据对象")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.shortcuts import render, HttpResponse, redirect")]),t("div",[o._v("from .models import *")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[o._v("from django.forms import widgets as wid")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class BookForm(ModelForm):")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = Book  ")]),t("div",[o._v("        fields = '__all__'  ")]),t("div",[o._v("        labels = {  ")]),t("div",[o._v("            'title': '书籍名称',")]),t("div",[o._v("            'price': '价格',")]),t("div",[o._v("            'publish': '出版社',")]),t("div",[o._v("            'author': '作者'")]),t("div",[o._v("        }")]),t("div",[o._v("        error_messages = {  ")]),t("div",[o._v("            'title': {'required': \"书籍名称不能为空\"},")]),t("div",[o._v("            'price': {'required': \"价格不能为空\"},")]),t("div",[o._v("            'publish': {'required': \"请选择出版社\"},")]),t("div",[o._v("            'author': {'required': \"请选择作者\"},")]),t("div",[o._v("        }")]),t("div",[o._v("        widgets = {")]),t("div",[o._v("            'title': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'price': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'publish': wid.Select(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'author': wid.CheckboxSelectMultiple(attrs={'class': 'form-control'})")]),t("div",[o._v("        }")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def add_book(request):")]),t("div",[o._v("    if request.method == 'POST':")]),t("div",[o._v("        book_form = BookForm(request.POST)")]),t("div",[o._v("        if book_form.is_valid():")]),t("div",[t("br")]),t("div",[o._v("            book_data = book_form"),t("font",{attrs:{color:"#FA7A00"}},[o._v(".save()")]),o._v(" "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 将提交过来的数据保存到数据库")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}}),o._v("print(book_data.pk, book_data.title)  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 10 三国演义")]),t("font",{attrs:{color:"#41AD1C"}})],1),t("div",[t("br")]),t("div",[o._v("            return redirect('/books/')")]),t("div",[o._v("        else:")]),t("div",[o._v("            print(book_form.errors)")]),t("div",[o._v("            return HttpResponse('添加失败')")]),t("div",[o._v("    book_form = BookForm()")]),t("div",[o._v("    return render(request, 'add.html', {'book_form': book_form})")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# add.html")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[t("br")])],1),t("div",[o._v('<form action="" method="post" novalidate>')]),t("div",[o._v("    {% csrf_token %}")]),t("div",[t("br")]),t("div",[o._v("    {% for field in book_form %}")]),t("div",[o._v("        <div>")]),t("div",[o._v("            "+o._s("{{ field.label }}"))]),t("div",[o._v("            "+o._s("{{ field }}"))]),t("div",[o._v("        </div>")]),t("div",[o._v("    {% endfor %}")]),t("div",[t("br")]),t("div",[o._v('    <input type="submit">')]),t("div",[o._v("</form>")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("8.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 修改数据")])]),t("div",[t("br")])]),t("ul",[t("li",[t("div",[o._v("直接通过 ModelForm 中的 instance 参数修改数据库中的数据，如果是使用 form 组件就需要自己写 orm 语句修改数据库中的数据")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[o._v("instance 参数接收一个对象（即: 查询数据后得到的对象）")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.shortcuts import render, HttpResponse, redirect")]),t("div",[o._v("from .models import *")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[o._v("from django.forms import widgets as wid")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class BookForm(ModelForm):")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = Book  ")]),t("div",[o._v("        fields = '__all__'  ")]),t("div",[o._v("        labels = {  ")]),t("div",[o._v("            'title': '书籍名称',")]),t("div",[o._v("            'price': '价格',")]),t("div",[o._v("            'publish': '出版社',")]),t("div",[o._v("            'author': '作者'")]),t("div",[o._v("        }")]),t("div",[o._v("        error_messages = {  ")]),t("div",[o._v("            'title': {'required': \"书籍名称不能为空\"},")]),t("div",[o._v("            'price': {'required': \"价格不能为空\"},")]),t("div",[o._v("            'publish': {'required': \"请选择出版社\"},")]),t("div",[o._v("            'author': {'required': \"请选择作者\"},")]),t("div",[o._v("        }")]),t("div",[o._v("        widgets = {")]),t("div",[o._v("            'title': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'price': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'publish': wid.Select(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'author': wid.CheckboxSelectMultiple(attrs={'class': 'form-control'})")]),t("div",[o._v("        }")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def edit_book(request, edit_book_id):")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("edit_book_obj")]),o._v(" = Book.objects.filter(pk=edit_book_id).first()")],1),t("div",[o._v("    if request.method == 'POST':")]),t("div",[o._v("        book_form = BookForm(request.POST, "),t("font",{attrs:{color:"#FA7A00"}},[o._v("instance")]),o._v("="),t("font",{attrs:{color:"#FA7A00"}},[o._v("edit_book_obj")]),o._v(")  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 验证提交过来的数据是否有误，并且通过 instance 参数指定要修改那条数据")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("                                                                    # 如果没有指定 instance 参数那么在执行 .save() 方法的时候该操作就是新增数据的操作")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("                                                                    # 不要和下面的 instance 参数搞混了，虽然 instance 参数的作用是一样的，但是表达的意思是不一样的")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("                                                                    #（即：下面instance参数表达的是将对应数据自动填写到表单中，而这里表达的是指定要修改那条数据）")])],1),t("div",[o._v("        if book_form.is_valid():")]),t("div",[o._v("            book_data = book_form.save()")]),t("div",[o._v("            print(book_data.pk, book_data.title)  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 10 三国演义2 ")])],1),t("div",[o._v("            return redirect('/books/')")]),t("div",[o._v("        else:")]),t("div",[o._v("            return HttpResponse('修改失败')")]),t("div",[o._v("    book_form = BookForm(instance=edit_book_obj)  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 将查询到的数据传递给 instance 参数，从而实现将对应数据自动填写到表单中（即: 修改页面） ")])],1),t("div",[o._v("    return render(request, 'add.html', {'book_form': book_form})")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# edit.html")])],1),t("div",[t("br")]),t("div",[o._v('<form action="" method="post" novalidate>')]),t("div",[o._v("    {% csrf_token %}")]),t("div",[t("br")]),t("div",[o._v("    {% for field in book_form %}")]),t("div",[o._v("        <div>")]),t("div",[o._v("            "+o._s("{{ field.label }}"))]),t("div",[o._v("            "+o._s("{{ field }}"))]),t("div",[o._v("        </div>")]),t("div",[o._v("    {% endfor %}")]),t("div",[t("br")]),t("div",[o._v('    <input type="submit">')]),t("div",[o._v("</form>")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("9.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 自定义字段")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt",color:"rgb(255, 0, 0)"}},[o._v("注意: ")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[o._v("定义自定义字段的方法和 form 组件定义字段的方法是一样的")])])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[o._v("自定义字段的字段名不能和 ModelForm 中所指向的")]),o._v(" "),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("表类（即: Model类）")]),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("中的字段名重复")])])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[o._v("因为如果")]),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("自定义字段的字段名和当前 ModelForm 所指向的 表类（即: Model类）中的字段名一样，那么该自定义字段就是 ")]),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("表类（即: Model类）")]),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("的字段而不是自定义字段")])])])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[o._v("使用方式一")]),o._v(" -> 确认密码")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# forms/password.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[o._v("from django.forms import widgets as wid")]),t("div",[o._v("from django.forms import fields as Ffields")]),t("div",[o._v("from django.core.exceptions import ValidationError")]),t("div",[o._v("from .models import *")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class RegForm(ModelForm):")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("confirm_password")]),o._v(" = Ffields.CharField(")],1),t("div",[o._v("        min_length=6,")]),t("div",[o._v("        label='确认密码',")]),t("div",[o._v("        widget=wid.PasswordInput(")]),t("div",[o._v("            attrs={")]),t("div",[o._v("                'class': 'form-control',")]),t("div",[o._v("                'placeholder': '确认密码',")]),t("div",[o._v("            }")]),t("div",[o._v("        ),")]),t("div",[o._v("        error_messages={")]),t("div",[o._v("            'required': '确认密码不能为空',")]),t("div",[o._v("            'min_length': '确认密码不能小于6位',")]),t("div",[o._v("        }")]),t("div",[o._v("    )")]),t("div",[t("br")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = UserInFo")]),t("div",[o._v("        fields = ['password', 'confirm_password']")]),t("div",[o._v("        labels = {")]),t("div",[o._v("            'password': '密码',")]),t("div",[o._v("        }")]),t("div",[o._v("        error_messages = {")]),t("div",[o._v("            'password': {'required': '密码不能为空', 'min_length': '密码不能小于6位', },")]),t("div",[o._v("        }")]),t("div",[o._v("        widgets = {")]),t("div",[o._v("            'password': wid.PasswordInput(attrs={'class': 'form-control', 'placeholder': '密码'}),")]),t("div",[o._v("        }")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 重写全局钩子，判断两次密码是否一致")])],1),t("div",[o._v("    def clean(self):")]),t("div",[o._v("        password = self.cleaned_data.get('password')")]),t("div",[o._v("        confirm_password = self.cleaned_data.get('confirm_password')")]),t("div",[o._v("        if password == confirm_password:")]),t("div",[o._v("            return self.cleaned_data")]),t("div",[o._v("        else:")]),t("div",[o._v("            self.add_error('confirm_password', ValidationError('两次密码不一致'))")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[o._v("使用方式二")]),o._v(" -> 添加当前表的一对一字段所关联表的内容到当前 form 表单中")])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[o._v("自定义字段一般用于当前表类拥有一对一字段，且一对多或多对多很少会用到")])])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[o._v("ModelForm 源码中两个重要属性:")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("ul",[t("li",[t("div",[o._v("self.instance -> 字段对象")])]),t("li",[t("div",[o._v("self.initial -> 初始值（即: 修改页面所显示的每个字段所对应的数据）")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# forms/author.py")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[t("br")])],1),t("div",[o._v("from django import forms")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[o._v("from app01.models import *")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class BootStrapModelForm(ModelForm):")]),t("div",[t("br")]),t("div",[o._v("    def __init__(self, *args, **kwargs):")]),t("div",[o._v("        super().__init__(*args, **kwargs)  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 调用父类的 __init__ 方法")])],1),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 批量添加样式")])],1),t("div",[o._v("        for field in iter(self.fields):")]),t("div",[o._v("            self.fields[field].widget.attrs.update({")]),t("div",[o._v("                'class': 'form-control'")]),t("div",[o._v("            })")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class AuthorForm(BootStrapModelForm):")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 自定义字段")])],1),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("birthday")]),o._v(" = forms.DateField(label='出生日期')")],1),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("telephone")]),o._v(" = forms.IntegerField(label='手机号码')")],1),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("addr")]),o._v(" = forms.CharField(label='地址')")],1),t("div",[t("br")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = Author")]),t("div",[o._v("        fields = ['name', 'age']")]),t("div",[o._v("        labels = {")]),t("div",[o._v("            'name': '作者名称',")]),t("div",[o._v("            'age': '年龄',")]),t("div",[o._v("        }")]),t("div",[o._v("        error_messages = {")]),t("div",[o._v("            'name': {'required': \"作者名称不能为空\"},")]),t("div",[o._v("            'age': {'required': \"年龄不能为空\"},")]),t("div",[o._v("            'birthday': {'required': \"出生日期不能为空\"},")]),t("div",[o._v("            'telephone': {'required': \"手机号码不能为空\"},")]),t("div",[o._v("            'addr': {'required': \"地址不能为空\"},")]),t("div",[o._v("        }")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("# 重写 ModelForm 的 __init__ 方法")])],1),t("div",[o._v("    def __init__(self, *args, **kwargs):")]),t("div",[o._v("        super().__init__(*args, **kwargs)  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 调用父类的 __init__ 方法")])],1),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("# self.instance -> 字段对象")])],1),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("        # self.initial -> 初始值（即: 修改页面所显示的每个字段所对应的数据）")])],1),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("# 修改数据时所显示的自定义字段的对应数据")])],1),t("div",[o._v("        if self.instance.authorDetail_id:  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用字段对象下的 一对一 或 多对多 字段属性进行判断")])],1),t("div",[o._v("            self.initial['birthday'] = self.instance.authorDetail.birthday")]),t("div",[o._v("            self.initial['telephone'] = self.instance.authorDetail.telephone")]),t("div",[o._v("            self.initial['addr'] = self.instance.authorDetail.addr")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("# 重写 ModelForm 的 save 方法")])],1),t("div",[o._v("    def save(self, commit=True):")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v(" # self.instance -> 字段对象")])],1),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("        # self.initial -> 初始值（即: 修改页面所显示的每个字段所对应的数据）")])],1),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#FF0000"}},[o._v("# 注意: 必须将修改数据的判断放到添加数据的判断前面")])],1),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("# 修改数据时自定义字段数据的保存")])],1),t("div",[o._v("        if self.instance.authorDetail_id:  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用字段对象下的 一对一 或 多对多 字段属性进行判断")])],1),t("div",[o._v("            authordetail_queryset = AuthorDetail.objects.filter(pk=self.instance.authorDetail_id).all()")]),t("div",[o._v("            authordetail_queryset.update(")]),t("div",[o._v("                birthday=self.cleaned_data['birthday'],")]),t("div",[o._v("                telephone=self.cleaned_data['telephone'],")]),t("div",[o._v("                addr=self.cleaned_data['addr'],")]),t("div",[o._v("            )")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v(" # 该判断中所执行的内容，只适用于当前 Model 表中有 一对一、一对多、多对多字段")])],1),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("        # 新建数据时自定义字段数据的保存")])],1),t("div",[o._v("        if not self.instance.authorDetail_id: "),t("font",{attrs:{color:"#41AD1C"}},[o._v(" # 使用字段对象下的 一对一 或 多对多 字段属性进行判断")])],1),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("# 新建数据时先新建 外键字段 或 一对一字段 的数据")])],1),t("div",[o._v("            author_detail_obj = AuthorDetail.objects.create(")]),t("div",[o._v("                birthday=self.cleaned_data['birthday'],")]),t("div",[o._v("                telephone=self.cleaned_data['telephone'],")]),t("div",[o._v("                addr=self.cleaned_data['addr']")]),t("div",[o._v("            )")]),t("div",[t("font",{attrs:{color:"#FA7A00"}},[o._v("# 将新建好的数据 id 赋值给当前字段对象的指定 外键字段 或 一对一字段 上")])],1),t("div",[o._v("            self.instance.authorDetail_id = author_detail_obj.pk")]),t("div",[t("br")]),t("div",[o._v("        super().save(commit=True)  "),t("font",{attrs:{color:"#FA7A00"}},[o._v("# 调用父类 ModelForm 的 save 保存方法")])],1),t("div",[t("br")]),t("div",[o._v("        return self.instance  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 一定要返回 self.instance")])],1)]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.shortcuts import render, HttpResponse, redirect")]),t("div",[o._v("from .models import *")]),t("div",[o._v("from app01.forms.author import "),t("font",{attrs:{color:"#FA7A00"}},[o._v("AuthorForm")])],1),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def add_author(request):")]),t("div",[o._v("    author_form = "),t("font",{attrs:{color:"#FA7A00"}},[o._v("AuthorForm")]),o._v("()")],1),t("div",[o._v("    if request.method == 'POST':")]),t("div",[o._v("        author_form = "),t("font",{attrs:{color:"#FA7A00"}},[o._v("AuthorForm")]),o._v("(request.POST)")],1),t("div",[o._v("        if author_form.is_valid():")]),t("div",[o._v("            author_form.save()")]),t("div",[o._v("            return redirect('/authors/')")]),t("div",[o._v("    return render(request, 'change.html', {'form': author_form})")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def edit_author(request, edit_author_id):")]),t("div",[o._v("    edit_author_obj = Author.objects.filter(pk=edit_author_id).first()")]),t("div",[o._v("    author_form = "),t("font",{attrs:{color:"#FA7A00"}},[o._v("AuthorForm")]),o._v("(instance=edit_author_obj)")],1),t("div",[o._v("    if request.method == 'POST':")]),t("div",[o._v("        author_form = "),t("font",{attrs:{color:"#FA7A00"}},[o._v("AuthorForm")]),o._v("(request.POST, instance=edit_author_obj)")],1),t("div",[o._v("        if author_form.is_valid():")]),t("div",[o._v("            author_form.save()")]),t("div",[o._v("            return redirect('/authors/')")]),t("div",[o._v("    return render(request, 'change.html', {'form': author_form})")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# change.html")])],1),t("div",[t("br")]),t("div",[o._v('<form action="" method="post" novalidate>')]),t("div",[o._v("    {% csrf_token %}")]),t("div",[t("br")]),t("div",[o._v("    {% for field in form %}")]),t("div",[o._v('        <div class="form-group {% if field.errors %} has-error {% endif %}">')]),t("div",[o._v("            "+o._s("{{ field.label }}"))]),t("div",[o._v("            "+o._s("{{ field }}"))]),t("div",[o._v('            <span class="help-block">'+o._s("{{ field.errors.0 }}")+"</span>")]),t("div",[o._v("        </div>")]),t("div",[o._v("    {% endfor %}")]),t("div",[t("br")]),t("div",[o._v('    <input type="submit" class="btn btn-success">')]),t("div",[o._v("</form>")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django/ModelForm 组件_files/Image [1].png",type:"image/png"}})]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django/ModelForm 组件_files/Image [2].png",type:"image/png"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("10.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 保存或修改上传文件")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# forms/picture.py")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[t("br")])],1),t("div",[o._v("from django.forms import ModelForm")]),t("div",[o._v("from app01.models import *")]),t("div",[o._v("from django.forms import widgets as wid")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class PictureForm(ModelForm):")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = Picture")]),t("div",[o._v("        fields = '__all__'")]),t("div",[o._v("        labels = {")]),t("div",[o._v("            'title': '标题',")]),t("div",[o._v("            'img': '图片',")]),t("div",[o._v("        }")]),t("div",[o._v("        error_messages = {")]),t("div",[o._v("            'title': {'required': \"标题不能为空\"},")]),t("div",[o._v("            'img': {'required': \"图片不能为空\"},")]),t("div",[o._v("        }")]),t("div",[o._v("        widgets = {")]),t("div",[o._v("            'title': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'img': wid.FileInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("        }")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py")])],1),t("div",[t("br")]),t("div",[o._v("from app01.models import *")]),t("div",[o._v("from django.shortcuts import render, HttpResponse")]),t("div",[o._v("from app01.forms.picture import PictureForm")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def add_data(request):")]),t("div",[o._v("    picture_form = PictureForm()")]),t("div",[o._v("    if request.POST:")]),t("div",[o._v("        picture_form = PictureForm(request.POST, "),t("font",{attrs:{color:"#FA7A00"}},[o._v("request.FILES")]),o._v(")")],1),t("div",[o._v("        if picture_form.is_valid():")]),t("div",[o._v("            picture_form.save()")]),t("div",[o._v("            return HttpResponse('添加成功')")]),t("div",[o._v("    return render(request, 'change.html', {")]),t("div",[o._v("        'form': picture_form,")]),t("div",[o._v("    })")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def edit_data(request, edit_pk):")]),t("div",[o._v("    picture_obj = Picture.objects.filter(pk=edit_pk).first()")]),t("div",[o._v("    picture_form = PictureForm(instance=picture_obj)")]),t("div",[o._v("    if request.POST:")]),t("div",[o._v("        picture_form = PictureForm(request.POST, "),t("font",{attrs:{color:"#FA7A00"}},[o._v("request.FILES")]),o._v(", instance=picture_obj)")],1),t("div",[o._v("        if picture_form.is_valid():")]),t("div",[o._v("            picture_form.save()")]),t("div",[o._v("            return HttpResponse('修改成功')")]),t("div",[o._v("    return render(request, 'change.html', {")]),t("div",[o._v("        'form': picture_form,")]),t("div",[o._v("    })")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# change.html")])],1),t("div",[t("br")]),t("div",[o._v('<form method="post" enctype="multipart/form-data" novalidate>')]),t("div",[o._v("    {% csrf_token %}")]),t("div",[o._v("    {% for field in form %}")]),t("div",[o._v("        <div>")]),t("div",[o._v("            "+o._s("{{ field.label }}"))]),t("div",[o._v("            "+o._s("{{ field }}"))]),t("div",[o._v("        </div>")]),t("div",[o._v("        <p>"+o._s("{{ field.errors.0 }}")+"</p>")]),t("div",[o._v("    {% endfor %}")]),t("div",[o._v('    <input type="submit" value="提交">')]),t("div",[o._v("</form>")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("11.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" .queryset.model -> ")]),o._v(" "),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("获取该字段对象下所关联的模型表（即: 表类）")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[o._v("获取form的字段对象方法在Form组件章节中有提到")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[o._v(".queryset 只作用于 一对一、一对多、多对多字段")])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[o._v("语法: 字段对象.queryset.model")])])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py 或 forms.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[t("br")]),t("div",[o._v("class BookForm(ModelForm):")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = Book")]),t("div",[o._v("        fields = '__all__'")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("book_form_obj = BookForm()")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 获取 一对多 的字段对象")])],1),t("div",[o._v("field_obj = book_form_obj.fields['publish']  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# <django.forms.models.ModelChoiceField object at 0x000001F2AC79E7B8>")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 获取该字段对象下所关联的模型表")])],1),t("div",[o._v("model = field_obj."),t("font",{attrs:{color:"#FA7A00"}},[o._v("queryset.model ")]),t("font",{attrs:{color:"#41AD1C"}},[o._v(" # <class 'app01.models.Publish'>")])],1),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 获取该模型表下的数据")])],1),t("div",[o._v("model_data = model.objects.all()  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# <QuerySet [<Publish: 东莞出版社>, <Publish: 广州出版社>]>")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 获取该模型表所在的app名称")])],1),t("div",[o._v("app_label = model._meta.app_label "),t("font",{attrs:{color:"#41AD1C"}},[o._v(" # app01")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 获取该模型表的表名")])],1),t("div",[o._v("model_name = model._meta.model_name  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# publish")])],1)]),t("div",[t("br")]),t("div",[t("font",{staticStyle:{"font-size":"14pt"}},[t("span",{staticStyle:{"white-space":"pre-wrap","font-size":"14pt","font-weight":"bold"}},[o._v("12.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 只用 ModelFo组件 进行验证，不做渲染")])])],1),t("div",[t("font",{staticStyle:{"font-size":"14pt"}},[t("br")])],1),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[o._v("不要认为用了")]),o._v("ModelForm"),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("组件就一定要用它的自动渲染form表单功能，")]),o._v("ModelForm"),t("span",{staticStyle:{"font-size":"12pt"}},[o._v("组件只用于验证，不做form表单渲染也是可以的，因为最后都是从 request.POST 中获取数据进行验证，前提是 form表单中的 name 需要和 form类中的字段名一致")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[o._v("只用ModelForm组件进行验证，不做渲染（即: 自己编写form表单） -> 使用 form 表单提交数据")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 这里就不写例子了，因为和form组件章节中的列子差不多")])],1)])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("13.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 图书管理例子")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("a",{attrs:{href:"/kevin-blog/Django/ModelForm 组件_files/model_form_demo.rar"}},[t("img",{attrs:{alt:"model_form_demo.rar",src:"/kevin-blog/Django/ModelForm 组件_files/2d4b502c5dc58c395d93791c0c5c361b.png"}})])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# models.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.db import models")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class Book(models.Model):")]),t("div",[o._v("    title = models.CharField(max_length=15)")]),t("div",[o._v("    price = models.IntegerField()")]),t("div",[o._v("    publish = models.ForeignKey(to='Publish')")]),t("div",[o._v("    author = models.ManyToManyField(to='Author')")]),t("div",[t("br")]),t("div",[o._v("    def __str__(self):")]),t("div",[o._v("        return self.title")]),t("div",[t("br")]),t("div",[o._v("    class Meta:")]),t("div",[o._v('        verbose_name = "书籍"')]),t("div",[o._v("        verbose_name_plural = verbose_name")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class Publish(models.Model):")]),t("div",[o._v("    title = models.CharField(max_length=15)")]),t("div",[t("br")]),t("div",[o._v("    def __str__(self):")]),t("div",[o._v("        return self.title")]),t("div",[t("br")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        verbose_name = '出版社'")]),t("div",[o._v("        verbose_name_plural = verbose_name")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class Author(models.Model):")]),t("div",[o._v("    name = models.CharField(max_length=15)")]),t("div",[t("br")]),t("div",[o._v("    def __str__(self):")]),t("div",[o._v("        return self.name")]),t("div",[t("br")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        verbose_name = '作者'")]),t("div",[o._v("        verbose_name_plural = verbose_name")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.shortcuts import render, HttpResponse, redirect")]),t("div",[o._v("from .models import *")]),t("div",[o._v("from django.forms import ModelForm")]),t("div",[o._v("from django.forms import widgets as wid  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 因为widgets和ModelForm中的参数重名了，所以起个别名")])],1),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("class BookForm(ModelForm):")]),t("div",[o._v("    class Meta:")]),t("div",[o._v("        model = Book  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 根据 Book 表类创建 Form 类")])],1),t("div",[o._v("        fields = '__all__'  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用 Book 表类的所有字段，")])],1),t("div",[t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("        # fields = ['title', 'price', 'publish', 'author']  # 使用 Book 表类的某几个字段")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("        # exclude = ['publish', 'author']  # 排除某些字段，一般和 fields = '__all__' 搭配使用")])],1),t("div",[o._v("        labels = {  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 和 Form 组件中的 label 作用是一样的")])],1),t("div",[o._v("            'title': '书籍名称',")]),t("div",[o._v("            'price': '价格',")]),t("div",[o._v("            'publish': '出版社',")]),t("div",[o._v("            'author': '作者'")]),t("div",[o._v("        }")]),t("div",[o._v("        error_messages = {  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 错误信息")])],1),t("div",[o._v("            'title': {'required': \"书籍名称不能为空\"},")]),t("div",[o._v("            'price': {'required': \"价格不能为空\"},")]),t("div",[o._v("            'publish': {'required': \"请选择出版社\"},")]),t("div",[o._v("            'author': {'required': \"请选择作者\"},")]),t("div",[o._v("        }")]),t("div",[o._v("        widgets = {  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 和 Form 组件中的 widgets作用是一样的")])],1),t("div",[o._v("            'title': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'price': wid.TextInput(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'publish': wid.Select(attrs={'class': 'form-control'}),")]),t("div",[o._v("            'author': wid.SelectMultiple(attrs={'class': 'form-control'})")]),t("div",[o._v("        }")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def books(request):")]),t("div",[o._v("    book_list = Book.objects.all()")]),t("div",[o._v("    return render(request, 'books.html', {'book_list': book_list})")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def add_book(request):")]),t("div",[o._v("    book_form = BookForm()")]),t("div",[o._v("    if request.method == 'POST':")]),t("div",[o._v("        book_form = BookForm(request.POST)")]),t("div",[o._v("        if book_form.is_valid():")]),t("div",[o._v("            book_form.save()  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 将提交过来的数据保存到数据库")])],1),t("div",[o._v("            return redirect('/books/')")]),t("div",[o._v("    return render(request, 'add.html', {'book_form': book_form})")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def edit_book(request, edit_book_id):")]),t("div",[o._v("    edit_book_obj = Book.objects.filter(pk=edit_book_id).first()")]),t("div",[o._v("    book_form = BookForm(instance=edit_book_obj)")]),t("div",[o._v("    if request.method == 'POST':")]),t("div",[o._v("        book_form = BookForm(request.POST, instance=edit_book_obj)  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 验证提交过来的数据是否有误，并且通过 instance 参数指定要修改那条数据")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("                                                                    # 如果没有指定 instance 参数那么在执行 .save() 方法的时候该操作就是新增数据的操作")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("                                                                    # 不要和上面的 instance 参数搞混了，虽然 instance 参数的作用是一样的，但是表达的意思是不一样的")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("                                                                    #（即：上面instance参数表达的是将对应数据自动填写到表单中，而这里表达的是指定要修改那条数据）")])],1),t("div",[o._v("        if book_form.is_valid():")]),t("div",[o._v("            book_form.save()")]),t("div",[o._v("            return redirect('/books/')")]),t("div",[t("br")]),t("div",[o._v("    return render(request, 'edit.html', {'book_form': book_form})")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# urls.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.conf.urls import url")]),t("div",[o._v("from django.contrib import admin")]),t("div",[o._v("from app01 import views")]),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("urlpatterns = [")]),t("div",[o._v("    url(r'^admin/', admin.site.urls),")]),t("div",[o._v("    url(r'^books', views.books),")]),t("div",[o._v("    url(r'^add_book', views.add_book),")]),t("div",[o._v("    url(r'^edit_book/(\\d+)', views.edit_book),")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v(" # url(r'^delete_book', views.delete_book),")])],1),t("div",[o._v("]")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# books.html")])],1),t("div",[t("br")]),t("div",[o._v("<!DOCTYPE html>")]),t("div",[o._v("<html>")]),t("div",[o._v("<head>")]),t("div",[o._v('    <meta charset="utf-8">')]),t("div",[o._v('    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">')]),t("div",[o._v("    <title>Title</title>")]),t("div",[o._v('    <meta name="description" content="">')]),t("div",[o._v('    <meta name="keywords" content="">')]),t("div",[o._v('    <link href="https://cdn.bootcss.com/twitter-bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">')]),t("div",[o._v("</head>")]),t("div",[o._v("<body>")]),t("div",[o._v('<div class="container">')]),t("div",[o._v('    <a href="/add_book/" class="btn btn-info">添加书籍</a>')]),t("div",[o._v('    <table border="1" class="table table-bordered">')]),t("div",[o._v("        <thead>")]),t("div",[o._v("        <tr>")]),t("div",[o._v("            <th>id</th>")]),t("div",[o._v("            <th>书名</th>")]),t("div",[o._v("            <th>价格</th>")]),t("div",[o._v("            <th>出版社</th>")]),t("div",[o._v("            <th>作者</th>")]),t("div",[o._v("            <th>操作</th>")]),t("div",[o._v("        </tr>")]),t("div",[o._v("        </thead>")]),t("div",[o._v("        <tbody>")]),t("div",[o._v("        {% for book in book_list %}")]),t("div",[o._v("            <tr>")]),t("div",[o._v("                <td>"+o._s("{{ book.pk }}")+"</td>")]),t("div",[o._v("                <td>"+o._s("{{ book.title }}")+"</td>")]),t("div",[o._v("                <td>"+o._s("{{ book.price }}")+"</td>")]),t("div",[o._v("                <td>"+o._s("{{ book.publish.title }}")+"</td>")]),t("div",[o._v("                <td>")]),t("div",[o._v("                    {% for author in book.author.all %}")]),t("div",[o._v("                        "+o._s("{{ author.name }}"))]),t("div",[o._v("                    {% endfor %}")]),t("div",[o._v("                </td>")]),t("div",[o._v("                <td>")]),t("div",[o._v('                    <a href="/edit_book/'+o._s("{{ book.pk }}")+'">编辑</a>')]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v('{% comment %}<a href="/delete_book/'+o._s("{{ book.pk }}")+'">删除</a>{% endcomment %}')])],1),t("div",[o._v("                </td>")]),t("div",[o._v("            </tr>")]),t("div",[o._v("        {% endfor %}")]),t("div",[o._v("        </tbody>")]),t("div",[o._v("    </table>")]),t("div",[o._v("</div>")]),t("div",[t("br")]),t("div",[o._v('<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"><\/script>')]),t("div",[o._v('<script src="https://cdn.bootcss.com/twitter-bootstrap/3.4.1/js/bootstrap.min.js"><\/script>')]),t("div",[o._v("</body>")]),t("div",[o._v("</html>")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# form.html")])],1),t("div",[t("br")]),t("div",[o._v('<form action="" method="post" novalidate>')]),t("div",[o._v("    {% csrf_token %}")]),t("div",[t("br")]),t("div",[o._v("    {% for field in book_form %}")]),t("div",[o._v('        <div class="form-group {% if field.errors %} has-error {% endif %}">')]),t("div",[o._v("            "+o._s("{{ field.label }}"))]),t("div",[o._v("            "+o._s("{{ field }}"))]),t("div",[o._v('            <span class="help-block">'+o._s("{{ field.errors.0 }}")+"</span>")]),t("div",[o._v("        </div>")]),t("div",[o._v("    {% endfor %}")]),t("div",[t("br")]),t("div",[o._v('    <input type="submit" class="btn btn-success">')]),t("div",[o._v("</form>")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# add.html")])],1),t("div",[t("br")]),t("div",[o._v("<!DOCTYPE html>")]),t("div",[o._v("<html>")]),t("div",[o._v("<head>")]),t("div",[o._v('    <meta charset="utf-8">')]),t("div",[o._v('    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">')]),t("div",[o._v("    <title>Title</title>")]),t("div",[o._v('    <meta name="description" content="">')]),t("div",[o._v('    <meta name="keywords" content="">')]),t("div",[o._v('    <link href="https://cdn.bootcss.com/twitter-bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">')]),t("div",[o._v("</head>")]),t("div",[o._v("<body>")]),t("div",[t("br")]),t("div",[o._v('<div class="container">')]),t("div",[o._v("    <h3>添加页面</h3>")]),t("div",[o._v("    {% include 'form.html' %}")]),t("div",[o._v("</div>")]),t("div",[t("br")]),t("div",[o._v('<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"><\/script>')]),t("div",[o._v('<script src="https://cdn.bootcss.com/twitter-bootstrap/3.4.1/js/bootstrap.min.js"><\/script>')]),t("div",[o._v("</body>")]),t("div",[o._v("</html>")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# edit.html")])],1),t("div",[t("br")]),t("div",[o._v("<!DOCTYPE html>")]),t("div",[o._v("<html>")]),t("div",[o._v("<head>")]),t("div",[o._v('    <meta charset="utf-8">')]),t("div",[o._v('    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">')]),t("div",[o._v("    <title>Title</title>")]),t("div",[o._v('    <meta name="description" content="">')]),t("div",[o._v('    <meta name="keywords" content="">')]),t("div",[o._v('    <link href="https://cdn.bootcss.com/twitter-bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">')]),t("div",[o._v("</head>")]),t("div",[o._v("<body>")]),t("div",[t("br")]),t("div",[o._v('<div class="container">')]),t("div",[o._v("    <h3>修改页面</h3>")]),t("div",[o._v("    {% include 'form.html' %}")]),t("div",[o._v("</div>")]),t("div",[t("br")]),t("div",[o._v('<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"><\/script>')]),t("div",[o._v('<script src="https://cdn.bootcss.com/twitter-bootstrap/3.4.1/js/bootstrap.min.js"><\/script>')]),t("div",[o._v("</body>")]),t("div",[o._v("</html>")])]),t("div",[t("br")])]),t("div",[t("br")])])])])}),[],!1,null,null,null);i.default=e.exports}}]);