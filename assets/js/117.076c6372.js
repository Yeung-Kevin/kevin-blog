(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{468:function(t,i,e){"use strict";e.r(i);var a=e(25),o=Object(a.a)({},(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("div",[e("span",[e("div",[e("div",[e("span",{staticStyle:{"font-size":"14pt","box-sizing":"border-box","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","white-space":"pre-wrap",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[t._v("1.")]),e("span",{staticStyle:{"font-size":"14pt","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}}),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("flash 的启动流程")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Flask/中间件_files/Image.png",type:"image/png"}})])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Flask/中间件_files/Image [1].png",type:"image/png"}})])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Flask/中间件_files/Image [2].png",type:"image/png"}})])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Flask/中间件_files/Image [3].png",type:"image/png"}})])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","box-sizing":"border-box","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","white-space":"pre-wrap",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[t._v("2.")]),e("span",{staticStyle:{"font-size":"14pt","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}}),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("中间件的介绍")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[t._v("flask的中间件 和 Django的中间件 是有所不同的")])])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{color:"rgb(227, 0, 0)","font-weight":"bold"}},[t._v("falsk 中间件是在 wsgi_api 方法前后执行操作（即: 在请求刚进来未进行视图函数匹配前执行操作（此时request和session对象还无法使用） 和 匹配到视图函数并且返回处理结果后执行操作）")])])])]),e("div",[e("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[e("b",[e("br")])])]),e("ul",[e("li",[e("div",[t._v("flask 中间件在 wsgi_api 方法前执行操作是无法使用 request 和 session 对象的，如果想获取请求中的数据就需要从 environ 参数中获取")])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[t._v("wsgi 方法的介绍: 根据不同的请求调用不同的视图函数，然后返回处理结果。即用户输入网址后，看到了网页响应")])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[t._v("flask 中间件比 before_request 先执行，比 after_request 后执行")])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[t._v("在日常开发中很少使用，知道有这个东西就可以了")])])]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","box-sizing":"border-box","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","white-space":"pre-wrap",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[t._v("3.")]),e("span",{staticStyle:{"font-size":"14pt","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}}),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("中间件的使用")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[t._v("注意: 需要在终端执行 app.py 才能看到效果，否则使用Pycharm是看不到效果的")])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("# app.py")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[t._v("from flask import Flask, render_template")]),e("div",[e("br")]),e("div",[t._v("app = Flask(__name__)")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("@app.route('/index')")]),e("div",[t._v("def index():")]),e("div",[t._v("    return render_template('index.html')")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("class "),e("font",{attrs:{color:"#FA7A00"}},[t._v("Middleware")]),t._v("(object):")],1),e("div",[t._v("    def __init__(self, old_wsgi_app):")]),e("div",[t._v("        self.old_wsgi_app = old_wsgi_app  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# 等同于 app.wsgi_app")])],1),e("div",[e("br")]),e("div",[t._v("    def __call__(self, environ, start_response):")]),e("div",[e("font",{attrs:{color:"#FA7A00"}},[t._v("print('wsgi_app 执行前所要做的操作')")])],1),e("div",[t._v("        ret = self.old_wsgi_app(environ, start_response)  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# 等同于 app.wsgi_app(")]),e("font",{attrs:{color:"#41AD1C"}},[t._v("environ, start_response)")])],1),e("div",[e("font",{attrs:{color:"#FA7A00"}},[t._v("print('wsgi_app 执行完后所要做的操作')")])],1),e("div",[t._v("        return ret")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("if __name__ == '__main__':")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v(' """')])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("        说明:")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("            1. 在源码中 wsgi_app 是一个方法")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("            2. Middleware 对象赋值给 wsgi_app")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("            3. 此时 wsgi_app 是一个对象，当一个对象加括号（即: 对象()）执行的时候就会调用该对象所在的类中的 __call__ 方法")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("            4. 执行 __call__ 方法")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v('    """')])],1),e("div",[e("font",{attrs:{color:"#FA7A00"}},[t._v("app.wsgi_app = Middleware(app.wsgi_app)")]),t._v(" "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# 相当于把 wsgi_app 给更新了")])],1),e("div",[t._v("    app.run()")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])])]),e("div",[e("br")])])])])}),[],!1,null,null,null);i.default=o.exports}}]);