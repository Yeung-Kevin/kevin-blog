(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{394:function(t,i,o){"use strict";o.r(i);var r=o(25),e=Object(r.a)({},(function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("div",[o("span",[o("div",[o("div",[o("span",{staticStyle:{"font-family":'"Helvetica Neue"'}},[o("br")])]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("版本")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[t._v("只要继承了 APIView 就可以使用版本")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 版本的作用")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("根据版本的不同返回相应的数据结构")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("限制只能使用哪几个版本的接口")])])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 局部版本")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("局部版本的配置（即:")]),t._v(" versioning_class "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("= 版本类）会覆盖掉该视图类在全局版本中的配置")])])])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[t._v("versioning_class "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("= 版本类")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("QueryParameterVersioning 版本类 -> 从 url 参数中获取版本号")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("url版本参数的默认参数名: version")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("访问的url: "),o("a",{attrs:{href:"http://127.0.0.1:8000/api/book/?version=v1"}},[t._v("http://127.0.0.1:8000/api/book/?version=v1")])])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("br")]),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[t._v("from rest_framework.response import Response")]),o("div",[o("br")]),o("div",[t._v("from rest_framework.versioning import "),o("font",{attrs:{color:"#FA7A00"}},[t._v("QueryParameterVersioning")]),t._v(", URLPathVersioning")],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class BookViewSet(APIView):")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("versioning_class")]),t._v(" = QueryParameterVersioning  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 局部版本")])],1),o("div",[o("br")]),o("div",[t._v("    def get(self, request, *args, **kwargs):")]),o("div",[o("br")]),o("div",[t._v("        print(request.version)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# v1 -> 获取当前版本号")])],1),o("div",[t._v("        print(request.versioning_scheme)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# QueryParameterVersioning 的实例化对象")])],1),o("div",[o("br")]),o("div",[t._v("        if request.version == 'v1':")]),o("div",[t._v("            return Response('v1版本的数据')")]),o("div",[t._v("        else:")]),o("div",[t._v("            return Response('其他版本的数据')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("URLPathVersioning ")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("版本类")]),t._v(" "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("-> 使用url正则匹配获取版本号 -> 推荐使用")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("命名匹配的默认名称: version")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("访问的url:  "),o("a",{attrs:{href:"http://127.0.0.1:8000/api/v1/book/"}},[t._v("http://127.0.0.1:8000/api/v1/book/")])])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[t._v("from rest_framework.response import Response")]),o("div",[o("br")]),o("div",[t._v("from rest_framework.versioning import QueryParameterVersioning, "),o("font",{attrs:{color:"#FA7A00"}},[t._v("URLPathVersioning")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class BookViewSet(APIView):")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("versioning_class")]),t._v(" = URLPathVersioning  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 局部版本")])],1),o("div",[o("br")]),o("div",[t._v("    def get(self, request, *args, **kwargs):")]),o("div",[o("br")]),o("div",[t._v("        print(request.version)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# v1 -> 获取当前版本号")])],1),o("div",[t._v("        print(request.versioning_scheme)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# QueryParameterVersioning 的实例化对象")])],1),o("div",[o("br")]),o("div",[t._v("        if request.version == 'v1':")]),o("div",[t._v("            return Response('v1版本的数据')")]),o("div",[t._v("        else:")]),o("div",[t._v("            return Response('其他版本的数据')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)","font-weight":"bold"}},[t._v("注意:")]),o("span",{staticStyle:{"font-weight":"bold"}},[t._v(" url必须使用命名匹配")])])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# urls.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[t._v("urlpatterns = [")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("#")]),t._v(" url(r'api/"),o("font",{attrs:{color:"#FA7A00"}},[t._v("(?P<version>[v1|v2]+)")]),t._v("/book', BookViewSet.as_view()),")],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 等同于")])],1),o("div",[t._v("    url(r'api/"),o("font",{staticStyle:{color:"rgb(250, 122, 0)"}},[t._v("(?P<version>\\w+)")]),t._v("/book', BookViewSet.as_view()),  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 使用该正则的前提必须设置了允许的版本")])],1),o("div",[t._v("]")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("request.version 和 request.")]),t._v("versioning_scheme 的说明")])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("如果使用了版本，那么 request 就会被绑定两个属性: "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("version 和 ")]),t._v("versioning_scheme ")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("version: 当前版本，用于")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("根据版本的不同返回相应的数据结构")])])]),o("li",[o("div",[t._v("versioning_scheme: 当前使用的版本类的实例化对象")])])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# views.py")])]),o("div",[o("br")]),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[t._v("from rest_framework.response import Response")]),o("div",[o("br")]),o("div",[t._v("from rest_framework.versioning import QueryParame"),o("font",{attrs:{color:"#000000"}},[t._v("terVersioning, URLPathVersioning")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class BookViewSet(APIView):")]),o("div",[o("br")]),o("div",[t._v("    versioning_class = URLPathVersioning  ")]),o("div",[o("br")]),o("div",[t._v("    def get(self, request, *args, **kwargs):")]),o("div",[o("br")]),o("div",[t._v("        print("),o("font",{attrs:{color:"#FA7A00"}},[t._v("request.version")]),t._v(")  "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# v1 -> 获取当前版本号")])],1),o("div",[t._v("        print("),o("font",{attrs:{color:"#FA7A00"}},[t._v("request.versioning_scheme")]),t._v(")  "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# QueryParameterVersioning 的实例化对象")])],1),o("div",[o("br")]),o("div",[t._v("        if request.version == 'v1':")]),o("div",[t._v("            return Response('v1版本的数据')")]),o("div",[t._v("        else:")]),o("div",[t._v("            return Response('其他版本的数据')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("version 参数名的修改")])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("version 参数名必须要在全局设置中修改（即: settings.py）")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("QueryParameterVersioning 的 ")]),t._v("url版本参数名 “version” 和 "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("URLPathVersioning 命名匹配的 “")]),t._v("version"),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("”，使用的都是同一个配置项中的参数名")])])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# settings.py")])],1),o("div",[o("br")]),o("div",[t._v("REST_FRAMEWORK = {")]),o("div",[t._v("    \"VERSION_PARAM\": 'v',  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 参数名")])],1),o("div",[t._v("}")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("默认版本号")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("该设置必须在全局中进行设置（即: settings.py）")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# settings.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[t._v("REST_FRAMEWORK = {")]),o("div",[t._v("    \"VERSION_PARAM\": 'version', "),o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 参数名")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[t._v("    'DEFAULT_VERSION': 'v1',  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 默认版本号")])],1),o("div",[t._v("}")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("允许的版本")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("说明: 允许调用当前接口的哪些版本")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("该设置必须在全局中进行设置（即: settings.py）")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# settings.py")])],1),o("div",[o("br")]),o("div",[t._v("REST_FRAMEWORK = {")]),o("div",[t._v("    \"VERSION_PARAM\": 'version',  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 参数名")])],1),o("div",[t._v("    'DEFAULT_VERSION': 'v1',  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 默认版本号")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[t._v("    'ALLOWED_VERSIONS': ['v1', 'v2'],  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许的版本")])],1),o("div",[t._v("}")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 全局版本")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("全局版本作用于所有视图类")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("可以通过设置局部版本来覆盖全局版本的设置")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# settings.py")])],1),o("div",[o("br")]),o("div",[t._v("REST_FRAMEWORK = {")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("……")])],1),o("div",[t._v('    "DEFAULT_VERSIONING_CLASS": "rest_framework.versioning.URLPathVersioning",  '),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 使用什么版本类")])],1),o("div",[t._v("    \"VERSION_PARAM\": 'version', "),o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 参数名")])],1),o("div",[t._v("    'DEFAULT_VERSION': 'v1',  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 默认版本号")])],1),o("div",[t._v("    'ALLOWED_VERSIONS': ['v1', 'v2'],  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许的版本")])],1),o("div",[t._v("}")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","font-family":'"Helvetica Neue"'}},[o("br")])])]),o("div",[o("br")]),o("div",[o("br")])])])])}),[],!1,null,null,null);i.default=e.exports}}]);