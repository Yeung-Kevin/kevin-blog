(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{401:function(o,v,t){"use strict";t.r(v);var i=t(25),e=Object(i.a)({},(function(){var o=this,v=o.$createElement,t=o._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":o.$parent.slotKey}},[t("div",[t("span",[t("div",[t("div",[t("br")]),t("div",[t("a",{attrs:{href:"/kevin-blog/Django/Django 日志配置_files/log_demo.rar"}},[t("img",{attrs:{alt:"log_demo.rar",src:"/kevin-blog/Django/Django 日志配置_files/4140c9e715d5f170b8a8903d9b6eca88.png"}})])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("1.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),t("span",{staticStyle:{"font-size":"14pt"}},[t("b",[o._v("注释版的 Django 日志配置")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# settings.py")])],1),t("div",[t("br")]),t("div",[o._v('BASE_LOG_DIR = os.path.join(BASE_DIR, "log")  '),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志文件夹")])],1),t("div",[o._v("LOGGING = {")]),t("div",[o._v("    'version': 1, "),t("font",{attrs:{color:"#41AD1C"}},[o._v(" # 保留字")])],1),t("div",[o._v("    'disable_existing_loggers': False,  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 是否禁用已经存在的logger实例")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志的格式 -> 可以在这里定制自己需要的日志格式")])],1),t("div",[o._v("    'formatters': {")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 详细的日志格式")])],1),t("div",[o._v("        'standard': {")]),t("div",[o._v("            'format': '[%(asctime)s][%(threadName)s:%(thread)d][task_id:%(name)s][%(filename)s:%(lineno)d]'")]),t("div",[o._v("                      '[%(levelname)s][%(message)s]'")]),t("div",[o._v("        },")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 简单的日志格式")])],1),t("div",[o._v("        'simple': {")]),t("div",[o._v("            'format': '[%(levelname)s][%(asctime)s][%(filename)s:%(lineno)d]%(message)s'")]),t("div",[o._v("        },")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 定义一个特殊的日志格式")])],1),t("div",[o._v("        'collect': {")]),t("div",[o._v("            'format': '%(message)s'")]),t("div",[o._v("        }")]),t("div",[o._v("    },")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 过滤器")])],1),t("div",[o._v("    'filters': {")]),t("div",[o._v("        'require_debug_true': {  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 当 DEBUG 配置项等于 True 的时候执行")])],1),t("div",[o._v("            '()': 'django.utils.log.RequireDebugTrue',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# '()' 代表全部")])],1),t("div",[o._v("        },")]),t("div",[o._v("    },")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 处理器")])],1),t("div",[o._v("    'handlers': {")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 在终端打印")])],1),t("div",[o._v("        'console': {")]),t("div",[o._v("            'level': 'DEBUG',  "),t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 设置日志级别 -> 该处理器只输出 DEBUG 级别以上的日志")])],1),t("div",[o._v("            'filters': ['require_debug_true'],  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 只有在Django debug为True时才在终端打印日志")])],1),t("div",[o._v("            'class': 'logging.StreamHandler',")]),t("div",[o._v("            'formatter': 'simple'  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用formatters所定义的日志格式")])],1),t("div",[o._v("        },")]),t("div",[o._v("        'SF': {")]),t("div",[o._v("            'level': 'INFO',  "),t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 设置日志级别 -> 该处理器只保存 INFO 级别以上的日志")])],1),t("div",[o._v("            'class': 'logging.handlers.RotatingFileHandler',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 保存到文件，根据文件大小自动切")])],1),t("div",[o._v("            'filename': os.path.join(BASE_LOG_DIR, \"xxx_info.log\"),  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志文件")])],1),t("div",[o._v("            'maxBytes': 1024 * 1024 * 50,  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志大小 50M")])],1),t("div",[o._v("            'backupCount': 3,  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 备份数为3  xx.log --\x3e xx.log.1 --\x3e xx.log.2 --\x3e xx.log.3")])],1),t("div",[o._v("            'formatter': 'standard',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用formatters所定义的日志格式")])],1),t("div",[o._v("            'encoding': 'utf-8',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志文件的编码")])],1),t("div",[o._v("        },")]),t("div",[o._v("        'TF': {")]),t("div",[o._v("            'level': 'INFO',  "),t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 设置日志级别 -> 该处理器只保存 INFO 级别以上的日志")])],1),t("div",[o._v("            'class': 'logging.handlers.TimedRotatingFileHandler',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 保存到文件，根据时间自动切")])],1),t("div",[o._v("            'filename': os.path.join(BASE_LOG_DIR, \"xxx_info.log\"),  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志文件")])],1),t("div",[o._v("            'backupCount': 3,  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 备份数为3  xx.log --\x3e xx.log.2018-08-23_00-00-00 --\x3e xx.log.2018-08-24_00-00-00 --\x3e ...")])],1),t("div",[o._v("            'when': 'D',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 每天一切， 可选值有S/秒 M/分 H/小时 D/天 W0-W6/周(0=周一) midnight/如果没指定时间就默认在午夜")])],1),t("div",[o._v("            'formatter': 'standard',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用formatters所定义的日志格式")])],1),t("div",[o._v("            'encoding': 'utf-8',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志文件的编码")])],1),t("div",[o._v("        },")]),t("div",[o._v("        'error': {")]),t("div",[o._v("            'level': 'ERROR',  "),t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 设置日志级别 -> 该处理器只保存 ERROR 级别以上的日志")])],1),t("div",[o._v("            'class': 'logging.handlers.RotatingFileHandler',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 保存到文件，根据文件大小自动切")])],1),t("div",[o._v("            'filename': os.path.join(BASE_LOG_DIR, \"xxx_err.log\"), "),t("font",{attrs:{color:"#41AD1C"}},[o._v(" # 日志文件")])],1),t("div",[o._v("            'maxBytes': 1024 * 1024 * 5, "),t("font",{attrs:{color:"#41AD1C"}},[o._v(" # 日志大小 50M")])],1),t("div",[o._v("            'backupCount': 5,  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 备份数为3  xx.log --\x3e xx.log.1 --\x3e xx.log.2 --\x3e xx.log.3")])],1),t("div",[o._v("            'formatter': 'standard',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用formatters所定义的日志格式")])],1),t("div",[o._v("            'encoding': 'utf-8',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志文件的编码")])],1),t("div",[o._v("        },")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 一般记录一些特殊的数据")])],1),t("div",[o._v("        'collect': {")]),t("div",[o._v("            'level': 'INFO',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 设置日志级别")]),o._v(" "),t("font",{attrs:{color:"#41AD1C"}},[o._v("-> 该处理器只保存 INFO 级别以上的日志")])],1),t("div",[o._v("            'class': 'logging.handlers.RotatingFileHandler',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 保存到文件，根据文件大小自动切")])],1),t("div",[o._v("            'filename': os.path.join(BASE_LOG_DIR, \"xxx_collect.log\"),  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志文件")])],1),t("div",[o._v("            'maxBytes': 1024 * 1024 * 50,  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志大小 50M")])],1),t("div",[o._v("            'backupCount': 5,  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 备份数为3  xx.log --\x3e xx.log.1 --\x3e xx.log.2 --\x3e xx.log.3")])],1),t("div",[o._v("            'formatter': 'collect',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用formatters所定义的日志格式")])],1),t("div",[o._v("            'encoding': \"utf-8\"  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 日志文件的编码")])],1),t("div",[o._v("        }")]),t("div",[o._v("    },")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 总的日志配置项，")]),t("font",{attrs:{color:"#41AD1C"}},[o._v("指定django中的每个模块使用哪个handlers，以及日志输出的级别")])],1),t("div",[o._v("    'loggers': {")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 默认的logger应用如下配置 -> 通俗理解: 默认项目所生成的 logger 都走下面的配置")])],1),t("div",[o._v("        '': {")]),t("div",[o._v("            'handlers': ['SF', 'console', 'error'], "),t("font",{attrs:{color:"#41AD1C"}},[o._v(" # 使用 'SF', 'console', 'error' 处理器，上线之后可以把'console'移除")])],1),t("div",[o._v("            'level': 'DEBUG',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 设置总的日志级别")])],1),t("div",[o._v("            'propagate': True,  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 向不向更高级别的logger传递")])],1),t("div",[o._v("        },")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# 对名为 'collect' 的 logger实例进行单独配置")])],1),t("div",[o._v("        'collect': {")]),t("div",[o._v("            'handlers': ['console', 'collect'],  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用 'console', 'collect' 处理器，上线之后可以把'console'移除")])],1),t("div",[o._v("            'level': 'INFO',  "),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 设置总的日志级别")])],1),t("div",[o._v("        }")]),t("div",[o._v("    },")]),t("div",[o._v("}")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("2.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v(" 无")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("注释版的 Django 日志配置")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[o._v('BASE_LOG_DIR = os.path.join(BASE_DIR, "log")')]),t("div",[o._v("LOGGING = {")]),t("div",[o._v("    'version': 1,")]),t("div",[o._v("    'disable_existing_loggers': False,")]),t("div",[o._v("    'formatters': {")]),t("div",[o._v("        'standard': {")]),t("div",[o._v("            'format': '[%(asctime)s][%(threadName)s:%(thread)d][task_id:%(name)s][%(filename)s:%(lineno)d]'")]),t("div",[o._v("                      '[%(levelname)s][%(message)s]'")]),t("div",[o._v("        },")]),t("div",[o._v("        'simple': {")]),t("div",[o._v("            'format': '[%(levelname)s][%(asctime)s][%(filename)s:%(lineno)d]%(message)s'")]),t("div",[o._v("        },")]),t("div",[o._v("        'collect': {")]),t("div",[o._v("            'format': '%(message)s'")]),t("div",[o._v("        }")]),t("div",[o._v("    },")]),t("div",[o._v("    'filters': {")]),t("div",[o._v("        'require_debug_true': {")]),t("div",[o._v("            '()': 'django.utils.log.RequireDebugTrue',")]),t("div",[o._v("        },")]),t("div",[o._v("    },")]),t("div",[o._v("    'handlers': {")]),t("div",[o._v("        'console': {")]),t("div",[o._v("            'level': 'DEBUG',")]),t("div",[o._v("            'filters': ['require_debug_true'],  ")]),t("div",[o._v("            'class': 'logging.StreamHandler',")]),t("div",[o._v("            'formatter': 'simple'")]),t("div",[o._v("        },")]),t("div",[o._v("        'SF': {")]),t("div",[o._v("            'level': 'INFO',")]),t("div",[o._v("            'class': 'logging.handlers.RotatingFileHandler',  ")]),t("div",[o._v("            'filename': os.path.join(BASE_LOG_DIR, \"xxx_info.log\"),  ")]),t("div",[o._v("            'maxBytes': 1024 * 1024 * 50,  ")]),t("div",[o._v("            'backupCount': 3,  ")]),t("div",[o._v("            'formatter': 'standard',")]),t("div",[o._v("            'encoding': 'utf-8',")]),t("div",[o._v("        },")]),t("div",[o._v("        'TF': {")]),t("div",[o._v("            'level': 'INFO',")]),t("div",[o._v("            'class': 'logging.handlers.TimedRotatingFileHandler',  ")]),t("div",[o._v("            'filename': os.path.join(BASE_LOG_DIR, \"xxx_info.log\"),  ")]),t("div",[o._v("            'backupCount': 3,  ")]),t("div",[o._v("            'when': 'D',  ")]),t("div",[o._v("            'formatter': 'standard',")]),t("div",[o._v("            'encoding': 'utf-8',")]),t("div",[o._v("        },")]),t("div",[o._v("        'error': {")]),t("div",[o._v("            'level': 'ERROR',")]),t("div",[o._v("            'class': 'logging.handlers.RotatingFileHandler',  ")]),t("div",[o._v("            'filename': os.path.join(BASE_LOG_DIR, \"xxx_err.log\"),  ")]),t("div",[o._v("            'maxBytes': 1024 * 1024 * 5,  ")]),t("div",[o._v("            'backupCount': 5,")]),t("div",[o._v("            'formatter': 'standard',")]),t("div",[o._v("            'encoding': 'utf-8',")]),t("div",[o._v("        },")]),t("div",[o._v("        'collect': {")]),t("div",[o._v("            'level': 'INFO',")]),t("div",[o._v("            'class': 'logging.handlers.RotatingFileHandler',  ")]),t("div",[o._v("            'filename': os.path.join(BASE_LOG_DIR, \"xxx_collect.log\"),")]),t("div",[o._v("            'maxBytes': 1024 * 1024 * 50,  ")]),t("div",[o._v("            'backupCount': 5,")]),t("div",[o._v("            'formatter': 'collect',")]),t("div",[o._v("            'encoding': \"utf-8\"")]),t("div",[o._v("        }")]),t("div",[o._v("    },")]),t("div",[o._v("    'loggers': {")]),t("div",[o._v("        '': {  ")]),t("div",[o._v("            'handlers': ['SF', 'console', 'error'],  ")]),t("div",[o._v("            'level': 'DEBUG',")]),t("div",[o._v("            'propagate': True,")]),t("div",[o._v("        },")]),t("div",[o._v("        'collect': {  ")]),t("div",[o._v("            'handlers': ['console', 'collect'],")]),t("div",[o._v("            'level': 'INFO',")]),t("div",[o._v("        }")]),t("div",[o._v("    },")]),t("div",[o._v("}")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("3.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),t("span",{staticStyle:{"font-size":"14pt"}},[t("b",[o._v("使用日志")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# views.py")])],1),t("div",[t("br")]),t("div",[o._v("from django.shortcuts import render, HttpResponse")]),t("div",[o._v("import logging")]),t("div",[t("br")]),t("div",[o._v("logger = logging.getLogger(__name__) "),t("font",{attrs:{color:"#41AD1C"}},[o._v(" # 生成一个以当前文件名为名字的logger实例")])],1),t("div",[o._v('collect_logger = logging.getLogger("collect")  '),t("font",{attrs:{color:"#41AD1C"}},[o._v("# 生成一个名为collect的logger实例")])],1),t("div",[t("br")]),t("div",[t("br")]),t("div",[o._v("def index(request):")]),t("div",[o._v("    logging.debug('调试信息')")]),t("div",[o._v("    logging.info('正常信息')")]),t("div",[o._v("    logging.warning('警告信息')")]),t("div",[o._v("    logging.error('错误信息')")]),t("div",[o._v("    logging.critical('严重错误信息')")]),t("div",[t("br")]),t("div",[o._v("    collect_logger.info('name: Kevin')")]),t("div",[o._v("    collect_logger.info('age: 18')")]),t("div",[t("br")]),t("div",[o._v("    return HttpResponse('index')")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("4.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),t("span",{staticStyle:{"font-size":"14pt"}},[t("b",[o._v("当项目被运行的时候就会生成对应的日志文件或在终端打印对应的日志")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[o._v("因为我在日志配置项中的 loggers 调用了指定的处理器所以会在 log 目录下生成对应的日志文件，保存对应的日志")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# xxx_info.log")])],1),t("div",[t("br")]),t("div",[o._v("[2019-05-13 18:12:35,196][Thread-1:17964][task_id:root][views.py:10][INFO][正常信息]")]),t("div",[o._v("[2019-05-13 18:12:35,196][Thread-1:17964][task_id:root][views.py:11][WARNING][警告信息]")]),t("div",[o._v("[2019-05-13 18:12:35,196][Thread-1:17964][task_id:root][views.py:12][ERROR][错误信息]")]),t("div",[o._v("[2019-05-13 18:12:35,196][Thread-1:17964][task_id:root][views.py:13][CRITICAL][严重错误信息]")]),t("div",[o._v("[2019-05-13 18:12:35,196][Thread-1:17964][task_id:collect][views.py:15][INFO][name: Kevin]")]),t("div",[o._v("[2019-05-13 18:12:35,197][Thread-1:17964][task_id:collect][views.py:16][INFO][age: 18]")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# xxx_error.log")])],1),t("div",[t("br")]),t("div",[o._v("[2019-05-13 18:12:35,196][Thread-1:17964][task_id:root][views.py:12][ERROR][错误信息]")]),t("div",[o._v("[2019-05-13 18:12:35,196][Thread-1:17964][task_id:root][views.py:13][CRITICAL][严重错误信息]")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[o._v("# xxx_collect.log -> 保存特殊的数据")])],1),t("div",[t("br")]),t("div",[o._v("name: Kevin")]),t("div",[o._v("age: 18")])]),t("div",[t("br")])]),t("div",[t("br")])])])])}),[],!1,null,null,null);v.default=e.exports}}]);