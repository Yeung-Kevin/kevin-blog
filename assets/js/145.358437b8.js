(window.webpackJsonp=window.webpackJsonp||[]).push([[145],{498:function(i,o,r){"use strict";r.r(o);var e=r(25),d=Object(e.a)({},(function(){var i=this,o=i.$createElement,r=i._self._c||o;return r("ContentSlotsDistributor",{attrs:{"slot-key":i.$parent.slotKey}},[r("div",[r("span",[r("div",[r("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[r("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("redis 主从复制")])]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),i._v(" "),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("redis")]),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("主从复制的使用场景")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("利用复制功能当主redis出现问题时，我们可以人工的切换到从redis继续提供服务，此时redis的数据和宕机时的数据几乎完全一致")])])])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("复制功能也可用作数据备份")])])])]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("2.")]),i._v(" "),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("redis")]),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("主从复制的原理")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("详细的解释")])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("从服务器向主服务器发送 SYNC 命令")])])]),r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("接到 SYNC 命令的主服务器会调用BGSAVE 命令，创建一个 RDB 文件，并使用缓冲区记录接下来执行的所有写命令")])])]),r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("当主服务器执行完 BGSAVE 命令时，它会向从服务器发送 RDB 文件，而从服务器则会接收并载入这个文件")])])]),r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("主服务器将缓冲区储存的所有写命令发送给从服务器执行")])])])])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("简单的解释")])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[i._v("在开启主从复制的时候，使用的是RDB方式的，同步主从数据的")])]),r("li",[r("div",[i._v("同步开始之后，通过主库命令传播的方式，主动的复制方式实现")])]),r("li",[r("div",[i._v("2.8以后实现PSYNC的机制，实现断线重连")])])])]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("3.")]),i._v(" "),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("redis")]),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("主从复制的架构图")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"1132884-20180928115021716-2071889796.jpg",src:"/kevin-blog/Linux/redis 主从复制_files/1132884-20180928115021716-2071889796.jpg",type:"image/jpeg",width:"1172"}})]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"1132884-20180928115021716-2071889796.jpg",src:"/kevin-blog/Linux/redis 主从复制_files/1132884-20180928115021716-2071889796 [1].jpg",type:"image/jpeg",width:"1156"}})]),r("div",[r("br")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("4.")]),i._v(" "),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("redis")]),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("主从复制的环境准备")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("准备两个或两个以上的 redis")])])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("创建三个redis配置文件")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("touch /opt/redis-4.0.10/{redis-6381.conf,redis-6382.conf,redis-6383.conf}")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image.png",type:"image/png"}})]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("创建三个redis配置文件所需要的目录")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("mkdir /data/{6381,6382,6383}")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image [1].png",type:"image/png"}})]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("redis-6381.conf 的配置文件")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("vim /opt/redis-4.0.10/redis-6381.conf")])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 绑定远程连接ip，如需要远程访问当前服务器的redis（即: 让别人连接你的redis），那么就需要填写当前服务器的ip -> 0.0.0.0 代表 127.0.0.1 也代表 当前服务器ip")])]),r("div",[r("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("bind 0.0.0.0")])]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# redis 端口")])]),r("div",[i._v("port 6381")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否后台运行 redis，在执行 redis-server redis.conf 命令时，如果为 yes 那么就不进入阻塞状态（即: 还可以输入其他命令），如果为 no 进入阻塞状态 （即: 无法输入别的命令）")])]),r("div",[i._v("daemonize yes")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将 redis 进程id 写入到 redis.pid 文件中，注意: /data/6381/ 目录必须存在（即: 如果没有就需要手动创建）")])]),r("div",[i._v("pidfile /data/6381/redis.pid")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志级别")])]),r("div",[i._v("loglevel notice")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志文件，注意: /data/6381/ 目录必须存在（即: 如果没有就需要手动创建）")])]),r("div",[i._v('logfile "/data/6381/redis.log"')]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否开启安全模式，如果开启，那么redis必须设置密码才能进行连接")])]),r("div",[i._v("protected-mode no")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 配置 redis 的数据存放文件夹，一般存放redis的持久化存储文件和redis的日志文件等，注意: /data/6381/ 目录必须存在（即: 如果没有就需要手动创建）")])]),r("div",[i._v("dir /data/6381")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("redis-6382.conf 的配置文件")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("vim /opt/redis-4.0.10/redis-6382.conf")])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 绑定远程连接ip，如需要远程访问当前服务器的redis（即: 让别人连接你的redis），那么就需要填写当前服务器的ip -> 0.0.0.0 代表 127.0.0.1 也代表 当前服务器ip")])]),r("div",[r("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("bind 0.0.0.0")])]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# redis 端口")])]),r("div",[i._v("port 6382")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否后台运行 redis，在执行 redis-server redis.conf 命令时，如果为 yes 那么就不进入阻塞状态（即: 还可以输入其他命令），如果为 no 进入阻塞状态 （即: 无法输入别的命令）")])]),r("div",[i._v("daemonize yes")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将 redis 进程id 写入到 redis.pid 文件中，注意: /data/6382/ 目录必须存在（即: 如果没有就需要手动创建）")])]),r("div",[i._v("pidfile /data/6382/redis.pid")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志级别")])]),r("div",[i._v("loglevel notice")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志文件，注意: /data/6382/ 目录必须存在（即: 如果没有就需要手动创建）")])]),r("div",[i._v('logfile "/data/6382/redis.log"')]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否开启安全模式，如果开启，那么redis必须设置密码才能进行连接")])]),r("div",[i._v("protected-mode no")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 配置 redis 的数据存放文件夹，一般存放redis的持久化存储文件和redis的日志文件等，注意: /data/6382/ 目录必须存在（即: 如果没有就需要手动创建）")])]),r("div",[i._v("dir /data/6382")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("redis-6383.conf 的配置文件")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("vim /opt/redis-4.0.10/redis-6383.conf")])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 绑定远程连接ip，如需要远程访问当前服务器的redis（即: 让别人连接你的redis），那么就需要填写当前服务器的ip -> 0.0.0.0 代表 127.0.0.1 也代表 当前服务器ip")])]),r("div",[r("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("bind 0.0.0.0")])]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# redis 端口")])]),r("div",[i._v("port 6383")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否后台运行 redis，在执行 redis-server redis.conf 命令时，如果为 yes 那么就不进入阻塞状态（即: 还可以输入其他命令），如果为 no 进入阻塞状态 （即: 无法输入别的命令）")])]),r("div",[i._v("daemonize yes")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将 redis 进程id 写入到 redis.pid 文件中，注意: /data/6383/ 目录必须存在（即: 如果没有就需要手动创建）")])]),r("div",[i._v("pidfile /data/6383/redis.pid")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志级别")])]),r("div",[i._v("loglevel notice")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志文件，注意: /data/6383/ 目录必须存在（即: 如果没有就需要手动创建）")])]),r("div",[i._v('logfile "/data/6383/redis.log"')]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否开启安全模式，如果开启，那么redis必须设置密码才能进行连接")])]),r("div",[i._v("protected-mode no")]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 配置 redis 的数据存放文件夹，一般存放redis的持久化存储文件和redis的日志文件等，注意: /data/6383/ 目录必须存在（即: 如果没有就需要手动创建）")])]),r("div",[i._v("dir /data/6383")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("同时启动三个 redis")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-server /opt/redis-4.0.10/redis-6381.conf")])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-server /opt/redis-4.0.10/redis-6382.conf")])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-server /opt/redis-4.0.10/redis-6383.conf")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image [2].png",type:"image/png"}})]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("主从规划")])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[i._v("主 redis : 6381")])]),r("li",[r("div",[i._v("从 redis : 6382、6383")])])])]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("5.")]),i._v(" "),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("从 redis 的配置方式一: ")]),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("以命令的方式配置从 reids")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("从 redis 配置成功后，默认只能读取数据，不能写入数据")])])])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-weight":"bold"}},[i._v("从 redis : 6382 的配置")])])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("进入 6382 的 redis")])])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6382")])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[i._v("配置 6382 的 redis 为从身份")])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("127.0.0.1:6382> "),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("slaveof 127.0.0.1 6381")])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[i._v("查看 6382 的 redis 身份状态")])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6382 info replication")])]),r("div"),r("div",[r("img",{attrs:{"data-filename":"Image1.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image1.png",type:"image/png"}})]),r("div",[r("br")]),r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-weight":"bold"}},[i._v("从 redis : 6383 的配置")])])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("进入 6383 的 redis")])])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6383")])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[i._v("配置 6383 的 redis 为从身份")])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("127.0.0.1:6383> "),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("slaveof 127.0.0.1 6381")])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[i._v("查看 6383 的 redis 身份状态")])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6383 info replication")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image2.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image2.png",type:"image/png"}})]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("6.")]),i._v(" "),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("从 redis 的配置方式二: ")]),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("以修改配置文件的形式配置从 redis")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("从 redis 配置成功后，默认只能读取数据，不能写入数据")])])])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt","font-weight":"bold"}},[i._v("从 redis : 6382 的配置文件设置")])])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("进入配置文件")])])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("vim /opt/redis-4.0.10/redis-6382.conf")])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("修改配置文件")])])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将 6381 redis 设置为当前的 6382 redis 的 主redis")])]),r("div",[i._v("slaveof 127.0.0.1 6381")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image [3].png",type:"image/png"}})]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("查看 6382 的 redis 身份状态")])])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6382 info replication")])]),r("div",[r("span",{staticStyle:{"font-size":"14pt"}})]),r("div",[r("img",{attrs:{"data-filename":"Image1.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image1 [1].png",type:"image/png"}})]),r("div",[r("br")]),r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt","font-weight":"bold"}},[i._v("从 redis : 6383 的配置文件设置")])])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("进入配置文件")])])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("vim /opt/redis-4.0.10/redis-6383.conf")])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("修改配置文件")])])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[r("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将 6381 redis 设置为当前的 6383 redis 的 主redis")])]),r("div",[i._v("slaveof 127.0.0.1 6381")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image [4].png",type:"image/png"}})]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("查看 6383 的 redis 身份状态")])])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6383 info replication")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image2.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image2 [1].png",type:"image/png"}})]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("7.")]),i._v(" "),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("主 reids 的配置")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("查看 6381 的 redis 身份状态")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6381 info replication")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image [5].png",type:"image/png"}})]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("8.")]),i._v(" "),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("测试写入数据")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("主 redis 写入数据，从 redis 查看数据是否进行了复制")])])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("主 redis 写入数据")])])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("127.0.0.1:"),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("6381")]),i._v("> "),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("set name 'Kevin'")])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[r("span",{staticStyle:{"font-size":"12pt"}},[i._v("从 redis 查看数据是否进行了复制")])])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("127.0.0.1:"),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("6382")]),i._v("> "),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("keys *")])]),r("div",[i._v('1) "name"')]),r("div",[i._v("127.0.0.1:"),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("6382")]),i._v("> "),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("get name")])]),r("div",[i._v('"Kevin"')])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("127.0.0.1:"),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("6383")]),i._v("> "),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("keys *")])]),r("div",[i._v('1) "name"')]),r("div",[i._v("127.0.0.1:"),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("6383")]),i._v("> "),r("span",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("get name")])]),r("div",[i._v('"Kevin"')])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image [6].png",type:"image/png"}})]),r("div",[r("br")]),r("div",[r("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("9.")]),i._v(" "),r("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("手动进行主从复制故障切换")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("当主 redis 6381 挂了，我想要在 6382 或 6383 redis 之间选择一个当主redis")])])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("关闭 主redis 6381")])])]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[i._v("查看主redis的进程pid")])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("ps -ef | grep redis")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image [7].png",type:"image/png"}})]),r("div",[r("br")]),r("ul",[r("ul",[r("li",[r("div",[i._v("关闭主redis 6381")])])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("kill -KILL 7112")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("查看 从redis 的状态")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6382 info replication")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image1.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image1 [2].png",type:"image/png"}})]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6383 info replication")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image2.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image2 [2].png",type:"image/png"}})]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("关闭 6382 和 6383 的从库身份")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6382 slaveof no one")])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6383 slaveof no one")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("将 6382 设置为主 redis，将 6383 设置为从 redis")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6383 slaveof 127.0.0.1 6382")])]),r("div",[r("br")]),r("ul",[r("li",[r("div",[i._v("查看 6382 和 6383 的 redis 状态")])])]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6382 info replication")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image [8].png",type:"image/png"}})]),r("div",[r("br")]),r("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[r("div",[i._v("redis-cli -p 6383 info replication")])]),r("div",[r("br")]),r("div",[r("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis 主从复制_files/Image [9].png",type:"image/png"}})]),r("div",[r("br")])]),r("div",[r("br")])])])])}),[],!1,null,null,null);o.default=d.exports}}]);