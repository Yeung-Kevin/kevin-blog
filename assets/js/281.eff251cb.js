(window.webpackJsonp=window.webpackJsonp||[]).push([[281],{633:function(t,i,e){"use strict";e.r(i);var r=e(25),a=Object(r.a)({},(function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("div",[e("span",[e("div",[e("div",[e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-family":'"Courier New"',"font-weight":"bold","line-height":"1.75"}},[t._v("1.")]),t._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("死锁")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[t._v("进程和线程都会有死锁的现象")])])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("font",{staticStyle:{"font-size":"12pt"}},[e("span",{staticStyle:{"text-indent":"0px","letter-spacing":"normal",orphans:"2","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[e("span",{staticStyle:{"font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("两个或两个以上的进程/线程在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。此时称系统处于死锁状态或系统产生了死锁，这些永远在互相等待的进程")])]),e("span",{staticStyle:{"text-indent":"0px","letter-spacing":"normal",orphans:"2","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("/线程")]),e("span",{staticStyle:{"text-indent":"0px","letter-spacing":"normal",orphans:"2","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[e("span",{staticStyle:{"font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("称为死锁进程")])]),e("span",{staticStyle:{"text-indent":"0px","letter-spacing":"normal",orphans:"2","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("/线程")])])],1)])]),e("div",[e("font",{staticStyle:{"font-size":"12pt"}},[e("br")])],1),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[t._v("死锁的出行的情况: 在多线程并发的情况下，同一个线程中如果出现多次 acquire 就可能产生死锁线程现象")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[t._v("# 死锁的现象")]),e("div",[e("br")]),e("div",[t._v("from threading import Lock")]),e("div",[e("br")]),e("div",[t._v("lock = Lock()")]),e("div",[t._v("lock.acquire()  "),e("font",{attrs:{color:"#E30000"}},[t._v("# 上锁")])],1),e("div",[t._v("lock.acquire()  "),e("font",{attrs:{color:"#E30000"}},[t._v("# 在这里会一直等待解锁，因为上面已经上了一把锁了且它并没有解开，就会在这里一直等待下面的程序也没办法执行")])],1),e("div",[t._v("print(123)")]),e("div",[t._v("lock.release()")]),e("div",[t._v("lock.release()")])]),e("div",[e("br")])]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-family":'"Courier New"',"font-weight":"bold","line-height":"1.75"}},[t._v("2.")]),t._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("死锁例子")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[t._v("吃面例子: 每个线程只有拿到筷子和面的时候才能吃上面")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[t._v("import time")]),e("div",[t._v("from threading import Thread")]),e("div",[t._v("from threading import Lock")]),e("div",[e("br")]),e("div",[t._v("kz = Lock()  # 筷子锁")]),e("div",[t._v("m = Lock()  # 面锁")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("def eat1(name):")]),e("div",[t._v("    kz.acquire()")]),e("div",[t._v("    print('%s，拿到筷子了' % name)")]),e("div",[t._v("    m.acquire()")]),e("div",[t._v("    print('%s，拿到面' % name)")]),e("div",[t._v("    print('%s，吃面' % name)")]),e("div",[t._v("    m.release()")]),e("div",[t._v("    kz.release()")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("def eat2(name):")]),e("div",[t._v("    m.acquire()")]),e("div",[t._v("    print('%s，拿到面' % name)")]),e("div",[t._v("    time.sleep(1)")]),e("div",[t._v("    kz.acquire()")]),e("div",[t._v("    print('%s，拿到筷子了' % name)")]),e("div",[t._v("    print('%s，吃面' % name)")]),e("div",[t._v("    kz.release()")]),e("div",[t._v("    m.release()")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("Thread(target=eat1, args=('Kevin',)).start()")]),e("div",[t._v("Thread(target=eat2, args=('Yeung',)).start()")]),e("div",[t._v("Thread(target=eat1, args=('Jack',)).start()")]),e("div",[t._v("Thread(target=eat2, args=('Amier',)).start()")]),e("div",[e("br")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("# 执行结果")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("    # Kevin，拿到筷子了")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("    # Kevin，拿到面")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("    # Kevin，吃面")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("    # Yeung，拿到面")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("    # Jack，拿到筷子了 ->")]),t._v(" "),e("font",{attrs:{color:"#E30000"}},[t._v("一直会在这里等待着，因为当Kevin吃完面后，Yeung拿到了面的钥匙，Jack拿到了筷子锁的钥匙，两个线程分别拿着不同的钥匙，而程序需要一个线程同时拿到两把钥匙才能执行下去")])],1)]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-family":'"Courier New"',"font-weight":"bold","line-height":"1.75"}},[t._v("3.")]),t._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("递归锁 -> 递归锁是解决死锁的办法")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[t._v("进程中也有递归锁")])])]),e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[t._v("第一次进入程序的时候无论程序上面执行了多少次acquire()，它都会往执行。")])])]),e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[t._v("上面执行了 num 次 acquire() 上锁，程序下面就要执行 num 次 release() 解锁")])])]),e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[t._v("使用递归锁解决多线程中死锁问题必须使用同一把递归锁")])])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[t._v("from threading import RLock")]),e("div",[e("br")]),e("div",[t._v("r_lock = RLock()")]),e("div",[t._v("r_lock.acquire()")]),e("div",[t._v("r_lock.acquire() ")]),e("div",[t._v("print(123)")]),e("div",[t._v("r_lock.release()")]),e("div",[t._v("r_lock.release()")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-family":'"Courier New"',"font-weight":"bold","line-height":"1.75"}},[t._v("4.")]),t._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("使用递归锁解决上面吃面例子的死锁问题")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[t._v("import time")]),e("div",[t._v("from threading import Thread")]),e("div",[t._v("from threading import RLock")]),e("div",[e("br")]),e("div",[t._v("m = kz = RLock() "),e("font",{attrs:{color:"#E30000"}},[t._v(" # 使用递归锁解决多线程中死锁问题必须是同一把锁，如果也是多把递归锁也是会出现死锁问题")])],1),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("def eat1(name):")]),e("div",[t._v("    kz.acquire()")]),e("div",[t._v("    print('%s，拿到筷子了' % name)")]),e("div",[t._v("    m.acquire()")]),e("div",[t._v("    print('%s，拿到面' % name)")]),e("div",[t._v("    print('%s，吃面' % name)")]),e("div",[t._v("    m.release()")]),e("div",[t._v("    kz.release()")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("def eat2(name):")]),e("div",[t._v("    m.acquire()")]),e("div",[t._v("    print('%s，拿到面' % name)")]),e("div",[t._v("    time.sleep(1)")]),e("div",[t._v("    kz.acquire()")]),e("div",[t._v("    print('%s，拿到筷子了' % name)")]),e("div",[t._v("    print('%s，吃面' % name)")]),e("div",[t._v("    kz.release()")]),e("div",[t._v("    m.release()")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("Thread(target=eat1, args=('Kevin',)).start()")]),e("div",[t._v("Thread(target=eat2, args=('Yeung',)).start()")]),e("div",[t._v("Thread(target=eat1, args=('Jack',)).start()")]),e("div",[t._v("Thread(target=eat2, args=('Amier',)).start()")])]),e("div",[e("br")])]),e("div",[e("br")])])])])}),[],!1,null,null,null);i.default=a.exports}}]);