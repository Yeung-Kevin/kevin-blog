(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{412:function(t,e,o){"use strict";o.r(e);var i=o(25),r=Object(i.a)({},(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("div",[o("span",[o("div",[o("div",[o("div",[o("div",[o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("auth模块的介绍")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("auth 模块一般用于用户注册、登录的认证、注销、修改密码等功能")])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("注意:")]),t._v(" auth模块默认使用 "),o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("auth_user表 ")]),t._v("来存储用户数据")]),o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("auth模块的使用")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("导入auth模块")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib import auth")])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" .")]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("authenticate() -> 用户认证")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("用户认证功能，")]),t._v("即验证用户名以及密码是否正确，一般需要username 、password两个关键字参数")])]),o("li",[o("div",[t._v("如果验证成功（用户名和密码正确有效）会返回一个User对象，且该User对象下会包含所有auth_user表的所有字段属性")])]),o("li",[o("div",[t._v("如果验证失效（用户名和密码错误无效）会返回一个匿名用户对象，即: None")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib import auth")]),o("div",[o("br")]),o("div",[t._v("def login(request):")]),o("div",[t._v("    if request.method == 'POST':")]),o("div",[t._v("        username = request.POST.get('username')")]),o("div",[t._v("        password = request.POST.get('password')")]),o("div",[o("br")]),o("div",[t._v("        user = auth.authenticate(username=username, password=password)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 对用户进行验证，且返回一个User对象")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# User对象下会包含auth_user表的所有字段属性")])],1),o("div",[t._v("        print(user.username)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# Kevin")])],1),o("div",[t._v("        print(user.password)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 密文密码: pbkdf2_sha256$36……")])],1),o("div",[o("br")]),o("div",[t._v("    return render(request, 'login.html')")])]),o("div",[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" .login")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("(request, user) -")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("> 将user对象封装到request对象里面")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v(".login() 方法接受两个参数:")])])]),o("ul",[o("li",[o("div",[t._v("request对象")])]),o("li",[o("div",[t._v("经过认证后所返回的User对象")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v(".login() 的作用:")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("将user对象封装到request对象里面")]),t._v("，且所有的视图函数可以通过 request.user 获取user对象里面的相关属性")])]),o("li",[o("div",[t._v("实现了一个用户登录功能，它的本质会在后端为该用户生成相关session数据（类似于x天免登陆功能一样）")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("注意: ")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("只要执行了 .login(request, user) 之后，那么所有的所有的视图函数都能通过 request.user 拿到当前登录用户的相关信息（即: auth_user表里面的相关字段的数据）")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("当 "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(".authenticate() 认证用户失败的时候会返回一个匿名用户对象（即: None），通过 .login() ")]),t._v("将"),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("匿名用户对象")]),t._v("封装到request对象里面后，在视图函数中使用 request.user 拿到的不是一个 None ，而是一个对象，里面存放着user表的所有字段属性，但是数据都是为空的（即: {username:'', password:'', ……}），所以 "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(".authenticate() 的返回值 和 封装到 request 里面后再通过 request.user 取到的值是有区别的")])])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.shortcuts import render, HttpResponse, redirect")]),o("div",[t._v("from django.contrib import auth")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("def login(request):")]),o("div",[t._v("    if request.method == 'POST':")]),o("div",[t._v("        username = request.POST.get('username')")]),o("div",[t._v("        password = request.POST.get('password')")]),o("div",[o("br")]),o("div",[t._v("        user = auth.authenticate(username=username, password=password)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 对用户进行验证，且返回一个User对象")])],1),o("div",[o("br")]),o("div",[t._v("        if user:  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 判断user对象是否有效")])],1),o("div",[t._v("            auth.login(request, user)  "),o("font",{attrs:{color:"#FA7A00"}},[t._v("# 将user对象封装到request对象里面")])],1),o("div",[t._v("            return redirect('/index/')")]),o("div",[o("br")]),o("div",[t._v("    return render(request, 'login.html')")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("def index(request):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 通过 request.user 获取当前登录用户的相关信息（即: auth_user表里面的相关字段的数据）")])],1),o("div",[t._v("    print(request.user.username)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# Kevin")])],1),o("div",[t._v("    print(request.user.password)  "),o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 密文密码: pbkdf2_sha256$36……")])],1),o("div",[t._v("    print(request.user.email)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 123@qq.com")])],1),o("div",[t._v("    return HttpResponse('index.html')")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" .")]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("logout(request) -> 注销")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v(".logout() 方法接受一个request对象，且该方法没有返回值")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v(".logout() 作用: ")])])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("注销")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("当调用")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(".logout()方法")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("时，当前请求的session信息会全部清除（即: 执行了 ")]),t._v("request.session.flush() "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("）")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("用户即使没有登录，使用")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(".logout()方法")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("也不会报错")])])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib import auth")]),o("div",[o("br")]),o("div",[t._v("def logout_view(request):")]),o("div",[t._v("    auth.logout(request)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 注销，相当于执行了 request.session.flush()")])],1),o("div",[t._v("    return redirect('/login/')")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("5.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" .")]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("is_authenticated()")])]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" -> 判断当前用户是否通过了认证")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("返回值:")])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("True -> 返回一个验证通过的user对象，即为True")])]),o("li",[o("div",[t._v("False -> 返回一个匿名用户对象，即为False")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib import auth")]),o("div",[o("br")]),o("div",[t._v("def my_view(request):")]),o("div",[t._v("    if not request.user.is_authenticated():")]),o("div",[t._v("        return HttpResponse('该用户没有通过认证')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("6.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("login_requierd 装饰器")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("作用:")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(" 给某个视图函数添加")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("login_requierd装饰器，只有用户登录了才能执行该视图函数")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("导入"),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("login_requierd装饰器")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib.auth.decorators import login_required")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("修改Django默认跳转的")]),o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("登录URL")])])])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("ul",[o("ul",[o("li",[o("div",[o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("若用户没有登录，则会跳转到django默认的，登录URL '/accounts/login/'，所以需要修改")])]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("默认跳转的")]),o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("登录URL")])])]),o("li",[o("div",[t._v("当用户没有登录，会将当前的url路径（不包括域名）传递给登录URL作为参数拼接起来，即 /login/?next=/my_view/")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[o("font",{attrs:{color:"#41AD1C"}},[t._v("# settings.py")])],1)]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[o("br")])]),o("div",[t._v("LOGIN_URL = '/login/'")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("使用"),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("login_requierd装饰器")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib import auth")]),o("div",[t._v("from django.contrib.auth.decorators import login_required")]),o("div",[o("br")]),o("div",[t._v("@login_required")]),o("div",[t._v("def my_view(request):")]),o("div",[t._v("    return HttpResponse('my_view')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("用户的相关操作")])]),o("div",[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[o("font",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("注意: ")])],1)]),o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("用户的相关操作和ORM的操作类似，都需要操作表的类或表的类所返回的对象")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("font",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("ModelForm 组件 和 auth 模块搭配使用的时候，不要使用 ModelForm 中的 .save()，因为在创建用户的时候 moelform 不是使用 create_user 创建的")])],1)])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 导入User类")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("注意:")]),t._v(" 这个User类和我们平时在models.py所写的类是一样的，只不过User类是Django帮我们生成的")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib.auth.models import User")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(".create_user() -> ")])]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("创建普通用户")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("注意: ")]),t._v("不要使用 .create() 方法去添加，因为使用 .create() 方法所添加的密码是不会进行加密的")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib.auth.models import User")]),o("div",[o("br")]),o("div",[t._v("def my_view(request):")]),o("div",[o("br")]),o("div",[t._v("    user = User.objects.create_user(username='Yeung', password='123', email='123@qq.com')  "),o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 添加普通用户")])],1),o("div",[o("br")]),o("div",[t._v("    return HttpResponse('添加成功')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" .")]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("create_superuser() -> ")])]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("创建超级用户")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[t._v("注意:")]),t._v(" 不要使用 .create() 方法去添加，因为使用 .create() 方法所添加的密码是不会进行加密的")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib.auth.models import User")]),o("div",[o("br")]),o("div",[t._v("def my_view(request):")]),o("div",[o("br")]),o("div",[t._v("    user = User.objects.create_superuser(username='Aimer', password='123', email='123@qq.com')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 添加超级用户")])],1),o("div",[o("br")]),o("div",[t._v("    return HttpResponse('添加成功')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("使用命令行添加超级用户")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("密码必须是英文和数字组成的8位密码")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("python manage.py createsuperuser")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" avatar 字段的相关说明")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("当需要往 avatar 字段添加数据的时候，avatar 字段必须接收一个文件对象，因为avatar字段一般是由 FileField 字段类 或 ImageField 字段类所创建的 （详细请查看: ORM-操作数据/添加数据/FileField 或 ImageField 字段类）")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("def register(request):")]),o("div",[t._v("    if request.method == 'POST':")]),o("div",[t._v("        file_obj = request.FILES.get('avatar')  "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 接受一个文件对象")])]),o("div",[t._v("        if file_obj:  "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 判断是否是一个文件对象")])]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("            # avatar 字段是通过 FileField 或 ImageField 字段类所创建的")])]),o("div",[t._v("            UserInfo.objects.create_user(avatar=file_obj, username='Kevin', password='123')  "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 将文件对象传递给 avatar 字段")])]),o("div",[t._v("        else:")]),o("div",[t._v("            UserInfo.objects.create_user(username='Kevin', password='123') "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v(" # 如果 file_obj 不是一个文件对象，那么不对 avatar 字段做任何操作，让 avatar 字段使用默认值")])]),o("div",[t._v("    return render(request, 'register.html')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("5.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" .")]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("check_password('密码') -> ")])]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("检测密码是否正确")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("返回值: True/False")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("检查查询到的用户密码是否正确")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib.auth.models import User")]),o("div",[o("br")]),o("div",[t._v("def my_view(request):")]),o("div",[t._v("    user = User.objects.get(username='Yeung')")]),o("div",[o("br")]),o("div",[t._v("    isOk = user.check_password('123')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 检查查询到的用户密码是否正确")])],1),o("div",[o("br")]),o("div",[t._v("    print(isOk)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# True")])],1),o("div",[t._v("    return HttpResponse('添加成功')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("检查当前登录用户的密码是否正确")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib.auth.models import User")]),o("div",[o("br")]),o("div",[t._v("def my_view(request):")]),o("div",[o("br")]),o("div",[t._v("    isOk = request.user.check_password(raw_password='123')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 检查当前登录用户密码是否正确")])],1),o("div",[o("br")]),o("div",[t._v("    print(isOk)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# True")])],1),o("div",[t._v("    return HttpResponse('添加成功')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("6.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" .")]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("set_password")])]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("('密码') -> ")])]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("修改用户密码")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[t._v("注意:")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(" 设置完一定要调用用户对象的save方法！！！")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("对查询到的用户密码进行修改")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib.auth.models import User")]),o("div",[o("br")]),o("div",[t._v("def my_view(request):")]),o("div",[t._v("    user = User.objects.get(username='Yeung')")]),o("div",[o("br")]),o("div",[t._v("    user.set_password('456')  "),o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 对查询到的用户密码进行修改")])],1),o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}}),t._v("user.save()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 一定要进行保存")])],1),o("div",[o("br")]),o("div",[t._v("    return HttpResponse('修改成功')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("对当前登录用户的密码进行修改")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("from django.contrib.auth.models import User")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("def my_view(request):")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    request.user.set_password('1234')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 对当前登录用户的密码进行修改")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    request.user.save()  "),o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 一定要进行保存")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    return HttpResponse('修改成功')")])],1)]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("修改密码功能的简单演示")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 修改密码功能的简单演示")])],1),o("div",[o("br")]),o("div",[t._v("@login_required")]),o("div",[t._v("def set_password(request):")]),o("div",[t._v("    user = request.user")]),o("div",[t._v("    err_msg = ''")]),o("div",[t._v("    if request.method == 'POST':")]),o("div",[t._v("        old_password = request.POST.get('old_password', '')")]),o("div",[t._v("        new_password = request.POST.get('new_password', '')")]),o("div",[t._v("        repeat_password = request.POST.get('repeat_password', '')")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 检查旧密码是否正确")])],1),o("div",[t._v("        if user.check_password(old_password):")]),o("div",[t._v("            if not new_password:")]),o("div",[t._v("                err_msg = '新密码不能为空'")]),o("div",[t._v("            elif new_password != repeat_password:")]),o("div",[t._v("                err_msg = '两次密码不一致'")]),o("div",[t._v("            else:")]),o("div",[t._v("                user.set_password(new_password)")]),o("div",[t._v("                user.save()")]),o("div",[t._v('                return redirect("/login/")')]),o("div",[t._v("        else:")]),o("div",[t._v("            err_msg = '原密码输入错误'")]),o("div",[t._v("    content = {")]),o("div",[t._v("        'err_msg': err_msg,")]),o("div",[t._v("    }")]),o("div",[t._v("    return render(request, 'set_password.html', content)")])]),o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("扩展默认auth_user表的字段")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("通过继承Django内置的AbstractUser类（User类也是继承了AbstractUser类），从而实现扩展默认auth_user表的字段")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("导入AbstractUser类")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.contrib.auth.models import AbstractUser")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("定义一个表的类，继承于AbstractUser类")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# models.py")])],1),o("div",[o("br")]),o("div",[t._v("from django.db import models")]),o("div",[t._v("from django.contrib.auth.models import AbstractUser")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class UserInfo(AbstractUser):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("'''")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("    新的用户表")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("    '''")])],1),o("div",[t._v("    phone = models.CharField(max_length=11)")]),o("div",[t._v("    address = models.CharField(max_length=15)")]),o("div",[o("br")]),o("div",[t._v("    def __str__(self):")]),o("div",[t._v("        return self.username")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("注意:")]),t._v(" 按上面的方式扩展了内置的auth_user表之后，一定要在settings.py中告诉Django，我现在使用我新定义的UserInfo表来做用户认证")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# settings.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v('# AUTH_USER_MODEL = "app名.UserInfo"')])],1),o("div",[o("br")]),o("div",[t._v('AUTH_USER_MODEL = "app01.UserInfo"')])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("自定义认证系统默认使用的数据表之后，我们就可以像使用默认的auth_user表那样使用我们的UserInfo表了")])])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("创建普通用户")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("br")]),o("div",[t._v("from .models import *")]),o("div",[o("br")]),o("div",[t._v("UserInfo.objects.create_user(username='用户名', password='密码')")])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("创建超级用户")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("br")]),o("div",[t._v("from .models import *")]),o("div",[o("br")]),o("div",[t._v("UserInfo.objects.create_superuser(username='用户名', password='密码')")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("再次注意:")]),t._v(" 一旦我们指定了新的认证系统所使用的表，我们就需要重新在数据库中创建该表，而不能继续使用原来默认的auth_user表了")])])]),o("div",[o("br")])]),o("div",[o("br")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);