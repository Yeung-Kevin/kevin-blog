(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{387:function(i,r,o){"use strict";o.r(r);var e=o(25),t=Object(e.a)({},(function(){var i=this,r=i.$createElement,o=i._self._c||r;return o("ContentSlotsDistributor",{attrs:{"slot-key":i.$parent.slotKey}},[o("div",[o("span",[o("div",[o("div",[o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("Serializers 序列化组件")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[i._v("只要继承了 APIView 就可以使用序列化组件")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 序列化组件的基本使用")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("序列化组件 的使用和 form 组件的使用类似，都需要定义一个类，而这个类就叫: 序列化类")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# serializer.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishSerializers(serializers.Serializer):")]),o("div",[i._v("    name = serializers.CharField(label='用户名')")]),o("div",[i._v("    email = serializers.CharField(label='邮箱')")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_obj = Publish.objects.all()")]),o("div",[o("br")]),o("div",[i._v("        ps = PublishSerializers(publish_obj, many=True)  "),o("font",{attrs:{color:"#E30000"}},[i._v("# 通过你所创建的 序列化类 序列化数据")])],1),o("div",[i._v("        data = ps.data  "),o("font",{attrs:{color:"#E30000"}},[i._v("# Serializer对象.data 获取序列化后的数据")]),i._v(" "),o("font",{attrs:{color:"#41AD1C"}},[i._v("-> [OrderedDict([('name', '东莞出版社'), ('email', '123@qq.com')]), OrderedDict([('name', '广州出版社'), ('email', '123@qq.com')])]")])],1),o("div",[o("br")]),o("div",[i._v("        return Response(data)")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8000/publish/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 请求类型: GET")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 结果:")])],1),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "name": "东莞出版社",')]),o("div",[i._v('        "email": "123@qq.com"')]),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "name": "广州出版社",')]),o("div",[i._v('        "email": "123@qq.com"')]),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("2.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" many 参数")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("many 参数: 说明所要序列化的数据是 queryset对象（查询到的数据列表）还是 查询到的数据对象")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("many=True -> 所要序列化的数据是 queryset对象（查询到的数据列表）")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializer.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishSerializers(serializers.Serializer):")]),o("div",[i._v("    name = serializers.CharField(label='用户名')")]),o("div",[i._v("    email = serializers.CharField(label='邮箱')")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# views.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_obj = Publish.objects.all()")]),o("div",[o("br")]),o("div",[i._v("        ps = PublishSerializers(publish_obj, "),o("font",{attrs:{color:"#FA7A00"}},[i._v("many")]),i._v("=True)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 所要序列化的数据是 queryset对象（查询到的数据列表）")])],1),o("div",[i._v("        data = ps.data")]),o("div",[o("br")]),o("div",[i._v("        return Response(data)")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8000/publish/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 请求类型: GET")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 结果:")])],1),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "name": "东莞出版社",')]),o("div",[i._v('        "email": "123@qq.com"')]),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "name": "广州出版社",')]),o("div",[i._v('        "email": "123@qq.com"')]),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("many=False -> 所要序列化的数据是查询到的数据对象，且 many 参数默认值为False，所以在序列化查询到的数据对象的时候 many 参数可以不用传")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializer.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishSerializers(serializers.Serializer):")]),o("div",[i._v("    name = serializers.CharField(label='用户名')")]),o("div",[i._v("    email = serializers.CharField(label='邮箱')")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# views.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_obj = Publish.objects.all().first()")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# ps = PublishSerializers(publish_obj,")]),i._v(" "),o("font",{attrs:{color:"#FA7A00"}},[i._v("many")]),o("font",{attrs:{color:"#41AD1C"}},[i._v("=False)  # 所要序列化的数据是查询到的数据对象")])],1),o("div",[i._v("        ps = PublishSerializers(publish_obj)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 所要序列化的数据是查询到的数据对象")])],1),o("div",[i._v("        data = ps.data")]),o("div",[o("br")]),o("div",[i._v("        return Response(data)")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8000/publish/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 请求类型: GET")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 结果:")])],1),o("div",[o("br")]),o("div",[i._v("{")]),o("div",[i._v('    "name": "东莞出版社",')]),o("div",[i._v('    "email": "123@qq.com"')]),o("div",[i._v("}")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("3.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" Response() 方法")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("rest-framework 所提供的 Response() 方法实际上也是继承了 ")]),i._v("HttpResponse ，只是在 HttpResponse 的基础上扩展了一些功能")])]),o("li",[o("div",[i._v("如果使用了 "),o("span",{staticStyle:{"font-size":"12pt"}},[i._v("rest-framework 那么就使用它所提供的 ")]),o("span",{staticStyle:{"font-size":"12pt"}},[i._v("Response() 方法将数据发送给前端")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializer.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishSerializers(serializers.Serializer):")]),o("div",[i._v("    name = serializers.CharField(label='用户名')")]),o("div",[i._v("    email = serializers.CharField(label='邮箱')")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# views.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_obj = Publish.objects.all().first()")]),o("div",[i._v("        ps = PublishSerializers(publish_obj)")]),o("div",[i._v("        data = ps.data")]),o("div",[o("br")]),o("div",[i._v("        return "),o("font",{attrs:{color:"#FA7A00"}},[i._v("Response")]),i._v("(data)")],1)]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("Response() 方法可以直接对 字典、列表、元祖、字符串、数字 进行发送")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[o("br")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        return Response({'a': 1, 'b': 2})")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v(" # return Response([1, 2, 3])")])],1),o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("        # return Response((1, 2, 3))")])],1),o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}}),o("font",{attrs:{color:"#41AD1C"}},[i._v("# return Response('字符串')")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("        # return Response(10)")])],1)]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("4.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("序列化日期对象并且处理日期格式")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("format='日期格式'")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# serializer.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookSerializers(serializers.Serializer):")]),o("div",[i._v("    title = serializers.CharField(label='书籍名称')")]),o("div",[i._v("    price = serializers.CharField(label='价格')")]),o("div",[i._v("    pub_date = serializers.CharField(label='未处理的出版日期')")]),o("div",[i._v("    production_date = serializers."),o("font",{attrs:{color:"#FA7A00"}},[i._v("DateTimeField")]),i._v("("),o("font",{attrs:{color:"#FA7A00"}},[i._v("format='%Y-%m-%d %H:%M:%S'")]),i._v(")")],1)]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        book_list = Book.objects.all()")]),o("div",[i._v("        bs = BookSerializers(book_list, many=True)")]),o("div",[i._v("        data = bs.data")]),o("div",[i._v("        return Response(data)")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8000/book/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 请求类型: GET")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 结果:")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "三国演义",')]),o("div",[i._v('        "price": "100",')]),o("div",[i._v('        "pub_date": "2019-08-11",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("production_date")]),i._v('": "2019-08-11 18:07:19"')],1),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "红楼梦",')]),o("div",[i._v('        "price": "200",')]),o("div",[i._v('        "pub_date": "2019-08-11",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("production_date")]),i._v('": "2019-08-11 18:08:06"')],1),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("4.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("Serializer 类的 depth ")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("参数说明")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("作用: 序列化 一对多 或 多对多 字段")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("depth 的缺点: 获取很多与当前接口无用的字段数据（即: 获取到一对多或多对多字段中的全部数据）")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("depth 值的说明: 必须为数值")])]),o("ul",[o("li",[o("div",[i._v("当前值为0: 序列化出来的是 一对多 或 多对多字段 所保存的 id 值")])]),o("li",[o("div",[i._v("当前值为1: 序列化出来的是 一对多 或 多对多字段 所对应的表的数据")])]),o("li",[o("div",[i._v("当前值为2: 如果 一对多 或 多对多字段 中还有 一对多 或 多对多字段，那么就序列化出该 一对多 或 多对多字段 所对应的表的数据")])]),o("li",[o("div",[i._v("当前数值为n: ……")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("depth 的默认值: 0")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("depth 官方取值范围推荐: 1-10")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("depth = 0")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializer.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework import serializers")]),o("div",[i._v("from .models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookSerializers(serializers.ModelSerializer):")]),o("div",[i._v("    class Meta:")]),o("div",[i._v("        model = Book")]),o("div",[i._v("        fields = '__all__'")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[i._v("depth")]),i._v(" = 1")],1)]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .serializer import *")]),o("div",[i._v("from .models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        book_list = Book.objects.all()")]),o("div",[i._v("        bs = BookSerializers(book_list, many=True)")]),o("div",[i._v("        return Response(bs.data)")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# ")]),i._v("depth = 0")]),o("div",[o("br")]),o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 接口: http://127.0.0.1:8001/book/")])],1),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 请求类型: GET")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 结果:")])]),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "id": 2,')]),o("div",[i._v('        "title": "三体（第二部）",')]),o("div",[i._v('        "price": 100,')]),o("div",[i._v('        "pub_date": "2012-12-12",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("publish")]),i._v('": 1,')],1),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("authors")]),i._v('": [')],1),o("div",[i._v("            1,")]),o("div",[i._v("            2")]),o("div",[i._v("        ]")]),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "id": 5,')]),o("div",[i._v('        "title": "三国演义",')]),o("div",[i._v('        "price": 100,')]),o("div",[i._v('        "pub_date": "2012-12-12",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("publish")]),i._v('": 1,')],1),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("authors")]),i._v('": [')],1),o("div",[i._v("            1,")]),o("div",[i._v("            2")]),o("div",[i._v("        ]")]),o("div",[i._v("    }")]),o("div",[i._v("]")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[i._v("# --------------------------------------------------------------")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("#")]),i._v(" "),o("font",{attrs:{color:"#000000"}},[i._v("depth = 1")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8001/book/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 请求类型: GET")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 结果:")])],1),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[o("br")])]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "id": 2,')]),o("div",[i._v('        "title": "三体（第二部）",')]),o("div",[i._v('        "price": 100,')]),o("div",[i._v('        "pub_date": "2012-12-12",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("publish")]),i._v('": {')],1),o("div",[i._v('            "id": 1,')]),o("div",[i._v('            "name": "东莞出版社",')]),o("div",[i._v('            "email": "123@qq.com"')]),o("div",[i._v("        },")]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("authors")]),i._v('": [')],1),o("div",[i._v("            {")]),o("div",[i._v('                "id": 1,')]),o("div",[i._v('                "name": "Kevin",')]),o("div",[i._v('                "age": 18')]),o("div",[i._v("            },")]),o("div",[i._v("            {")]),o("div",[i._v('                "id": 2,')]),o("div",[i._v('                "name": "Aimer",')]),o("div",[i._v('                "age": 20')]),o("div",[i._v("            }")]),o("div",[i._v("        ]")]),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "id": 5,')]),o("div",[i._v('        "title": "三国演义",')]),o("div",[i._v('        "price": 100,')]),o("div",[i._v('        "pub_date": "2012-12-12",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("publish")]),i._v('": {')],1),o("div",[i._v('            "id": 1,')]),o("div",[i._v('            "name": "东莞出版社",')]),o("div",[i._v('            "email": "123@qq.com"')]),o("div",[i._v("        },")]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("authors")]),i._v('": [')],1),o("div",[i._v("            {")]),o("div",[i._v('                "id": 1,')]),o("div",[i._v('                "name": "Kevin",')]),o("div",[i._v('                "age": 18')]),o("div",[i._v("            },")]),o("div",[i._v("            {")]),o("div",[i._v('                "id": 2,')]),o("div",[i._v('                "name": "Aimer",')]),o("div",[i._v('                "age": 20')]),o("div",[i._v("            }")]),o("div",[i._v("        ]")]),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("5.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("Serializer 类的 ")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("source 参数说明")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("source 参数一般用于序列化 choices 字段 和 一对多字段")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("source 参数可以序列化自身字段，但是没有意义")])]),o("ul",[o("li",[o("div",[i._v("即: username = serializers.CharField(source='username') 等同于 username = serializers.CharField()")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("source 参数的值支持像模板语言中的链式操作")])]),o("ul",[o("li",[o("div",[i._v("source='get_choices字段_display' -> source='get_user_type_display'")])]),o("li",[o("div",[i._v("source='一对多字段名.字段' -> source='publish.name'")])]),o("li",[o("div",[i._v("source='多对多字段名.all' -> source='authors.all'")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("6.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 序列化 ")]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("choices ")])]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("字段的方法")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("使用 source 参数序列化 choices 字段")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("如果不使用 source 参数序列化 choices 字段，那么在序列化 choices 字段的时候默认会取与该字段所保存的数值")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("语法: source='get_choices字段_display'")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializer.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class UserSerializers(serializers.Serializer):")]),o("div",[i._v("    username = serializers.CharField(label='用户名')")]),o("div",[i._v("    user_type = serializers.CharField(label='用户类型', "),o("font",{attrs:{color:"#FA7A00"}},[i._v("source")]),i._v("='"),o("font",{attrs:{color:"#FA7A00"}},[i._v("get_")]),i._v("user_type"),o("font",{attrs:{color:"#FA7A00"}},[i._v("_display")]),i._v("')")],1)]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .serializer import *")]),o("div",[i._v("from .models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class UserView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        user_list = User.objects.all()")]),o("div",[i._v("        us = UserSerializers(user_list, many=True)")]),o("div",[i._v("        print(us.data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# [OrderedDict([('username', 'Kevin'), ('")]),o("font",{attrs:{color:"#FA7A00"}},[i._v("user_type")]),o("font",{attrs:{color:"#41AD1C"}},[i._v("', 'SVIP')]), OrderedDict([('username', 'Aimer'), ('")]),o("font",{attrs:{color:"#FA7A00"}},[i._v("user_type")]),o("font",{attrs:{color:"#41AD1C"}},[i._v("', 'VIP')]), OrderedDict([('username', 'Jack'), ('")]),o("font",{attrs:{color:"#FA7A00"}},[i._v("user_type")]),o("font",{attrs:{color:"#41AD1C"}},[i._v("', '普通用户')])]")])],1),o("div",[i._v("        return Response(us.data)")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("#")]),i._v(" "),o("font",{attrs:{color:"#41AD1C"}},[i._v("接口: http://127.0.0.1:8001/user/")])],1),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 请求类型: GET")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 结果:")])]),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "username": "Kevin",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("user_type")]),i._v('": "SVIP"')],1),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "username": "Aimer",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("user_type")]),i._v('": "VIP"')],1),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "username": "Jack",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("user_type")]),i._v('": "普通用户"')],1),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("7.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("SerializerMethodField 自定义字段")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("SerializerMethodField() 字段方法的作用: 自定义字段的返回值")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("使用场景: 当我们想返回一些自定义的值的时候，就可以使用 "),o("span",{staticStyle:{"font-size":"12pt"}},[i._v("SerializerMethodField")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("函数名定义规则: get_字段名")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# serializer.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookSerializers(serializers.Serializer):")]),o("div",[i._v("    title = serializers.CharField(label='书籍名称')")]),o("div",[i._v("    price = serializers.CharField(label='价格')")]),o("div",[o("br")]),o("div",[i._v("    custom_field = serializers."),o("font",{attrs:{color:"#FA7A00"}},[i._v("SerializerMethodField")]),i._v("()")],1),o("div",[o("br")]),o("div",[i._v("    def "),o("font",{attrs:{color:"#FA7A00"}},[i._v("get_custom_field")]),i._v("(self, obj):")],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('"""')])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("        :param")]),i._v(" "),o("font",{attrs:{color:"#FA7A00"}},[i._v("obj")]),o("font",{attrs:{color:"#41AD1C"}},[i._v(":")]),i._v(" "),o("font",{attrs:{color:"#FA7A00"}},[i._v("obj 就是数据库中的一条数据")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("        :")]),o("font",{attrs:{color:"#FA7A00"}},[i._v("return")]),o("font",{attrs:{color:"#41AD1C"}},[i._v(":")]),i._v(" "),o("font",{attrs:{color:"#FA7A00"}},[i._v("所要显示的数据")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('        """')])],1),o("div",[i._v("        price = obj.price")]),o("div",[i._v("        return price + 100")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# views.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        book_list = Book.objects.all()")]),o("div",[i._v("        bs = BookSerializers(book_list, many=True)")]),o("div",[i._v("        print(bs.data)  "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("#")]),o("font",{attrs:{color:"#41AD1C"}},[i._v(" [OrderedDict([('title', '三体'), ('price', '100'), ('")]),o("font",{attrs:{color:"#FA7A00"}},[i._v("custom_field")]),o("font",{attrs:{color:"#41AD1C"}},[i._v("', 200)]), OrderedDict([('title', '七大罪'), ('price', '50'), ('")]),o("font",{attrs:{color:"#FA7A00"}},[i._v("custom_field")]),o("font",{attrs:{color:"#41AD1C"}},[i._v("', 150)])]")])],1),o("div",[i._v("        return Response(bs.data)")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8000/book/")])],1),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 请求类型: GET")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 结果:")])]),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "三体",')]),o("div",[i._v('        "price": "100",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("custom_field")]),i._v('": 200')],1),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "七大罪",')]),o("div",[i._v('        "price": "50",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("custom_field")]),i._v('": 150')],1),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("8.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("context ")]),o("font",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("参数")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("（即: ")]),o("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[i._v("在 ")]),o("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[i._v("serializers 中获取 request 对象")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("）")])])],1),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("视图类没有使用 serializer_class 参数")])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[i._v("通过 context 参数 "),o("span",{staticStyle:{"font-size":"12pt"}},[i._v("serializers 可以接收视图传递过来的参数")])])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        book_list = Book.objects.all()")]),o("div",[i._v("        bs = BookSerializers(book_list, many=True, "),o("font",{attrs:{color:"#FA7A00"}},[i._v("context")]),i._v("={'request': request, 'username': 'Kevin', 'age': 18})")],1),o("div",[i._v("        return Response(bs.data)")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializers.py")])],1),o("div",[o("br")]),o("div",[i._v("class BookSerializers(serializers.Serializer):")]),o("div",[i._v("    title = serializers.CharField(label='书籍名称')")]),o("div",[i._v("    price = serializers.CharField(label='价格')")]),o("div",[o("br")]),o("div",[i._v("    custom_field = serializers.SerializerMethodField()")]),o("div",[o("br")]),o("div",[i._v("    def get_custom_field(self, obj):")]),o("div",[i._v("        print("),o("font",{attrs:{color:"#FA7A00"}},[i._v("self.context")]),i._v(") "),o("font",{attrs:{color:"#41AD1C"}},[i._v(" # {'request': <rest_framework.request.Request object at 0x0000025F75F0D668>, 'age': 18, 'username': 'Kevin'}")])],1),o("div",[i._v("        request = "),o("font",{attrs:{color:"#FA7A00"}},[i._v("self.context")]),i._v(".get('request')")],1),o("div",[i._v("        username = "),o("font",{attrs:{color:"#FA7A00"}},[i._v("self.context")]),i._v(".get('username')")],1),o("div",[i._v("        age = "),o("font",{attrs:{color:"#FA7A00"}},[i._v("self.context")]),i._v(".get('age')")],1),o("div",[i._v("        return 1")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("视图类使用了 serializer_class 参数")])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[i._v("当视图类使用了 serializer_class 参数，那么 "),o("span",{staticStyle:{"font-size":"12pt"}},[i._v("serializers 默认只会接收到三个参数:")])])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("ul",[o("li",[o("div",[i._v("request -> request 对象，当前视图的请求对象")])]),o("li",[o("div",[i._v("format -> 当前请求期望返回的数据格式")])]),o("li",[o("div",[i._v("view -> 当前请求的类视图对象，相当于视图类中的 self")])])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[i._v("from rest_framework import viewsets")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookView(viewsets.ModelViewSet):")]),o("div",[i._v("    queryset = Book.objects.all()")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[i._v("serializer_class")]),i._v(" = BookSerializers")],1)]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializers.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("class BookSerializers(serializers.Serializer):")]),o("div",[i._v("    title = serializers.CharField(label='书籍名称')")]),o("div",[i._v("    price = serializers.CharField(label='价格')")]),o("div",[o("br")]),o("div",[i._v("    custom_field = serializers.SerializerMethodField()")]),o("div",[o("br")]),o("div",[i._v("    def get_custom_field(self, obj):")]),o("div",[i._v("        print("),o("font",{attrs:{color:"#FA7A00"}},[i._v("self.context")]),i._v(")  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# {'view': <api.views.BookView object at 0x00000229E4FCA5C0>, 'request': <rest_framework.request.Request object at 0x00000229E5077898>, 'format': None}")])],1),o("div",[i._v("        request = "),o("font",{attrs:{color:"#FA7A00"}},[i._v("self.context")]),i._v(".get('request')")],1),o("div",[i._v("        response_format = "),o("font",{attrs:{color:"#FA7A00"}},[i._v("self.context")]),i._v(".get('format')")],1),o("div",[i._v("        view = "),o("font",{attrs:{color:"#FA7A00"}},[i._v("self.context")]),i._v(".get('view')")],1),o("div",[i._v("        return 1")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("9.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 序列化组件传递或不传递 request 对象的区别")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("不传递 request 对象")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# models.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("class Picture(models.Model):")]),o("div",[i._v("    title = models.CharField(max_length=32, verbose_name='标题')")]),o("div",[i._v("    img = models.ImageField(upload_to='img/', verbose_name='图片')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from app01.serializer.picture import PictureSerializers")]),o("div",[i._v("from app01.models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PictureView(APIView):")]),o("div",[i._v("    def get(self, request, *args, **kwargs):")]),o("div",[i._v("        picture_queryset = Picture.objects.all()")]),o("div",[i._v("        ps = PictureSerializers(picture_queryset, many=True)")]),o("div",[i._v("        data = ps.data")]),o("div",[i._v("        return Response(data)")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# serializers.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PictureSerializers(serializers.Serializer):")]),o("div",[i._v("    title = serializers.CharField(label='标题')")]),o("div",[i._v("    img = serializers.FileField(label='图片')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 接口: ")]),i._v("http://127.0.0.1:8000/api/picture/")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 请求类型: GET")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 结果:")])]),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "三国演义",')]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[i._v('"img": "/media/img/20200526210016.png"')])],1),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "西游记",')]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[i._v('"img": "/media/img/GVOMVF_OVT0RISCUC2G_McjmBMt.png"')])],1),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "红楼梦",')]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[i._v('"img": "/media/img/GVOMVF_OVT0RISCUC2G_ospZsQ2.png"')])],1),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("传递 request 对象")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[i._v("注意: 在 django_rest_framework 官网提及到如果涉及到路径字段，应当传递 request 对象，以便生成完整的 url 而不是相对 url")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# models.py")])]),o("div",[o("br")]),o("div",[i._v("class Picture(models.Model):")]),o("div",[i._v("    title = models.CharField(max_length=32, verbose_name='标题')")]),o("div",[i._v("    img = models.ImageField(upload_to='img/', verbose_name='图片')")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# views.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from app01.serializer.picture import PictureSerializers")]),o("div",[i._v("from app01.models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PictureView(APIView):")]),o("div",[i._v("    def get(self, request, *args, **kwargs):")]),o("div",[i._v("        picture_queryset = Picture.objects.all()")]),o("div",[i._v("        ps = PictureSerializers(picture_queryset, many=True, "),o("font",{attrs:{color:"#FA7A00"}},[i._v("context={'request': request}")]),i._v(")")],1),o("div",[i._v("        data = ps.data")]),o("div",[i._v("        return Response(data)")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializers.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PictureSerializers(serializers.Serializer):")]),o("div",[i._v("    title = serializers.CharField(label='标题')")]),o("div",[i._v("    img = serializers.FileField(label='图片')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 接口: ")]),i._v("http://127.0.0.1:8000/api/picture/")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 请求类型: GET")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 结果:")])]),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "id": 9,')]),o("div",[i._v('        "title": "三国演义",')]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[i._v('"img": "http://127.0.0.1:8000/media/img/20200526210016.png"')])],1),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "id": 10,')]),o("div",[i._v('        "title": "西游记",')]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[i._v('"img": "http://127.0.0.1:8000/media/img/GVOMVF_OVT0RISCUC2G_McjmBMt.png"')])],1),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "id": 11,')]),o("div",[i._v('        "title": "红楼梦",')]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[i._v('"img": "http://127.0.0.1:8000/media/img/GVOMVF_OVT0RISCUC2G_ospZsQ2.png"')])],1),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("10.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 序列化一对多字段的方法 -> 正向查询")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("使用 source 参数序列化一对多字段")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("如果不使用 source 参数序列化一对多字段，那么在序列化一对多字段的时候默认会取与该字段所关联的表类里面的 __str__ 的返回值")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("语法: source='一对多字段名.字段'")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializer.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookSerializers(serializers.Serializer):")]),o("div",[i._v("    title = serializers.CharField(label='书籍名称')")]),o("div",[i._v("    price = serializers.CharField(label='价格')")]),o("div",[i._v("    pub_date = serializers.CharField(label='出版日期')")]),o("div",[i._v("    publish = serializers.CharField(label='出版社', "),o("font",{attrs:{color:"#FA7A00"}},[i._v("source")]),i._v("='publish.name')  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 序列化一对多字段，且在序列化一对多字段的时候默认取 publish 表下的 name 字段的数据")])],1)]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# views.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        book_list = Book.objects.all()")]),o("div",[i._v("        bs = BookSerializers(book_list, many=True)")]),o("div",[i._v("        print(bs.data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# [OrderedDict([('title', '西游记'), ('price', '111'), ('pub_date', None), ('")]),o("font",{attrs:{color:"#FA7A00"}},[i._v("publish")]),o("font",{attrs:{color:"#41AD1C"}},[i._v("', '东莞出版社')]), OrderedDict([('title', '三体'), ('price', '222'), ('pub_date', None), ('")]),o("font",{attrs:{color:"#FA7A00"}},[i._v("publish")]),o("font",{attrs:{color:"#41AD1C"}},[i._v("', '东莞出版社')])]")])],1),o("div",[i._v("        return Response(bs.data)")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8000/book/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 请求类型: GET")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 结果:")])],1),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "三体",')]),o("div",[i._v('        "price": "222",')]),o("div",[i._v('        "pub_date": null,')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("publish")]),i._v('": "东莞出版社"')],1),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "三国演义",')]),o("div",[i._v('        "price": "100",')]),o("div",[i._v('        "pub_date": "2012-12-12",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("publish")]),i._v('": "东莞出版社"')],1),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("11.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 序列化一对多字段的方法 -> 反向查询")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("使用 SerializerMethodField() 字段方法，自定义函数返回值，实现序列化一对多字段的反向查询")])])])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("SerializerMethodField() 字段方法的作用: 自定义字段的返回值")])])])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("函数名定义规则: get_字段名")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# serializer.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("class PublishSerializers(serializers.Serializer):")]),o("div",[i._v("    name = serializers.CharField(label='出版社名称')")]),o("div",[i._v("    email = serializers.CharField(label='邮箱')")]),o("div",[o("br")]),o("div",[i._v("    book = serializers."),o("font",{attrs:{color:"#FA7A00"}},[i._v("SerializerMethodField")]),i._v("()")],1),o("div",[o("br")]),o("div",[i._v("    def "),o("font",{attrs:{color:"#FA7A00"}},[i._v("get_book")]),i._v("(self, obj):")],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('"""')])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("        :param obj: 当前数据的对象（即: 和查询到的数据对象是一样的）")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('        """')])],1),o("div",[i._v("        temp = []")]),o("div",[i._v("        for book in obj.book_set.all():  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 反向查询")])],1),o("div",[i._v("            temp.append({")]),o("div",[i._v("                'title': book.title,")]),o("div",[i._v("                'price': book.price,")]),o("div",[i._v("                'pub_date': book.pub_date,")]),o("div",[i._v("            })")]),o("div",[i._v("        return temp")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .serializer import *")]),o("div",[i._v("from .models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_list = Publish.objects.all()")]),o("div",[i._v("        ps = PublishSerializers(publish_list, many=True)")]),o("div",[i._v("        return Response(ps.data)")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8001/publish/")])],1),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 请求类型: GET")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 结果:")])]),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "name": "东莞出版社",')]),o("div",[i._v('        "email": "123@qq.com",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("book")]),i._v('": [')],1),o("div",[i._v("            {")]),o("div",[i._v('                "pub_date": "2012-12-12",')]),o("div",[i._v('                "price": 100,')]),o("div",[i._v('                "title": "三体（第二部）"')]),o("div",[i._v("            },")]),o("div",[i._v("            {")]),o("div",[i._v('                "pub_date": "2012-12-12",')]),o("div",[i._v('                "price": 100,')]),o("div",[i._v('                "title": "三国演义"')]),o("div",[i._v("            },")]),o("div",[i._v("            {")]),o("div",[i._v('                "pub_date": "2012-12-12",')]),o("div",[i._v('                "price": 100,')]),o("div",[i._v('                "title": "红楼梦"')]),o("div",[i._v("            }")]),o("div",[i._v("        ]")]),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "name": "广州出版社",')]),o("div",[i._v('        "email": "123@qq.com",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("book")]),i._v('": []')],1),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("12.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 序列化多对多字段的方法 -> 正向查询")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("使用 SerializerMethodField() 字段方法，自定义函数返回值，实现序列化多对多字段的正向查询")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("SerializerMethodField() 字段方法的作用: 自定义字段的返回值")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("函数名定义规则: get_字段名")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializer.py")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[o("br")])]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookSerializers(serializers.Serializer):")]),o("div",[i._v("    title = serializers.CharField(label='书籍名称')")]),o("div",[i._v("    price = serializers.CharField(label='价格')")]),o("div",[i._v("    pub_date = serializers.CharField(label='出版日期')")]),o("div",[i._v("    authors = serializers."),o("font",{attrs:{color:"#FA7A00"}},[i._v("SerializerMethodField")]),i._v("()")],1),o("div",[o("br")]),o("div",[i._v("    def "),o("font",{attrs:{color:"#FA7A00"}},[i._v("get_authors")]),i._v("(self, obj):")],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('"""')])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("        :param obj: 当前数据的对象（即: 和查询到的数据对象是一样的）")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('        """')])],1),o("div",[i._v("        temp = []")]),o("div",[i._v("        for author in obj.authors.all():")]),o("div",[i._v("            temp.append(author.name)")]),o("div",[i._v("        return temp")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# views.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class BookView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        book_list = Book.objects.all()")]),o("div",[i._v("        bs = BookSerializers(book_list, many=True)")]),o("div",[i._v("        print(bs.data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# [OrderedDict([('title', '西游记'), ('price', '111'), ('pub_date', None), ('")]),o("font",{attrs:{color:"#FA7A00"}},[i._v("authors")]),o("font",{attrs:{color:"#41AD1C"}},[i._v("', ['Kevin'])]), OrderedDict([('title', '三体'), ('price', '222'), ('pub_date', None), ('")]),o("font",{attrs:{color:"#FA7A00"}},[i._v("authors")]),o("font",{attrs:{color:"#41AD1C"}},[i._v("', ['Aimer'])])]")])],1),o("div",[i._v("        return Response(bs.data)")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8000/book/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 请求类型: GET")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 结果:")])],1),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "三体",')]),o("div",[i._v('        "price": "222",')]),o("div",[i._v('        "pub_date": null,')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("authors")]),i._v('": [')],1),o("div",[i._v('            "Aimer"')]),o("div",[i._v("        ]")]),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "title": "三国演义",')]),o("div",[i._v('        "price": "100",')]),o("div",[i._v('        "pub_date": "2012-12-12",')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("authors")]),i._v('": [')],1),o("div",[i._v('            "Kevin",')]),o("div",[i._v('            "Aimer"')]),o("div",[i._v("        ]")]),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("13.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 序列化多对多字段的方法 -> 反向查询")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("使用 SerializerMethodField() 字段方法，自定义函数返回值，实现序列化多对多字段的反向查询")])])])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("SerializerMethodField() 字段方法的作用: 自定义字段的返回值")])])])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("函数名定义规则: get_字段名")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# serializer.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class AuthorSerializers(serializers.Serializer):")]),o("div",[i._v("    name = serializers.CharField(label='作者名称')")]),o("div",[i._v("    age = serializers.IntegerField(label='年龄')")]),o("div",[o("br")]),o("div",[i._v("    book = serializers."),o("font",{attrs:{color:"#FA7A00"}},[i._v("SerializerMethodField")]),i._v("()")],1),o("div",[o("br")]),o("div",[i._v("    def "),o("font",{attrs:{color:"#FA7A00"}},[i._v("get_book")]),i._v("(self, obj):")],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('"""')])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("        :param obj: 当前数据的对象（即: 和查询到的数据对象是一样的）")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('        """')])],1),o("div",[i._v("        temp = []")]),o("div",[i._v("        for book in obj.book_set.all():  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 反向查询")])],1),o("div",[i._v("            temp.append({")]),o("div",[i._v("                'title': book.title,")]),o("div",[i._v("                'price': book.price,")]),o("div",[i._v("                'pub_date': book.pub_date,")]),o("div",[i._v("            })")]),o("div",[i._v("        return temp")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1)]),o("div",[o("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1)]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .serializer import *")]),o("div",[i._v("from .models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class AuthorView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        author_list = Author.objects.all()")]),o("div",[i._v("        aus = AuthorSerializers(author_list, many=True)")]),o("div",[i._v("        return Response(aus.data)")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8001/author/")])],1),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 请求类型: GET")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 结果:")])]),o("div",[o("br")]),o("div",[i._v("[")]),o("div",[i._v("    {")]),o("div",[i._v('        "name": "Kevin",')]),o("div",[i._v('        "age": 18,')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("book")]),i._v('": [')],1),o("div",[i._v("            {")]),o("div",[i._v('                "title": "红楼梦",')]),o("div",[i._v('                "price": 100,')]),o("div",[i._v('                "pub_date": "2012-12-12"')]),o("div",[i._v("            },")]),o("div",[i._v("            {")]),o("div",[i._v('                "title": "勿忘我",')]),o("div",[i._v('                "price": 100,')]),o("div",[i._v('                "pub_date": "2012-12-12"')]),o("div",[i._v("            }")]),o("div",[i._v("        ]")]),o("div",[i._v("    },")]),o("div",[i._v("    {")]),o("div",[i._v('        "name": "Aimer",')]),o("div",[i._v('        "age": 20,')]),o("div",[i._v('        "'),o("font",{attrs:{color:"#FA7A00"}},[i._v("book")]),i._v('": [')],1),o("div",[i._v("            {")]),o("div",[i._v('                "title": "三体（第二部）",')]),o("div",[i._v('                "price": 100,')]),o("div",[i._v('                "pub_date": "2012-12-12"')]),o("div",[i._v("            },")]),o("div",[i._v("            {")]),o("div",[i._v('                "title": "三国演义",')]),o("div",[i._v('                "price": 100,')]),o("div",[i._v('                "pub_date": "2012-12-12"')]),o("div",[i._v("            },")]),o("div",[i._v("            {")]),o("div",[i._v('                "title": "超人",')]),o("div",[i._v('                "price": 100,')]),o("div",[i._v('                "pub_date": "2012-12-12"')]),o("div",[i._v("            }")]),o("div",[i._v("        ]")]),o("div",[i._v("    }")]),o("div",[i._v("]")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("14.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 验证数据是否有误")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("一般都是验证提交过来的数据")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("这里的验证数据功能和Form组件或者ModelForm是一样的")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# serializer.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishSerializers(serializers.Serializer):")]),o("div",[i._v("    name = serializers.CharField(error_messages={'required': '出版社名称不能为空'})")]),o("div",[i._v("    email = serializers.CharField(error_messages={'required': '邮箱不能为空'})")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def post(self, request):")]),o("div",[i._v("        ps = PublishSerializers("),o("font",{attrs:{color:"#FA7A00"}},[i._v("data")]),i._v("=request.data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 将提交过来的数据传入data参数中进行验证")])],1),o("div",[i._v("        if ps."),o("font",{attrs:{color:"#FA7A00"}},[i._v("is_valid")]),i._v("():  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 验证提交过来的数据")])],1),o("div",[i._v("            print(ps."),o("font",{attrs:{color:"#FA7A00"}},[i._v("validated_data")]),i._v(")  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 获取验证通过的数据 -> OrderedDict([('name', '深圳出版社'), ('email', '123@qq.com')])")])],1),o("div",[i._v("            publish = Publish.objects.create(**ps.validated_data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 将数据保存到数据库")])],1),o("div",[i._v("            p_ps = PublishSerializers(publish)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 序列化数据")])],1),o("div",[i._v("            return Response(p_ps.data)")]),o("div",[i._v("        else:")]),o("div",[i._v("            print(ps."),o("font",{attrs:{color:"#FA7A00"}},[i._v("errors")]),i._v(")  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 获取验证失败后的错误信息")])],1),o("div",[i._v("            return Response(ps.errors)")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口说明: 添加出版社")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 接口: http://127.0.0.1:8000/publish/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 请求类型: POST")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 发送数据的编码格式: application/json -> 即: json 格式")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 所要发送的数据: ")]),i._v('{"name":"上海出版社","email":"123@qq.com"}')],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 结果:")])],1),o("div",[o("br")]),o("div",[i._v("{")]),o("div",[i._v('    "name": "上海出版社",')]),o("div",[i._v('    "email": "123@qq.com"')]),o("div",[i._v("}")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("15.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 验证器")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("验证器相当于局部钩子函数，定义在 serializers 类字段中")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializer.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("import re")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("def "),o("font",{attrs:{color:"#FA7A00"}},[i._v("phone_validator")]),i._v("(value):")],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v(' """')])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("    :param value: 当前字段的内容")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("    :return: 验证通过无需返回任何内容，验证失败直接抛出异常")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('    """')])],1),o("div",[i._v("    if not re.match(r'^(1[3|4|5|6|7|8|9]\\d{9})$', value):")]),o("div",[i._v("        raise serializers.ValidationError('手机格式错误')")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class UserInfoSerializers(serializers.Serializer):")]),o("div",[i._v("    username = serializers.CharField(label='用户名')")]),o("div",[i._v("    phone = serializers.CharField(label='电话号码', "),o("font",{attrs:{color:"#FA7A00"}},[i._v("validators")]),i._v("=["),o("font",{attrs:{color:"#FA7A00"}},[i._v("phone_validator")]),i._v("])")],1)]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from app01.serializer.picture import UserInfoSerializers")]),o("div",[i._v("from app01.models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class UserInfoView(APIView):")]),o("div",[i._v("    def post(self, request, *args, **kwargs):")]),o("div",[i._v("        us = UserInfoSerializers(data=request.data)")]),o("div",[i._v("        data = {}")]),o("div",[i._v("        if us.is_valid():")]),o("div",[i._v("            print(us.validated_data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 验证通过的数据 -> 有序字典: OrderedDict([('username', 'Kevin'), ('phone', '13022024070')])")])],1),o("div",[i._v("            userinfo = UserInfo.objects.create(**us.validated_data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 将数据保存到数据库")])],1),o("div",[i._v("            u_us = UserInfoSerializers(userinfo)")]),o("div",[i._v("            data = u_us.data")]),o("div",[i._v("        else:")]),o("div",[i._v("            data = us.errors")]),o("div",[i._v("        return Response(data)")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("16.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 部分更新")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("默认情况下，序列化器必须传递所有必填字段的值，否则就会引发验证错误。你可以使用 partial 参数来允许部分更新")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# models.py")])],1),o("div",[o("br")]),o("div",[i._v("class UserInfo(models.Model):")]),o("div",[i._v("    username = models.CharField(max_length=32, verbose_name='用户名')")]),o("div",[i._v("    phone = models.CharField(max_length=32, verbose_name='电话号码')")]),o("div",[i._v("    age = models.IntegerField(verbose_name='年龄')")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# serializer.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class UserInfoSerializers(serializers.Serializer):")]),o("div",[i._v("    username = serializers.CharField(label='用户名')")]),o("div",[i._v("    phone = serializers.CharField(label='电话号码')")]),o("div",[i._v("    age = serializers.IntegerField(label='年龄')")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from app01.serializer.picture import PictureSerializers, UserInfoSerializers")]),o("div",[i._v("from app01.models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class UserInfoView(APIView):")]),o("div",[i._v("    def put(self, request, *args, **kwargs):")]),o("div",[i._v("        data = {}")]),o("div",[i._v("        pk = kwargs.get('pk')")]),o("div",[i._v("        user_queryset = UserInfo.objects.filter(pk=pk)")]),o("div",[i._v("        user_obj = user_queryset.first()")]),o("div",[o("br")]),o("div",[i._v("        us = UserInfoSerializers(data=request.data, "),o("font",{staticStyle:{color:"rgb(250, 122, 0)"}},[i._v("partial=True")]),i._v(")")],1),o("div",[o("br")]),o("div",[i._v("        if us.is_valid():")]),o("div",[i._v("            user_obj.phone = request.data.get('phone')")]),o("div",[i._v("            user_obj.age = int(request.data.get('age'))")]),o("div",[i._v("            user_obj.save()")]),o("div",[i._v("            u_us = UserInfoSerializers(user_obj)")]),o("div",[i._v("            data = u_us.data")]),o("div",[i._v("        else:")]),o("div",[i._v("            data = us.errors")]),o("div",[i._v("        return Response(data)")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 接口: ")]),i._v("http://127.0.0.1:8000/api/userinfo/13/")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 请求类型: PUT")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 传递的参数: ")])]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#464646"}},[o("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[i._v("phone = ")]),i._v("13038802402")])],1),o("div",[o("br")]),o("div",[i._v("age = 22")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 结果:")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[o("br")])]),o("div",[i._v("{")]),o("div",[i._v('    "username": "Kevin",')]),o("div",[i._v('    "phone": "13038802402",')]),o("div",[i._v('    "age": 22')]),o("div",[i._v("}")])]),o("div",[o("br")]),o("div",[o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("序列化数据的方式")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"18.6667px"}},[i._v("这里的序列化数据指的是将 ")]),o("span",{staticStyle:{"font-size":"18.6667px",color:"rgb(250, 122, 0)"}},[i._v("queryset对象")]),o("span",{staticStyle:{"font-size":"18.6667px"}},[i._v(" 或 ")]),o("span",{staticStyle:{"font-size":"18.6667px",color:"rgb(65, 173, 28)"}},[i._v("查询到的数据对象")]),o("span",{staticStyle:{"font-size":"18.6667px"}},[i._v(" 转换成 ")]),o("span",{staticStyle:{"font-size":"18.6667px",color:"rgb(250, 122, 0)"}},[i._v("列表")]),o("span",{staticStyle:{"font-size":"18.6667px"}},[i._v(" 或 ")]),o("span",{staticStyle:{"font-size":"18.6667px",color:"rgb(65, 173, 28)"}},[i._v("字典，")]),o("span",{staticStyle:{"font-size":"18.6667px"}},[i._v("然后将序列化好的数据发送给前端")])])]),o("div",[o("span",{staticStyle:{"font-size":"18.6667px"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 序列化 queryset 对象（查询到的数据列表）")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("方式一")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from django.shortcuts import render, HttpResponse")]),o("div",[i._v("from django.http import JsonResponse")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from .models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_queryset = Publish.objects.all().values('name', 'email')")]),o("div",[i._v("        publish_list = list(publish_queryset)")]),o("div",[i._v("        print(publish_list)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# [{'name': '东莞出版社', 'email': '123@qq.com'}, {'name': '广州出版社', 'email': '123@qq.com'}]")])],1),o("div",[i._v("        return JsonResponse(publish_list, safe=False)")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("方式二")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from django.shortcuts import render, HttpResponse")]),o("div",[i._v("from django.http import JsonResponse")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from django.forms.models import model_to_dict")]),o("div",[i._v("from .models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_queryset = Publish.objects.all()")]),o("div",[i._v("        publish_list = []")]),o("div",[i._v("        for publish in publish_queryset:")]),o("div",[i._v("            publish_list.append(model_to_dict(publish))")]),o("div",[i._v("        print(publish_list)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# [{'id': 1, 'name': '东莞出版社', 'email': '123@qq.com'}, {'id': 2, 'name': '广州出版社', 'email': '123@qq.com'}]")])],1),o("div",[i._v("        return JsonResponse(publish_list, safe=False)")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("方式三")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from django.shortcuts import render, HttpResponse")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from django.core import serializers")]),o("div",[i._v("from .models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_queryset = Publish.objects.all()")]),o("div",[i._v('        publish_list = serializers.serialize("json", publish_queryset)')]),o("div",[i._v("        print(publish_list)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v('# [{"model": "app01.publish", "pk": 1, "fields": {"name": "\\u4e1c\\u839e\\u51fa\\u7248\\u793e", "email": "123@qq.com"\'+\'}\'+\'}\'}}, {"model": "app01.publish", "pk": 2, "fields": {"name": "\\u5e7f\\u5dde\\u51fa\\u7248\\u793e", "email": "123@qq.com"\'+\'}\'+\'}\'}}]')])],1),o("div",[i._v("        return HttpResponse(publish_list)")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("方式四 -> 推荐使用")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# serializer.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishSerializers(serializers.Serializer):")]),o("div",[i._v("    name = serializers.CharField(label='出版社名称')")]),o("div",[i._v("    email = serializers.CharField(label='邮箱')")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from django.shortcuts import render, HttpResponse")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_queryset = Publish.objects.all().values('name', 'email')")]),o("div",[i._v("        ps = PublishSerializers(publish_queryset, many=True)")]),o("div",[i._v("        print(ps.data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 获取序列化之后的数据 -> [OrderedDict([('name', '东莞出版社'), ('email', '123@qq.com')]), OrderedDict([('name', '广州出版社'), ('email', '123@qq.com')])]")])],1),o("div",[i._v("        return Response(ps.data)")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("2.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 序列化查询到的数据对象")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("方式一")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from django.shortcuts import render, HttpResponse")]),o("div",[i._v("from django.http import JsonResponse")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from django.forms.models import model_to_dict")]),o("div",[i._v("from .models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_obj = Publish.objects.all().first()")]),o("div",[i._v("        publish_dict = model_to_dict(publish_obj)")]),o("div",[i._v("        print(publish_dict)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# {'email': '123@qq.com', 'name': '东莞出版社', 'id': 1}")])],1),o("div",[i._v("        return JsonResponse(publish_dict)")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("方式二")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# serializer.py")])]),o("div",[o("br")]),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishSerializers(serializers.Serializer):")]),o("div",[i._v("    name = serializers.CharField(label='出版社名称')")]),o("div",[i._v("    email = serializers.CharField(label='邮箱')")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# views.py")])]),o("div",[o("br")]),o("div",[i._v("from django.shortcuts import render, HttpResponse")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from .models import *")]),o("div",[i._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class PublishView(APIView):")]),o("div",[i._v("    def get(self, request):")]),o("div",[i._v("        publish_obj = Publish.objects.all().first()")]),o("div",[i._v("        ps = PublishSerializers(publish_obj)")]),o("div",[i._v("        print(ps.data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 获取序列化之后的数据 -> {'email': '123@qq.com', 'name': '东莞出版社'}")])],1),o("div",[i._v("        return Response(ps.data)")])]),o("div",[o("br")])]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("钩子函数")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("什么是钩子函数: Django源码通过反射找到指定前缀的函数并且执行该函数，即: 该指定前缀的函数就是钩子函数")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("什么时候使用钩子函数: 当 Serializers 组件所提供的校验规则无法满足你的校验，那么可以使用钩子函数自定义校验规则")])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("局部钩子函数")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[i._v("使用场景: 对某一个字段进行校验，如: 在注册的时候判断用户名字段是否已经被注册过了")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[i._v("在 ")]),i._v("Serializers "),o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[i._v("类中定义")]),i._v(" validate_"),o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[i._v("字段名() 方法，就能够实现对特定字段进行校验")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[i._v("# ")]),i._v("serializer/userinfo.py")])],1),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[o("br")])]),o("div",[i._v("from rest_framework import serializers")]),o("div",[i._v("from app01.models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class UserInfoSerializers(serializers.Serializer):")]),o("div",[i._v("    username = serializers.CharField(label='用户名')")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 定义局部钩子（validate_字段名() 方法），用来校验username字段")])],1),o("div",[i._v("    def "),o("font",{attrs:{color:"#FA7A00"}},[i._v("validate_")]),i._v("username(self, value):")],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('"""')])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("        :param value: 当前字段的数据")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("        :return: 通过验证的数据")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('        """')])],1),o("div",[i._v("        username_obj = UserInfo.objects.filter(username=value).first()")]),o("div",[i._v("        if username_obj:")]),o("div",[i._v("            raise serializers.ValidationError('用户名已注册')")]),o("div",[i._v("        return value")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from app01.serializer.userinfo import UserInfoSerializers")]),o("div",[i._v("from app01.models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class UserInfoView(APIView):")]),o("div",[i._v("    def post(self, request):")]),o("div",[i._v("        ser = UserInfoSerializers(data=request.data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 将提交过来的数据传入data参数中进行验证")])],1),o("div",[i._v("        if ser.is_valid():  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 验证提交过来的数据")])],1),o("div",[i._v("            print(ser.validated_data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 获取验证通过的数据 -> 有序字典 OrderedDict([('username', 'Kevin')])")])],1),o("div",[i._v("            userinfo_obj = UserInfo.objects.create(**ser.validated_data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 将数据保存到数据库")])],1),o("div",[i._v("            ser_data = UserInfoSerializers(userinfo_obj)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 序列化数据")])],1),o("div",[i._v("            return Response(ser_data.data)")]),o("div",[i._v("        else:")]),o("div",[i._v("            print(ser.errors) "),o("font",{attrs:{color:"#41AD1C"}},[i._v(" # 获取验证失败后的错误信息 -> {'username': [ErrorDetail(string='用户名已注册', code='invalid')]}")])],1),o("div",[i._v("            return Response(ser.errors)")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("2.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("全局钩子函数")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("使用场景: 获取所有已经通过验证的字段，然后取某几个字段进行二次判断，如: 校验两次密码是否一致")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[i._v("全局钩子的说明: 当全部校验通过后才会执行clean()方法，且在clean()方法中一定可以获取到所有已经通过验证的数据")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[i._v("在Form类中定义 clean() 方法，就能够实现对字段进行全局校验")])])])]),o("div",[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# serializer/userinfo.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[i._v("from rest_framework import serializers")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class UserInfoSerializers(serializers.Serializer):")]),o("div",[i._v("    username = serializers.CharField(label='用户名')")]),o("div",[i._v("    password = serializers.CharField(label='密码')")]),o("div",[i._v("    confirm_password = serializers.CharField()")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# 全局钩子")])],1),o("div",[i._v("    def "),o("font",{attrs:{color:"#FA7A00"}},[i._v("validate")]),i._v("(self, attrs):")],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('"""')])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("        :param attrs: 所有验证通过的数据")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("        :return: 验证通过的数据")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v('        """')])],1),o("div",[i._v("        print(attrs)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 有序字典 -> OrderedDict([('username', 'Kevin'), ('password', '123'), ('confirm_password', '1234')])")])],1),o("div",[i._v("        if attrs.get('password') != attrs.get('confirm_password'):")]),o("div",[i._v('            raise serializers.ValidationError("两次密码不一致")')]),o("div",[i._v("        attrs.pop('confirm_password')")]),o("div",[i._v("        return attrs")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[i._v("# views.py")])],1),o("div",[o("br")]),o("div",[i._v("from rest_framework.views import APIView")]),o("div",[i._v("from rest_framework.response import Response")]),o("div",[i._v("from app01.serializer.userinfo import UserInfoSerializers")]),o("div",[i._v("from app01.models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[i._v("class UserInfoView(APIView):")]),o("div",[i._v("    def post(self, request):")]),o("div",[i._v("        ser = UserInfoSerializers(data=request.data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 将提交过来的数据传入data参数中进行验证")])],1),o("div",[i._v("        if ser.is_valid():  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 验证提交过来的数据")])],1),o("div",[i._v("            print(ser.validated_data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 获取验证通过的数据 -> 有序字典 OrderedDict([('username', 'Kevin'), ('password', '123')])")])],1),o("div",[i._v("            UserInfo.objects.create(**ser.validated_data)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 将数据保存到数据库")])],1),o("div",[i._v("            return Response({'msg': '添加成功'})")]),o("div",[i._v("        else:")]),o("div",[i._v("            print(ser.errors)  "),o("font",{attrs:{color:"#41AD1C"}},[i._v("# 获取验证失败后的错误信息 -> {'non_field_errors': [ErrorDetail(string='两次密码不一致', code='invalid')]}")])],1),o("div",[i._v("            return Response(ser.errors)")])]),o("div",[o("br")])])])])}),[],!1,null,null,null);r.default=t.exports}}]);