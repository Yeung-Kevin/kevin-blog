(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{425:function(t,o,i){"use strict";i.r(o);var r=i(25),e=Object(r.a)({},(function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[i("div",[i("span",[i("div",[i("div",[i("div",[i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/本章节的所有例子.rar"}},[i("img",{attrs:{alt:"本章节的所有例子.rar",src:"/kevin-blog/Django/跨域_files/ea38f7354ed4c8127c208065275cda22.png"}})])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[t._v("使用后台发送请求不存在跨域问题，因为中间介质不是浏览器，没有同源策略")])]),i("div",[i("br")]),i("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[i("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("同源策略")])]),i("div",[i("br")]),i("div",[t._v("同源策略（Same origin policy）是一种约定，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，则浏览器的正常功能可能都会受到影响。可以说Web是构建在同源策略基础之上的，浏览器只是针对同源策略的一种实现。")]),i("div",[i("br")]),i("div",[t._v("同源策略，它是由Netscape提出的一个著名的安全策略。现在所有支持JavaScript 的浏览器都会使用这个策略。")]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("所谓同源是指，域名，协议，端口相同。当一个浏览器的两个tab页中分别打开来 百度和谷歌的页面当浏览器的百度tab页执行一个脚本的时候会检查这个脚本是属于哪个页面的，即检查是否同源，只有和百度同源的脚本才会被执行。")]),i("span",{staticStyle:{"font-size":"12pt"}},[t._v("（")]),i("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[t._v("通俗理解:")]),t._v(" "),i("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[t._v("本次请求的协议、域名、端口、和当前网站的协议、域名、端口相同的就叫同源")]),i("span",{staticStyle:{"font-size":"12pt"}},[t._v("）")])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("如果非同源，那么在请求数据时，浏览器会在控制台中报一个异常，提示拒绝访问")]),t._v("。（"),i("span",{staticStyle:{color:"rgb(255, 0, 0)"}},[t._v("通俗理解: js无法请求与当前协议、域名、端口不相同的数据，即: 百度无法直接请求谷歌的接口，必须跨域")]),t._v("）")]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{color:"rgb(227, 0, 0)","font-weight":"bold"}},[t._v("当请求的网址与当前协议、域名、端口不相同的时候，其实服务器那边已经接受到了请求并且返回了数据，只不过被浏览器进行了拦截")]),i("span",{staticStyle:{"font-weight":"bold"}},[t._v("（")]),i("span",{staticStyle:{color:"rgb(227, 0, 0)","font-weight":"bold"}},[t._v("通俗理解:")]),t._v(" "),i("span",{staticStyle:{color:"rgb(227, 0, 0)","font-weight":"bold"}},[t._v("在跨域请求的时候A向B发送请求，B接收到了请求并")]),i("span",{staticStyle:{color:"rgb(227, 0, 0)","font-weight":"bold"}},[t._v("且")]),i("span",{staticStyle:{color:"rgb(227, 0, 0)","font-weight":"bold"}},[t._v("返回了数据，但是返回的数据被浏览器拦截下来了")]),i("span",{staticStyle:{"font-weight":"bold"}},[t._v("）")])]),i("div",[i("br")]),i("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[i("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("JSONP")])]),i("div",[i("br")]),i("div",[t._v("JSONP的原理: 通过script标签的跨域特性来绕过同源策略")]),i("div",[i("br")]),i("div",[t._v("JSONP: 前端+后端解决跨域问题")]),i("div",[i("br")]),i("div",[t._v("使用JONSP解决跨域的步骤: ")]),i("div",[i("br")]),i("ol",[i("li",[i("div",[t._v("服务器返回一段 JS 执行函数的代码")])]),i("li",[i("div",[t._v("前端通过js生成script标签，然后通过script标签请求需要跨域的网址")])]),i("li",[i("div",[t._v("得到服务器返回的 JS 执行函数的代码，并且执行该代码")])])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{color:"rgb(255, 0, 0)"}},[t._v("注意: JSONP一定是GET请求")])]),i("div",[i("br")]),i("div",[i("font",{staticStyle:{"font-size":"14pt"}},[i("span",{staticStyle:{"white-space":"pre-wrap","font-size":"14pt","font-weight":"bold"}},[t._v("1.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 跨域实例一 -> area_a 跨域请求 area_b 的数据")])])],1),i("div",[i("font",{staticStyle:{"font-size":"14pt"}},[i("br")])],1),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("area_a启动的时候端口设置为8001，area_b启动的时候端口设置为8002")])])])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[t._v("area_b的服务端")])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/area_b_jsonp.rar"}},[i("img",{attrs:{alt:"area_b_jsonp.rar",src:"/kevin-blog/Django/跨域_files/82d0970ddcea518d357ea36689c8b391.png"}})])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# area_b/urls.py")])],1),i("div",[i("br")]),i("div",[t._v("urlpatterns = [")]),i("div",[t._v("    url(r'^admin/', admin.site.urls),")]),i("div",[t._v("    url(r'^area_b_service_jsonp/', views.service_jsonp),")]),i("div",[t._v("]")])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# area_b/views.py")])],1),i("div",[i("br")]),i("div",[t._v("def service_jsonp(request):")]),i("div",[t._v("    func = request.GET.get('callback')  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 获取传递过来的js函数名")])],1),i("div",[i("br")]),i("div",[t._v("    json_data = {")]),i("div",[t._v("        'area': 'area_b',")]),i("div",[t._v("        'name': 'Yeung'")]),i("div",[t._v("    }")]),i("div",[i("br")]),i("div",[t._v("    return HttpResponse('%s(%s)' % (func, json.dumps(json_data)))  "),i("font",{attrs:{color:"#41AD1C"}},[t._v('# 返回一个执行js函数的代码 callback({"area": "area_b", "name": "Yeung"})')])],1)]),i("div",[i("br")]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("借助Script标签实现跨域 -> jsonp 实现的原理")])])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/area_a_script.rar"}},[i("img",{attrs:{alt:"area_a_script.rar",src:"/kevin-blog/Django/跨域_files/af9715f2685a28ddc6aee36ca47d0e79.png"}})])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# area_a/jsonp.html")])],1),i("div",[i("br")]),i("div",[t._v('<button class="console">获取area_b的数据</button>')]),i("div",[i("br")]),i("div",[t._v('<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"><\/script>')]),i("div",[i("br")]),i("div",[t._v('<script type="text/javascript">')]),i("div",[i("br")]),i("div",[t._v("    function callback_fn(res) {")]),i("div",[t._v("        console.log(res);")]),i("div",[t._v("        alert(res.area + ',' + res.name)")]),i("div",[t._v("    }")]),i("div",[i("br")]),i("div",[t._v("    function get_jsonp_data(url) {")]),i("div",[t._v("        var $script = $('<script></sciprt>');")]),i("div",[t._v("        $script.attr('src', url);")]),i("div",[t._v('        $("body").append($script);')]),i("div",[t._v("        $script.remove();")]),i("div",[t._v("    }")]),i("div",[i("br")]),i("div",[t._v("    $('.console').click(function () {")]),i("div",[t._v("        get_jsonp_data('"),i("font",{attrs:{color:"#FA7A00"}},[t._v("http://127.0.0.1:8002/area_b_service_jsonp/?callback=callback_fn")]),t._v("')")],1),i("div",[t._v("    });")]),i("div",[i("br")]),i("div",[t._v("<\/script>")])]),i("div",[i("br")])]),i("ul",[i("li",[i("div",[t._v("ajax 实现跨域1 -> ajax的jsonp都是基于上面 "),i("span",{staticStyle:{"font-size":"12pt"}},[t._v("借助Script标签实现跨域 的例子封装的")])])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/area_a_ajax1.rar"}},[i("img",{attrs:{alt:"area_a_ajax1.rar",src:"/kevin-blog/Django/跨域_files/18ea733942e4582e5a126565ac9fd4fb.png"}})])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# area_a/jsonp.html")])],1),i("div",[i("br")]),i("div",[t._v('<button class="console_ajax">使用ajax获取area_b的数据</button>')]),i("div",[i("br")]),i("div",[t._v('<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"><\/script>')]),i("div",[i("br")]),i("div",[t._v('<script type="text/javascript">')]),i("div",[i("br")]),i("div",[t._v("    function callback_fn(res) {")]),i("div",[t._v("        console.log(res);")]),i("div",[t._v("        alert(res.area + ',' + res.name)")]),i("div",[t._v("    }")]),i("div",[i("br")]),i("div",[t._v("    $('.console_ajax').click(function () {")]),i("div",[t._v("        $.ajax({")]),i("div",[t._v('            url: "http://127.0.0.1:8002/area_b_service_jsonp/",')]),i("div",[t._v('            type: "get",')]),i("div",[t._v('            dataType: "jsonp",')]),i("div",[t._v("            jsonp: 'callback', "),i("font",{attrs:{color:"#41AD1C"}},[t._v("// jsonp 参数就是定义地址参数中的key，注意 json 参数所设置的值一定要对应后台 request.GET.get('xxx') 的参数（即: request.GET 获取的是xxx，那么json参数所设置的值就是xxx）")])],1),i("div",[t._v('            jsonpCallback: "callback_fn" '),i("font",{attrs:{color:"#41AD1C"}},[t._v("// jsonpCallback 参数就是定义地址参数中的value")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("// jsonp 和 jsonpCallback 结合起来就是 ?callback=callback_fn -> http://127.0.0.1:8002/area_b_service_jsonp/?callback=callback_fn")])],1),i("div",[t._v("        })")]),i("div",[t._v("    })")]),i("div",[i("br")]),i("div",[t._v("<\/script>")])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("ajax 实现跨域2 -> 推荐使用 -> ajax的jsonp都是基于上面 "),i("span",{staticStyle:{"font-size":"12pt"}},[t._v("借助Script标签实现跨域 的例子封装的")])])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/area_a_ajax2.rar"}},[i("img",{attrs:{alt:"area_a_ajax2.rar",src:"/kevin-blog/Django/跨域_files/378e6d1741d09968c7619c83515de2a3.png"}})])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# area_a/jsonp.html")])],1),i("div",[i("br")]),i("div",[t._v('<button class="console_ajax">使用ajax获取area_b的数据</button>')]),i("div",[i("br")]),i("div",[t._v('<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"><\/script>')]),i("div",[i("br")]),i("div",[t._v('<script type="text/javascript">')]),i("div",[i("br")]),i("div",[t._v("    $('.console_ajax').click(function () {")]),i("div",[t._v("        $.ajax({")]),i("div",[t._v('            url: "http://127.0.0.1:8002/area_b_service_jsonp/",')]),i("div",[t._v('            type: "get",')]),i("div",[t._v('            dataType: "jsonp",')]),i("div",[t._v("            jsonp: 'callback',  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("// jsonp 参数就是定义地址参数中的key，注意 json 参数所设置的值一定要对应后台 request.GET.get('xxx') 的参数（即: request.GET 获取的是xxx，那么json参数所设置的值就是xxx）")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v('            // jsonpCallback: "callback_fn" // jsonpCallback 参数就是定义地址参数中的value')])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("            // 如果不设置 jsonpCallback 参数，ajax 会随机生成一个函数名，且函数名指向的是 success 参数中所定义的函数")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("            // 不设置 jsonpCallback 参数所生成的网址 http://127.0.0.1:8002/area_b_service_jsonp/?callback=jQuery341039645627901967906_1559658050676")])],1),i("div",[t._v("            success: function (res) {")]),i("div",[t._v("                console.log(res)")]),i("div",[t._v("            }")]),i("div",[t._v("        })")]),i("div",[t._v("    })")]),i("div",[i("br")]),i("div",[t._v("<\/script>")])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("ajax 实现跨域3 -> ajax的jsonp都是基于上面 "),i("span",{staticStyle:{"font-size":"12pt"}},[t._v("借助Script标签实现跨域 的例子封装的")])])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/area_a_ajax3.rar"}},[i("img",{attrs:{alt:"area_a_ajax3.rar",src:"/kevin-blog/Django/跨域_files/8993878e055bbac743be6289419ff677.png"}})])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# area_a/jsonp.html")])],1),i("div",[i("br")]),i("div",[t._v('<button class="console_ajax">使用ajax获取area_b的数据</button>')]),i("div",[i("br")]),i("div",[t._v('<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"><\/script>')]),i("div",[i("br")]),i("div",[t._v('<script type="text/javascript">')]),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("/*")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("    function callback_fn(res) {")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("        console.log(res);")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("        alert(res.area + ',' + res.name)")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("    }")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("    */")])],1),i("div",[i("br")]),i("div",[t._v("    $('.console_ajax').click(function () {")]),i("div",[t._v("        $.ajax({")]),i("div",[t._v('            url: "http://127.0.0.1:8002/area_b_service_jsonp/",')]),i("div",[t._v('            type: "get",')]),i("div",[t._v('            dataType: "jsonp",')]),i("div",[t._v("            jsonp: 'callback',  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("// jsonp 参数就是定义地址参数中的key，注意 json 参数所设置的值一定要对应后台 request.GET.get('xxx') 的参数（即: request.GET 获取的是xxx，那么json参数所设置的值就是xxx）")])],1),i("div",[t._v('            jsonpCallback: "callback_fn", '),i("font",{attrs:{color:"#41AD1C"}},[t._v("// jsonpCallback 参数就是定义地址参数中的value")])],1),i("div",[t._v("            success: function (res) {")]),i("div",[t._v("                console.log(res)")]),i("div",[t._v("            }")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("/*")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                同时设置了 jsonp jsonpCallback success 参数:")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                没有名为 callback_fn 函数的情况:")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                    ajax会执行 success 参数所定义的函数")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                    所生成的网址: http://127.0.0.1:8002/area_b_service_jsonp/?callback=callback_fn&_=1559658490205")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                有名为 callback_fn 函数的情况:")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                    ajax 会执行名为 callback_fn 函数，而不执行 success 参数所定义的函数")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                    所生成的网址: http://127.0.0.1:8002/area_b_service_jsonp/?callback=callback_fn&_=1559658490205")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                结论:")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                    不要同时设置了 jsonp jsonpCallback success 参数")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                    如果设置了 jsonp success 就不要设置 jsonpCallback 参数")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("                    如果设置了 jsonp jsonpCallback 就不要设置 success 参数")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("            */")])],1),i("div",[t._v("        })")]),i("div",[t._v("    })")]),i("div",[t._v("<\/script>")])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 跨域实例二 -> 跨域请求")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("div",[i("a",{attrs:{href:"跨域_files/jsop_example.html"}},[i("img",{attrs:{alt:"jsop_example.html",src:"/kevin-blog/Django/跨域_files/519d87d29a78c96fed967723e7e6d0dd.png"}})])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# jsop_example.html")])],1),i("div",[i("br")]),i("div",[t._v('<input type="button" onclick="AjaxRequest()" value="跨域Ajax"/>')]),i("div",[i("br")]),i("div",[t._v('<div id="container"></div>')]),i("div",[i("br")]),i("div",[t._v('<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"><\/script>')]),i("div",[i("br")]),i("div",[t._v('<script type="text/javascript">')]),i("div",[i("br")]),i("div",[t._v("    function AjaxRequest() {")]),i("div",[t._v("        $.ajax({")]),i("div",[t._v("            //url: 'http://www.jxntv.cn/data/jmd-jxtv2.html?callback=list',")]),i("div",[t._v("            // 等同于")]),i("div",[t._v("            url: 'http://www.jxntv.cn/data/jmd-jxtv2.html',")]),i("div",[t._v("            type: 'GET',")]),i("div",[t._v("            dataType: 'jsonp',")]),i("div",[t._v("            jsonp: 'callback',")]),i("div",[t._v("            jsonpCallback: 'list',")]),i("div",[t._v("            success: function (data) {")]),i("div",[t._v("                $.each(data.data, function (i) {")]),i("div",[t._v("                    var item = data.data[i];")]),i("div",[t._v('                    var str = "<p>" + item.week + "</p>";')]),i("div",[t._v("                    $('#container').append(str);")]),i("div",[t._v("                    $.each(item.list, function (j) {")]),i("div",[t._v('                        var temp = "<a href=\'" + item.list[j].link + "\'>" + item.list[j].name + " </a><br/>";')]),i("div",[t._v("                        $('#container').append(temp);")]),i("div",[t._v("                    });")]),i("div",[t._v("                    $('#container').append(\"<hr/>\");")]),i("div",[t._v("                })")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("            }")]),i("div",[t._v("        });")]),i("div",[t._v("    }")]),i("div",[i("br")]),i("div",[t._v("<\/script>")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[i("span",{staticStyle:{"font-size":"21px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("CORS")])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("CORS的")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("简介")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("CORS需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10。")])]),i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[i("br")])],1),i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("整个CORS通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS通信与同源的AJAX通信没有差别，代码完全一样。浏览器一旦发现AJAX请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。")])]),i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[i("br")])],1),i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("因此，")]),i("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[t._v("实现CORS通信的关键是服务器。只要服务器实现了CORS接口，就可以跨源通信")]),i("span",{staticStyle:{"font-size":"12pt"}},[t._v("。")])]),i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[i("br")])],1),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" CORS的理解")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{color:"rgb(227, 0, 0)","font-weight":"bold"}},[t._v("本质")]),i("span",{staticStyle:{"font-weight":"bold"}},[t._v(":")]),t._v(" 设置响应头，使得浏览器允许跨域请求")])])]),i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[i("br")])],1),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("cors: 后端解决跨域问题")])])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("服务器告诉浏览器允许xxx网址进行跨域，不进行数据拦截")])])])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 简单请求 和 非简单请求")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i("br")])]),i("ul",[i("li",[i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[t._v("只有跨域了，才有简单请求和复杂请求这一说法")])],1)])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[t._v("简单请求的条件（同时满足以下两个条件时，则是简单请求）")])])]),i("div",[i("br")]),i("ul",[i("ul",[i("li",[i("div",[t._v("请求方式:")])]),i("ul",[i("li",[i("div",[t._v("HEAD")])]),i("li",[i("div",[t._v("GET")])]),i("li",[i("div",[t._v("POST")])])])])]),i("div",[i("br")]),i("ul",[i("ul",[i("li",[i("div",[t._v("请求头信息")])])])]),i("ol",[i("li",[i("div",[t._v("Accept")])]),i("li",[i("div",[t._v("Accept-Language")])]),i("li",[i("div",[t._v("Content-Language")])]),i("li",[i("div",[t._v("Last-Event-ID")])]),i("li",[i("div",[t._v("Content-Type 对应的值是以下三个中的任意一个")])])]),i("ul",[i("li",[i("div",[t._v("application/x-www-form-urlencoded")])]),i("li",[i("div",[t._v("multipart/form-data")])]),i("li",[i("div",[t._v("text/plain")])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("非简单请求")])])]),i("div",[i("br")]),i("ul",[i("ul",[i("li",[i("div",[t._v("只要不满足简单请求的两个条件都是非简单请求")])])])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 简单请求 和 非简单请求 的区别")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("简单请求：一次请求")])])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("非简单请求：两次请求，在发送数据之前会先发一次请求用于做“预检”，"),i("font",{staticStyle:{color:"rgb(255, 0, 0)"}},[t._v("只有“预检”通过后才再发送一次请求用于数据传输")])],1)])])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 关于预检")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("请求方式: ")]),t._v("OPTIONS")])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("预检其实就是做检查，检查如果通过则允许传输数据，检查不通过则不再发送真正想要发送的消息（即: 只有options请求通过了，才能发送真正的传递数据的请求）")])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("如何预检")])]),i("ul",[i("li",[i("div",[t._v("如果复杂请求是PUT等请求，则服务端需要设置允许某请求，否则“预检”不通过")])]),i("ul",[i("li",[i("div",[t._v("response['Access-Control-Allow-Methods'] = 'DELETE,PUT'")])])]),i("li",[i("div",[t._v("如果复杂请求设置了请求头，则服务端需要设置允许某请求头，否则“预检”不通过")])]),i("ul",[i("li",[i("div",[t._v("response['Access-Control-Allow-Headers'] = 'Content-Type'  ")])])])])]),i("div",[i("font",{staticStyle:{"font-size":"12pt"}},[i("br")])],1),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 简单请求 -> 支持跨域")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("把 csrf 中间件注释掉")])])])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[t._v("FBV")])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/FBV_simple_request.rar"}},[i("img",{attrs:{alt:"FBV_simple_request.rar",src:"/kevin-blog/Django/跨域_files/0c3d150359d76e9736d465793c901f4d.png"}})])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# area_b/views.py")])]),i("div",[i("br")]),i("div",[t._v("import json")]),i("div",[t._v("from django.shortcuts import render, HttpResponse")]),i("div",[t._v("from django.http import JsonResponse")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("def service_cors(request):")]),i("div",[t._v("    json_data = {")]),i("div",[t._v("        'area': 'area_b',")]),i("div",[t._v("        'name': 'Yeung'")]),i("div",[t._v("    }")]),i("div",[t._v("    response = HttpResponse(json.dumps(json_data))")]),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("#")]),t._v(" response[\"Access-Control-Allow-Origin\"] = 'http://127.0.0.1:8001'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 只允许 http://127.0.0.1:8001 进行跨域请求")])],1),i("div",[t._v("    response[\"Access-Control-Allow-Origin\"] = '*'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许所有网址进行跨域请求")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[t._v("    return response")])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("CBV")])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/CBV_simple_request.rar"}},[i("img",{attrs:{alt:"CBV_simple_request.rar",src:"/kevin-blog/Django/跨域_files/ceed8dcf2b32f9ee7bc81752d5ae9d94.png"}})])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# area_b/views.py")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[t._v("import json")]),i("div",[t._v("from django.shortcuts import render, HttpResponse")]),i("div",[t._v("from django.http import JsonResponse")]),i("div",[t._v("from django.views import View")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("class ServiceCors(View):")]),i("div",[t._v("    def get(self, request):")]),i("div",[t._v("        json_data = {")]),i("div",[t._v("            'area': 'area_b',")]),i("div",[t._v("            'name': 'Yeung'")]),i("div",[t._v("        }")]),i("div",[t._v("        response = HttpResponse(json.dumps(json_data))")]),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("#")]),t._v(" response[\"Access-Control-Allow-Origin\"] = 'http://127.0.0.1:8001'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 只允许 http://127.0.0.1:8001 进行跨域请求")])],1),i("div",[t._v("        response[\"Access-Control-Allow-Origin\"] = '*'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许所有网址进行跨域请求")])],1),i("div",[i("br")]),i("div",[t._v("        return response")])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("html 代码")])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/simple_request_html.rar"}},[i("img",{attrs:{alt:"simple_request_html.rar",src:"/kevin-blog/Django/跨域_files/9f2b899964d2c15ccbcd0a62713ad6c1.png"}})])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# area_a/cors.html")])],1),i("div",[i("br")]),i("div",[t._v('<button class="console_ajax">使用ajax获取area_b的数据</button>')]),i("div",[i("br")]),i("div",[t._v('<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"><\/script>')]),i("div",[i("br")]),i("div",[t._v('<script type="text/javascript">')]),i("div",[t._v("    $('.console_ajax').click(function () {")]),i("div",[t._v("        $.ajax({")]),i("div",[t._v('            url: "http://127.0.0.1:8002/area_b_service_cors/",')]),i("div",[t._v('            type: "get",')]),i("div",[t._v("            dataType: 'json',")]),i("div",[t._v("            success: function (res) {")]),i("div",[t._v("                console.log(res)")]),i("div",[t._v("            }")]),i("div",[t._v("        })")]),i("div",[t._v("    })")]),i("div",[t._v("<\/script>")])]),i("div",[i("br")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("5.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 非简单请求 -> 支持跨域")])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("把 csrf 中间件注释掉")])])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("FBV")])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/FBV_non-simple_request.rar"}},[i("img",{attrs:{alt:"FBV_non-simple_request.rar",src:"/kevin-blog/Django/跨域_files/5ab11a6bf1173f47f54c0e51b8459bcd.png"}})])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# area_b/views.py")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[t._v("import json")]),i("div",[t._v("from django.shortcuts import render, HttpResponse")]),i("div",[t._v("from django.http import JsonResponse")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("def service_cors(request):")]),i("div",[t._v("    json_data = {")]),i("div",[t._v("        'area': 'area_b',")]),i("div",[t._v("        'name': 'Yeung'")]),i("div",[t._v("    }")]),i("div",[t._v("    response = HttpResponse(json.dumps(json_data))")]),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("#")]),t._v(" response[\"Access-Control-Allow-Origin\"] = 'http://127.0.0.1:8001'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 只允许 http://127.0.0.1:8001 进行跨域请求")])],1),i("div",[t._v("    response['Access-Control-Allow-Origin'] = '*'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许所有网址进行跨域请求")])],1),i("div",[t._v("    response['Access-Control-Allow-Headers'] = 'Content-Type'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许携带的请求头，response['Access-Control-Allow-Headers'] = 'Content-Type,xx,xxx'")])],1),i("div",[t._v("    response['Access-Control-Allow-Methods'] = 'DELETE,PUT'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许发送的请求方式，这里不用添加 GET、POST 请求")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("#")]),t._v(" response['Access-Control-Max-Age'] = 10  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 本次预检请求的有效期，以秒为单位 -> 可以加和不加")])],1),i("div",[i("br")]),i("div",[t._v("    return response")])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("CBV")])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/CBV_non-simple_request.rar"}},[i("img",{attrs:{alt:"CBV_non-simple_request.rar",src:"/kevin-blog/Django/跨域_files/2b500f83d9e6326b44787aef5cbe5ec7.png"}})])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# area_b/views.py")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[t._v("import json")]),i("div",[t._v("from django.shortcuts import render, HttpResponse")]),i("div",[t._v("from django.http import JsonResponse")]),i("div",[t._v("from django.views import View")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("class ServiceCors(View):")]),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# 因为预检的请求方式是 options，所以要添加预检所需的视图类方法")])],1),i("div",[t._v("    def options(self, request, *args, **kwargs):")]),i("div",[t._v("        response = HttpResponse('')")]),i("div",[t._v("        response['Access-Control-Allow-Origin'] = '*'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许所有网址进行跨域请求")])],1),i("div",[t._v("        response['Access-Control-Allow-Headers'] = 'Content-Type'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许携带的请求头，response['Access-Control-Allow-Headers'] = 'Content-Type,xx,xxx'")])],1),i("div",[t._v("        response['Access-Control-Allow-Methods'] = 'DELETE,PUT'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许发送的请求方式，这里不用添加 GET、POST 请求")])],1),i("div",[t._v("        return response")]),i("div",[i("br")]),i("div",[t._v("    def put(self, request):")]),i("div",[t._v("        json_data = {")]),i("div",[t._v("            'area': 'area_b',")]),i("div",[t._v("            'name': 'Yeung'")]),i("div",[t._v("        }")]),i("div",[t._v("        response = HttpResponse(json.dumps(json_data))")]),i("div",[t._v("        response['Access-Control-Allow-Origin'] = '*'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许所有网址进行跨域请求")])],1),i("div",[t._v("        return response")])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("html 代码")])])]),i("div",[i("br")]),i("div",[i("a",{attrs:{href:"/kevin-blog/Django/跨域_files/non-simple_request_html.rar"}},[i("img",{attrs:{alt:"non-simple_request_html.rar",src:"/kevin-blog/Django/跨域_files/8e1c5cdf25447fa71d6b49517114d64a.png"}})])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# area_a/cors.html")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[t._v('<button class="console_ajax">使用ajax获取area_b的数据</button>')]),i("div",[i("br")]),i("div",[t._v('<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"><\/script>')]),i("div",[i("br")]),i("div",[t._v('<script type="text/javascript">')]),i("div",[t._v("    $('.console_ajax').click(function () {")]),i("div",[t._v("        $.ajax({")]),i("div",[t._v('            url: "http://127.0.0.1:8002/area_b_service_cors/",')]),i("div",[t._v('            type: "put",')]),i("div",[t._v("            contentType: 'application/json',")]),i("div",[t._v("            dataType: 'json',")]),i("div",[t._v('            data: \'{"username":"Kevin","password":"123"}\',')]),i("div",[t._v("            success: function (res) {")]),i("div",[t._v("                console.log(res)")]),i("div",[t._v("            }")]),i("div",[t._v("        })")]),i("div",[t._v("    })")]),i("div",[t._v("<\/script>")])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("6.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" CORS 中间件的应用")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[t._v("使用中间件代替在视图中设置响应头的代码")])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("粗暴版")])])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[t._v("# ")]),t._v("my_middleware.py")])],1),i("div",[i("br")]),i("div",[t._v("from django.utils.deprecation import MiddlewareMixin")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("class CORSMiddleware(MiddlewareMixin):")]),i("div",[i("br")]),i("div",[t._v("    def process_response(self, request, response):")]),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("#")]),t._v(" response[\"Access-Control-Allow-Origin\"] = 'http://127.0.0.1:8001'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 只允许 http://127.0.0.1:8001 进行跨域请求")])],1),i("div",[t._v("        response['Access-Control-Allow-Origin'] = '*'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许所有网址进行跨域请求")])],1),i("div",[t._v("        response['Access-Control-Allow-Headers'] = 'Content-Type'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许携带的请求头，response['Access-Control-Allow-Headers'] = 'Content-Type,xx,xxx'")])],1),i("div",[t._v("        response['Access-Control-Allow-Methods'] = 'DELETE,PUT'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许发送的请求方式，这里不用添加 GET、POST 请求")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("#")]),t._v(" response['Access-Control-Max-Age'] = 10  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 本次预检请求的有效期，以秒为单位 -> 可以加和不加")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[t._v("        return response")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# settings.py")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[t._v("MIDDLEWARE = [")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("……")])],1),i("div",[t._v("    'area_b.my_middleware.CORSMiddleware'")]),i("div",[t._v("]")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("优化版")])])])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# my_middleware.py")])],1),i("div",[i("br")]),i("div",[t._v("from django.utils.deprecation import MiddlewareMixin")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("class CORSMiddleware(MiddlewareMixin):")]),i("div",[i("br")]),i("div",[t._v("    def process_response(self, request, response):")]),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("#")]),t._v(" response[\"Access-Control-Allow-Origin\"] = 'http://127.0.0.1:8001'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 只允许 http://127.0.0.1:8001 进行跨域请求")])],1),i("div",[t._v("        response['Access-Control-Allow-Origin'] = '*'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许所有网址进行跨域请求")])],1),i("div",[i("br")]),i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# 处理预检请求")])],1),i("div",[t._v("        if request.method == 'OPTIONS':")]),i("div",[t._v("            response['Access-Control-Allow-Headers'] = 'Content-Type'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许携带的请求头，response['Access-Control-Allow-Headers'] = 'Content-Type,xx,xxx'")])],1),i("div",[t._v("            response['Access-Control-Allow-Methods'] = 'DELETE,PUT'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 允许发送的请求方式，这里不用添加 GET、POST 请求")])],1),i("div",[t._v("            # response['Access-Control-Max-Age'] = 10  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 本次预检请求的有效期，以秒为单位 -> 可以加和不加")])],1),i("div",[i("br")]),i("div",[t._v("        return response")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# settings.py")])]),i("div",[i("br")]),i("div",[t._v("MIDDLEWARE = [")]),i("div",[i("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("……")])]),i("div",[t._v("    'area_b.my_middleware.CORSMiddleware'")]),i("div",[t._v("]")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])])]),i("div",[i("br")])])])])}),[],!1,null,null,null);o.default=e.exports}}]);