(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{360:function(t,o,e){"use strict";e.r(o);var i=e(25),n=Object(i.a)({},(function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("div",[e("span",[e("div",[e("div",[e("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[e("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("引子")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[t._v("需求: 多个课程表都需要关联到价格表")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 设计方式一")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("b",[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django ORM/ORM-ContentType_files/Image.png",type:"image/png"}})])])]),e("div",[e("font",{staticStyle:{"font-size":"14pt"}},[e("br")])],1),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 设计方式二")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("b",[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django ORM/ORM-ContentType_files/Image [1].png",type:"image/png"}})])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("b",[e("br")])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 设计方式三（最终的设计模式）")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("b",[e("br")])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("b",[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django ORM/ORM-ContentType_files/Image [2].png",type:"image/png"}})])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("b",[e("br")])])]),e("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","font-weight":"bold","line-height":"1.5","background-color":"#3eaf7c","border-radius":"3px","text-align":"center",color:"white","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-ligatures":"normal","font-variant-caps":"normal","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[e("span",{staticStyle:{"font-size":"21px","font-weight":"bold","line-height":"1.5","background-color":"#3eaf7c","border-radius":"3px",color:"white","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-ligatures":"normal","font-variant-caps":"normal","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t._v("ContentType")])]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 什么时候使用 ContentType")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("br")])]),e("ul",[e("li",[e("div",[e("font",{staticStyle:{"font-size":"12pt"}},[t._v("当一张表需要和多张表建立外键关系的时候")])],1)])]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" ContentType 的说明")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("br")])]),e("ul",[e("li",[e("div",[e("font",{staticStyle:{"font-size":"12pt"}},[t._v("ContentType 的设计模式实际上就是引子中的设计方式三")])],1)])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[t._v("ContentType 所使用的表名表就是在执行 ")]),t._v("migrate 后自动创建 django_content_type 表（存放着都是表名，当有新的表被创建时，会自动添加表名数据）")])])]),e("div",[e("br")]),e("div",[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django ORM/ORM-ContentType_files/Image [3].png",type:"image/png"}})]),e("div",[e("br")]),e("div",[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django ORM/ORM-ContentType_files/Image [4].png",type:"image/png"}})]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" ContentType 的使用")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("br")])]),e("ul",[e("li",[e("div",[t._v("表的创建")])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[t._v("content_type、 object_id、 content_object 字段属性名是固定写法不能随意改变")])])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("# models.py")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[t._v("from django.db import models")]),e("div",[t._v("from django.contrib.contenttypes.models import "),e("font",{attrs:{color:"#FA7A00"}},[t._v("ContentType  ")]),e("font",{attrs:{color:"#41AD1C"}},[t._v("# 导入 ContentType 表（即: django_content_type）")])],1),e("div",[t._v("from django.contrib.contenttypes.fields import "),e("font",{attrs:{color:"#FA7A00"}},[t._v("GenericForeignKey")]),t._v(", "),e("font",{staticStyle:{color:"rgb(250, 122, 0)"}},[t._v("GenericRelation")])],1),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("class VIPCourse(models.Model):")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v(' """')])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("    VIP课程")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v('    """')])],1),e("div",[t._v("    title = models.CharField(max_length=32, verbose_name='VIP课程名称')")]),e("div",[e("br")]),e("div",[t._v("    coupon_policy = GenericRelation('Coupon')  "),e("font",{attrs:{color:"#FA7A00"}},[t._v("# 不会在数据库中生产字段，只用于反向查询数据，传入使用了 ContentType 的表名")])],1),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("class BasisCourse(models.Model):")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v('"""')])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("    基础课程")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v('    """')])],1),e("div",[t._v("    title = models.CharField(max_length=32, verbose_name='基础课程名称')")]),e("div",[e("br")]),e("div",[t._v("    coupon_policy = GenericRelation('Coupon')  "),e("font",{attrs:{color:"#FA7A00"}},[t._v("# 不会在数据库中生产字段，只用于反向查询数据，传入使用了 ContentType 的表名")])],1),e("div",[e("br")]),e("div",[e("br")]),e("div",[t._v("class Coupon(models.Model):")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v(' """')])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("    优惠券")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v('    """')])],1),e("div",[t._v("    content_type = models.ForeignKey(ContentType) "),e("font",{attrs:{color:"#FA7A00"}},[t._v(" # 关联表名表（即: django_content_type），content_type 是固定字段属性名，不能随意改变")])],1),e("div",[t._v("    object_id = models.PositiveIntegerField()  "),e("font",{attrs:{color:"#FA7A00"}},[t._v("# 正整数类型，存放需要关联的课程 id，object_id 是固定字段属性名，不能随意改变")])],1),e("div",[t._v("    content_object = GenericForeignKey('content_type', 'object_id')  "),e("font",{attrs:{color:"#FA7A00"}},[t._v("# 不会在数据库中生产字段，只用于添加数据和正向查询数据，content_object 是固定字段属性名，不能随意改变")])],1),e("div",[e("br")]),e("div",[t._v("    title = models.CharField(max_length=32, verbose_name='优惠券名称')")])]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 添加数据")])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[t._v("方式一")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[t._v("from django.contrib.contenttypes.models import ContentType  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# 导入 ContentType 表（即: django_content_type）")])],1),e("div",[t._v("from app01.models import *")]),e("div",[e("br")]),e("div",[t._v("Coupon.objects.create(")]),e("div",[t._v("    title='vip课程优惠券一',")]),e("div",[t._v("    content_type=ContentType.objects.filter(model='vipcourse').first(), "),e("font",{attrs:{color:"#41AD1C"}},[t._v(" # 查询到的ContentType表名数据对象")])],1),e("div",[t._v("    object_id=1  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# 课程id")])],1),e("div",[t._v(")")]),e("div",[e("br")]),e("div",[t._v("Coupon.objects.create(")]),e("div",[t._v("    title='基础课程优惠券一',")]),e("div",[t._v("    content_type=ContentType.objects.filter(model='basiscourse').first(),  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# 查询到的ContentType表名数据对象")])],1),e("div",[t._v("    object_id=2  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# 课程id")])],1),e("div",[t._v(")")])]),e("div",[e("br")])]),e("ul",[e("li",[e("div",[t._v("方式二 -> 通过 GenericForeignKey 表类方法所创建 content_object 字段进行添加 -> "),e("font",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("推荐使用")])],1)])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[t._v("语法: content_object = 查询到的数据对象")])])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[t._v("原理: 因为可以通过查询的对象获取当前数据的id和表名，然后 ContentType 组件帮你进行添加")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[t._v("from django.contrib.contenttypes.models import ContentType  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# 导入 ContentType 表（即: django_content_type）")])],1),e("div",[t._v("from app01.models import *")]),e("div",[e("br")]),e("div",[t._v("Coupon.objects.create(")]),e("div",[t._v("    title='vip课程优惠券一',")]),e("div",[e("font",{attrs:{color:"#FA7A00"}},[t._v("content_object")]),t._v("=VIPCourse.objects.filter(pk=2).first()  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# 通过 GenericForeignKey 表类方法所创建 content_object 字段进行添加，传入查询到的数据对象")])],1),e("div",[t._v(")")])]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 正向查询")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("br")])]),e("ul",[e("li",[e("div",[e("font",{staticStyle:{"font-size":"12pt"}},[t._v("通过定义了相关ContentType字段属性表的数据，查询出与该条数据相关的表的数据")])],1)])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[t._v("通过 GenericForeignKey 表类方法所创建 content_object 字段进行正向查询")])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("# 通过优惠券表的数据查询出与该优惠券数据相关的课程数据")])],1),e("div",[e("br")]),e("div",[t._v("from app01.models import *")]),e("div",[e("br")]),e("div",[t._v("coupon_obj = Coupon.objects.filter(pk=5).first()")]),e("div",[e("br")]),e("div",[t._v("course_obj = coupon_obj."),e("font",{attrs:{color:"#FA7A00"}},[t._v("content_object  ")]),e("font",{attrs:{color:"#41AD1C"}},[t._v("# VIPCourse object")])],1),e("div",[t._v("course_title = coupon_obj."),e("font",{attrs:{color:"#FA7A00"}},[t._v("content_object")]),t._v(".title  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# Vue项目课程")])],1)]),e("div",[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("5.")]),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 反向查询")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[e("br")])]),e("ul",[e("li",[e("div",[t._v("通过数据对象查询出与该数据对象相关的所有"),e("span",{staticStyle:{"font-size":"12pt"}},[t._v("定义了相关ContentType字段属性表的数据")])])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[t._v("通过 GenericRelation 表类方法所创建字段进行反向查询")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[t._v("# 通过课程数据查询出该课程的所有优惠券数据")])],1),e("div",[e("br")]),e("div",[t._v("from app01.models import *")]),e("div",[e("br")]),e("div",[t._v("vip_course_obj = VIPCourse.objects.filter(pk=2).first()")]),e("div",[e("br")]),e("div",[t._v("coupon_list = vip_course_obj."),e("font",{attrs:{color:"#FA7A00"}},[t._v("coupon_policy")]),t._v(".all()  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# <QuerySet [<Coupon: Coupon object>, <Coupon: Coupon object>, <Coupon: Coupon object>]>")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[t._v("for coupon in coupon_list:")]),e("div",[t._v("    print(coupon.title)  "),e("font",{attrs:{color:"#41AD1C"}},[t._v("# vip课程优惠券一")])],1)]),e("div",[e("br")])])])])])}),[],!1,null,null,null);o.default=n.exports}}]);