(window.webpackJsonp=window.webpackJsonp||[]).push([[198],{551:function(o,r,e){"use strict";e.r(r);var t=e(25),i=Object(t.a)({},(function(){var o=this,r=o.$createElement,e=o._self._c||r;return e("ContentSlotsDistributor",{attrs:{"slot-key":o.$parent.slotKey}},[e("div",[e("span",[e("div",[e("div",[e("div",[e("div",[e("div",[e("div",[e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[o._v("在日常开发中不会直接使用ORM框架，一般会在使用Django的时候使用Django自身的ORM框架，这里的只对ORM框架中SQLAchemy做了解就可以了，因为SQLAchemy的用法和Django中的ORM框架很类似")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"18.6667px"}},[e("span",{staticStyle:{"font-size":"18.6667px",color:"rgb(227, 0, 0)","font-weight":"bold"}},[o._v("在 ORM 框架中 一个类就是一张表，一个属性代表一个字段，一个对象就是一行数据")])])]),e("div",[e("span",{staticStyle:{"font-size":"18.6667px"}},[e("span",{staticStyle:{"font-size":"18.6667px"}},[e("br")])])]),e("div",[e("span",{staticStyle:{"font-size":"18.6667px"}},[o._v("ORM 框架有两类：")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[o._v("db first -> 先创建数据库和表，通过代码自动生成类和对象")])])]),e("li",[e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[o._v("code first -> 手动编写类和对象，然后通过类和对象生成表和数据")])])]),e("li",[e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[o._v("SQLAchemy 属于 code first 这一类，而 ")]),e("span",{staticStyle:{"font-size":"14pt"}},[o._v("Django 这两类都支持")])])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("1.")]),o._v(" "),e("font",{staticStyle:{"font-size":"14pt"}},[e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("sqlalchemy的安装")])])],1),e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("pip3 install sqlalchemy -i https://pypi.douban.com/simple "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用豆瓣的镜像")])],1)]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("2.")]),o._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("pymysql的安装")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("pip3 install pymysql -i https://pypi.douban.com/simple "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用豆瓣的镜像")])],1)]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("3.")]),o._v(" "),e("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[o._v("注意: ")]),e("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[o._v("SQLAchemy本身是无法操作数据库（因为")]),e("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[o._v("SQLAchemy本身只负责将代码转换为SQL语句")]),e("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[o._v("），必须使用 DBAPI（即: 第三方的操作数据库的模块，如：pymysql，mysqldb，……）来进行数据库的操作，")]),e("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[o._v("所以在使用")]),e("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[o._v("SQLAchemy前一定要下载")]),e("span",{staticStyle:{"font-size":"14pt",color:"rgb(227, 0, 0)","font-weight":"bold"}},[o._v("第三方的操作数据库的模块")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",[e("font",{attrs:{color:"#41AD1C"}},[e("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[o._v("# 根据配置文件的不同，调用不同的DBAPI，从而实现 ")]),o._v("sqlalchemy 对数据库的操作，（在操作数据库的时候，就要使用对应的第三方模块去操作数据库，而 SQLAchemy 想去使用这些模块就要进行相关的配置）如：")])],1)],1),e("div",[e("font",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1)],1),e("div",[e("font",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# mysql 数据库")])],1)],1),e("div",[e("font",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1)],1),e("div",[e("font",[e("font",{attrs:{color:"#41AD1C"}},[o._v("    # pymysql 模块")])],1)],1),e("div",[e("font",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1)],1),e("div",[e("font",[e("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),e("font",{staticStyle:{color:"rgb(0, 0, 0)"}},[o._v("mysql+pymysql://")]),e("font",{attrs:{color:"#DE5700"}},[e("font",[o._v("数据库")]),o._v("用户名")],1),e("font",{attrs:{color:"#000000"}},[o._v(":")]),e("font",{attrs:{color:"#DE5700"}},[o._v("密码，如果没有密码可以空着不填")]),e("font",{attrs:{color:"#000000"}},[o._v("@")]),e("font",{attrs:{color:"#DE5700"}},[o._v("ip地址")]),e("font",{attrs:{color:"#000000"}},[o._v(":")]),e("font",{attrs:{color:"#DE5700"}},[o._v("端口号")]),e("font",{attrs:{color:"#000000"}},[o._v("/")]),e("font",{attrs:{color:"#DE5700"}},[o._v("数据库名称")]),e("font",{attrs:{color:"#000000"}},[o._v("?")])],1),e("font",{attrs:{color:"#000000"}},[o._v("charset=utf8")])],1),e("div",[e("font",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1)],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("font",[o._v("    # ")]),o._v("mysqldb 模块")],1)],1),e("div",[e("font",[e("font",{attrs:{color:"#41AD1C"}})],1)],1),e("div",[o._v("    mysql+mysqldb://"),e("font",{attrs:{color:"#DE5700"}},[o._v("数据库用户名")]),o._v(":"),e("font",{attrs:{color:"#DE5700"}},[o._v("密码，如果没有密码可以空着不填")]),o._v("@"),e("font",{attrs:{color:"#DE5700"}},[o._v("ip地址")]),o._v(":"),e("font",{attrs:{color:"#DE5700"}},[o._v("端口号")]),o._v("/"),e("font",{attrs:{color:"#DE5700"}},[o._v("数据库名称")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# mysqlconnector 模块")])],1),e("div"),e("div",[o._v("    mysql+mysqlconnector://"),e("font",{attrs:{color:"#DE5700"}},[o._v("数据库用户名")]),o._v(":"),e("font",{attrs:{color:"#DE5700"}},[o._v("密码，如果没有密码可以空着不填")]),o._v("@"),e("font",{attrs:{color:"#DE5700"}},[o._v("ip地址")]),o._v(":"),e("font",{attrs:{color:"#DE5700"}},[o._v("端口号")]),o._v("/"),e("font",{attrs:{color:"#DE5700"}},[o._v("数据库名称")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# oracle 数据库")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("    # cx_oracle 模块")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}}),o._v("oracle+cx_oracle://"),e("font",{attrs:{color:"#DE5700"}},[o._v("数据库用户名")]),o._v(":"),e("font",{attrs:{color:"#DE5700"}},[o._v("密码，如果没有密码可以空着不填")]),o._v("@"),e("font",{attrs:{color:"#DE5700"}},[o._v("ip地址")]),o._v(":"),e("font",{attrs:{color:"#DE5700"}},[o._v("端口号")]),o._v("/"),e("font",{attrs:{color:"#DE5700"}},[o._v("数据库名称")]),o._v("?key=value&key=value...")],1)]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("4.")]),o._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("创建表 和 删除表")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("from sqlalchemy.ext.declarative import declarative_base")]),e("div",[o._v("from sqlalchemy.orm import sessionmaker, relationship")]),e("div",[o._v("from sqlalchemy import create_engine")]),e("div",[o._v("from sqlalchemy import Column, Integer, String, ForeignKey, UniqueConstraint, Index, CHAR, VARCHAR")]),e("div",[e("br")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("'''")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("    Column -> 创建字段的方法")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("    Integer -> 整型")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("    String -> 字符串类型，包含了 char 和 varchar")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("    ForeignKey -> 外键")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("    UniqueConstraint -> 联合唯一索引")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("    Index -> 联合普通索引")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("    CHAR -> char")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("    VARCHAR -> varchar")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("'''")])],1),e("div",[e("br")]),e("div",[o._v("Base = declarative_base()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 创建一个 Base 对象")])],1),e("div",[e("br")]),e("div",[e("br")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("#  Users 表的类")])],1),e("div",[o._v("class Users(Base):  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 创建表的类一定要继承 Base")])],1),e("div",[o._v("    __tablename__ = 'users'  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 表名")])],1),e("div",[o._v("    id = Column(Integer, primary_key=True, autoincrement=True)  "),e("font",{attrs:{color:"#E30000"}},[o._v("# 整型 设置主键 设置自增列")])],1),e("div",[o._v("    name = Column(VARCHAR(32), nullable=True, index=True)  "),e("font",{attrs:{color:"#E30000"}},[o._v("# varchar类型 允许为空 将name字段设置为索引")])],1),e("div",[o._v("    email = Column(String(32), unique=True) "),e("font",{attrs:{color:"#E30000"}},[o._v(" # varchar类型 或 char类型 将email字段设置为唯一索引")])],1),e("div",[o._v("    uid = Column(Integer)")]),e("div",[o._v("    tid = Column(Integer)")]),e("div",[o._v("    user_type_id = Column(Integer, ForeignKey('usertype.id'))  "),e("font",{attrs:{color:"#E30000"}},[o._v("# 创建外键")])],1),e("div",[e("br")]),e("div",[e("br")]),e("div",[o._v("    __table_args__ = (")]),e("div",[o._v("        UniqueConstraint('uid', 'name', name='uix_uid_name'), "),e("font",{attrs:{color:"#41AD1C"}}),e("font",{attrs:{color:"#E30000"}},[o._v("# 创建一个名为 uix_uid_name 的联合唯一索引")])],1),e("div",[o._v("        Index('index_name', 'name', 'email')  "),e("font",{attrs:{color:"#E30000"}},[o._v("# 创建一个名为 index_name 的普通联合索引")])],1),e("div",[o._v("    )")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# UserType 表的类")])],1),e("div",[o._v("class UserType(Base):")]),e("div",[o._v("    __tablename__ = 'usertype'")]),e("div",[o._v("    id = Column(Integer, primary_key=True, autoincrement=True)")]),e("div",[o._v("    title = Column(VARCHAR(32), nullable=True, index=True)")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# 创建表")])],1),e("div",[o._v("def create_table():")]),e("div",[o._v('    engine = create_engine("mysql+pymysql://root:@127.0.0.1:3306/db1?charset=utf8", max_overflow=5)  '),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 通过使用第三方模块去操作数据库，且最大链接数为5")])],1),e("div",[o._v("    Base.metadata.create_all(engine)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 找到所有继承了 Base 的类，将这些类转换成SQL语句，然后通过第三方模块pymysql执行SQL语句创建表")])],1),e("div",[e("br")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# 删除表")])],1),e("div",[o._v("def drop_table():")]),e("div",[o._v('    engine = create_engine("mysql+pymysql://root:@127.0.0.1:3306/db1?charset=utf8", max_overflow=5) '),e("font",{attrs:{color:"#41AD1C"}},[o._v(" # 通过使用第三方模块去操作数据库，且最大链接数为5")])],1),e("div",[o._v("    Base.metadata.drop_all(engine)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 找到所有继承了 Base 的类，将这些类转换成SQL语句，然后通过第三方模块pymysql执行SQL语句删除表")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# create_table")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# drop_table()")])],1)]),e("div",[e("br")]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("5.")]),o._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("操作表的固定结构")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("from sqlalchemy.ext.declarative import declarative_base")]),e("div",[o._v("from sqlalchemy.orm import sessionmaker, relationship, aliased")]),e("div",[o._v("from sqlalchemy import create_engine")]),e("div",[o._v("from sqlalchemy import and_, or_")]),e("div",[o._v("from sqlalchemy import Column, Integer, String, ForeignKey, UniqueConstraint, Index, CHAR, VARCHAR")]),e("div",[e("br")]),e("div",[o._v("Base = declarative_base()")]),e("div",[e("font",{attrs:{color:"#DE5700"}},[e("br")])],1),e("div",[e("font",{attrs:{color:"#FA7A00"}},[o._v("# 创建表 - start")])],1),e("div",[o._v("class Users(Base):")]),e("div",[o._v("    __tablename__ = 'users'")]),e("div",[o._v("    id = Column(Integer, primary_key=True, autoincrement=True)")]),e("div",[o._v("    name = Column(VARCHAR(32), index=True)")]),e("div",[o._v("    age = Column(Integer)")]),e("div",[o._v("    address = Column(VARCHAR(32))")]),e("div",[o._v("    utid = Column(Integer, ForeignKey('usertype.id'))")]),e("div",[e("br")]),e("div",[o._v("    user_type = relationship('UserType', backref='xxoo')")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[o._v("class UserType(Base):")]),e("div",[o._v("    __tablename__ = 'usertype'")]),e("div",[o._v("    id = Column(Integer, primary_key=True, autoincrement=True)")]),e("div",[o._v("    title = Column(VARCHAR(32))")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[o._v("class Score(Base):")]),e("div",[o._v("    __tablename__ = 'score'")]),e("div",[o._v("    sid = Column(Integer, primary_key=True, autoincrement=True)")]),e("div",[o._v("    student_id = Column(Integer)")]),e("div",[o._v("    course_id = Column(Integer)")]),e("div",[o._v("    num = Column(Integer)")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[o._v('engine = create_engine("mysql+pymysql://root:@127.0.0.1:3306/db1?charset=utf8", max_overflow=5)')]),e("div",[e("br")]),e("div",[e("br")]),e("div",[o._v("def create_db():")]),e("div",[o._v("    Base.metadata.create_all(engine)")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[o._v("def drop_table():")]),e("div",[o._v("    Base.metadata.drop_all(engine)")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[e("font",{attrs:{color:"#000000"}},[o._v("# create_db()")])],1),e("div",[e("font",{attrs:{color:"#FA7A00"}},[o._v("# 创建表 - end")])],1),e("div",[e("br")]),e("div",[e("font",{attrs:{color:"#FA7A00"}},[o._v("# 操作表 - start")])],1),e("div",[o._v("Session = sessionmaker(bind=engine)")]),e("div",[o._v("session = Session() "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# sessoin 取一条连接对表进行操作")])],1),e("div",[e("br")]),e("div",[e("br")]),e("div",[e("b",[e("font",{attrs:{color:"#AD0000"}},[o._v("# 在这里编写对表中数据的增删改查")])],1)]),e("div",[e("br")]),e("div",[e("font",{attrs:{color:"#E30000"}},[o._v("# 例如: 添加一条数据")])],1),e("div",[o._v("data_obj1 = Users(name='Aimer', age=25, address='南城', utid=1)")]),e("div",[o._v("session.add(data_obj1)")]),e("div",[e("br")]),e("div",[e("br")]),e("div",[o._v("session.commit()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 和 pymysql 中的 commit 一样，如果不懂就看回 pymysql 中的 commit")])],1),e("div",[o._v("session.close() "),e("font",{attrs:{color:"#41AD1C"}},[o._v(" # 关闭连接")])],1),e("div",[e("font",{attrs:{color:"#FA7A00"}},[o._v("# 操作表 - end")])],1)]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Python/ORM框架 - SQLAchemy 模块_files/Image.png",type:"image/png"}})])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Python/ORM框架 - SQLAchemy 模块_files/Image [1].png",type:"image/png"}})])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Python/ORM框架 - SQLAchemy 模块_files/Image [2].png",type:"image/png"}})])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("6.")]),o._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("添加数据")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[o._v("添加一条数据")])])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# 表的类名(字段名='数据')")])],1),e("div",[e("br")]),e("div",[o._v("data_obj1 = Users(name='Aimer', age=25, address='南城', utid=1)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 创建一个对象，该对象就代表着一条数据  # ")]),e("font",{attrs:{color:"#41AD1C"}},[o._v("insert into users(name,age,address,utid) values('Kevin',18,'横沥',3)")])],1),e("div",[o._v("session.add(data_obj1)")])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("批量添加数据")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("data_objs = [")]),e("div",[o._v("    Users(name='Kevin', age=18, address='横沥', utid=3),")]),e("div",[o._v("    Users(name='Yeung', age=23, address='横沥', utid=3),")]),e("div",[o._v("    Users(name='Aimer', age=25, address='南城', utid=1),")]),e("div",[o._v("    Users(name='Timmy', age=25, address='万江', utid=2),")]),e("div",[o._v("    Users(name='Jack', age=30, address='石排', utid=1),")]),e("div",[o._v("]")]),e("div",[o._v("session.add_all(data_objs)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# insert into users(name,age,address,utid) values('Kevin',18,'横沥',3), ('Yeung',23,'横沥',3), ……")])],1)]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("7.")]),o._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("查询数据")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[o._v("获取查询到的数据")])])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[o._v(".all() -> 获取查询到的所有数据")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("ret = session.query(Users.name, Users.address).all()")]),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Kevin', '横沥'), ('Yeung', '横沥'), ……]")])],1)]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[o._v(".first() -> 获取查询到的所有数据的第一条数据")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("ret = session.query(Users.name, Users.address).first()")]),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# ('Kevin', '横沥')")])],1)]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[o._v("在查询数据的时候如果不加 .all() 或 .first() 会返回一个迭代器，直接循环迭代器获取查询到数据")])])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("ret = session.query(Users.name, Users.address)")]),e("div",[o._v("for row in ret:")]),e("div",[o._v("    print(row)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# ('Kevin', '横沥')")])],1),e("div",[o._v("    print(row[0])  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# Kevin")])],1),e("div",[o._v("    print(row.name)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# Kevin")])],1)]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[o._v("注意: 在查询数据的时候如果不加 .all() 或 .first() 打印会返回一条 SQL 语句")])])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{staticStyle:{"font-size":"9pt"}},[o._v("ret = session.query(Users)")])],1),e("div",[e("font",{staticStyle:{"font-size":"9pt"}},[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# select id, name from users;")])],1)],1)]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[o._v("查询该表的所有数据 -> 相当于 select * from 表名; -> "),e("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[o._v("不建议使用")])])])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[e("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[o._v("注意: 如果直接传入一个类名查询该表的所有字段的数据，那么返回值是一个对象列表，需要循环该对象列表获取该表所需要字段的数据")])])])])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# session.query(表的类名).all()")])],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users).all()  "),e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 将表的类名传入到 query 中，就可以查询到该表的所有数据")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [<__main__.Users object at 0x00000281308CE898>, ……]")])],1),e("div",[o._v("for row in ret:")]),e("div",[o._v("    print(row.name, row.age, row.address)")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])])]),e("ul",[e("li",[e("div",[o._v("查询某几列的数据 -> 相当于 select 字段名,字段名 from 表名;")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# session.query(表的类名.字段名, 表的类名.字段名, ……).all()")])],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).all()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# select name,address from users;")])],1),e("div",[o._v("print(ret)  "),e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# [('Kevin', '横沥'), ('Yeung', '横沥'), ……]")])],1)]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("给表起别名")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# 导入 aliased")])],1),e("div",[e("br")]),e("div",[o._v("from sqlalchemy.orm import aliased")])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# aliased(表的类名, name='别名')")])],1),e("div",[e("br")]),e("div",[o._v("users_alias = aliased(Users, name='users_alias')")]),e("div",[e("br")]),e("div",[o._v("ret = session.query(users_alias.name, users_alias.address).all()")]),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Kevin', '横沥'), ('Yeung', '横沥'), ……]")])],1)]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("条件查询 -> filter")])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[o._v("filter 在进行比较的时候直接使用 表的类名.字段名 == 'xxx'")])])])]),e("div",[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# .filter(表的类名.字段名 ==/>/</>=/<= 'xxx')")])],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter(Users.id > 3).all()  "),e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users where id > 3;")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Timmy', '万江'), ('Jack', '石排')]")])],1)]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("font",[o._v("# .filter(表的类名.字段名 ")]),o._v("==/>/</>=/<= "),e("font",[o._v("'xxx')")])],1)],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter(Users.id == 3).all()  "),e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users where id = 3;")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Aimer', '南城')]")])],1)]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# .filter(表的类名.字段名 == 'xxx', 表的类名.字段名 > 'xxx', 表的类名.字段名 < 'xxx', ……)")])],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter(Users.id >= 3, Users.id <= 5, Users.age == 25).all()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# select name,address from users where id >= 3 and id <= 5 and age = 25;")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Aimer', '南城'), ('Timmy', '万江')]")])],1)]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("条件查询 -> filter_by")])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[e("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[o._v("注意: filter_by 只能进行 = 的条件查询，不能进行其他的条件查询，如: > <")])])]),e("li",[e("div",[o._v("filter_by 在进行比较的时候直接使用 字段名 = 'xxx'")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# .filter_by(字段名='xxx')")])],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter_by(id=3).all()  "),e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users where id = 3; ")])],1),e("div",[o._v("print(ret) "),e("font",{attrs:{color:"#41AD1C"}},[o._v(" # [('Aimer', '南城')]")])],1)]),e("div",[e("br")])]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# .filter_by(字段名='xxx', 字段名='xxx', ……)")])]),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter_by(id=1, name='Kevin').all()  "),e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users where id = 1 and name = 'Kevin';")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Kevin', '横沥')]")])],1)]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("or_ 和 and_")])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("注意: filter 和 filter_by 默认使用 and 进行条件查询，如果要使用 or 就要将 or_ 导入进来，且 filter_by 不能使用 or_ 和 and_")])])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[e("font",{attrs:{color:"#41AD1C"}},[o._v("# 导入 or_ 和 and_")])],1)]),e("div",[e("br")]),e("div",[o._v("from sqlalchemy import or_, and_")])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# or_(表的类名.字段名 == 'xxx', 表的类名.字段名 > 'xxx', 表的类名.字段名 < 'xxx', ……)")])],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter(or_(Users.id == 5, Users.id == 6)).all() "),e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v(" # select name,address from users where id = 5 or id = 6;")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Jack', '石排')]")])],1)]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# and_(表的类名.字段名 == 'xxx', 表的类名.字段名 > 'xxx', 表的类名.字段名 < 'xxx', ……)")])],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter(and_(Users.id == 1, Users.name == 'Kevin')).all()  "),e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users where id = 1 and name = 'Kevin';")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Kevin', '横沥')]")])],1)]),e("div",[e("br")])]),e("ul",[e("li",[e("div",[o._v("between")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco",color:"rgb(65, 173, 28)"}},[o._v("# .between(num, num)")])]),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter(Users.id.between(1, 3)).all()  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users where id between 1 and 3;")])]),e("div",[o._v("print(ret)  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# [('Kevin', '横沥'), ('Yeung', '横沥'), ('Aimer', '南城')]")])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("in_")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# .in_([xx, xx, xx, ……])")])]),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter(Users.id.in_([1, 3])).all()  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users where id in(1,3);")])]),e("div",[o._v("print(ret) "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v(" # ")]),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("[('Kevin', '横沥'), ('Aimer', '南城')]")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# ~表的类名.字段名.in_([xx, xx, xx, ……]) ")]),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("等于 not in")])]),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter(~Users.id.in_([1, 3])).all()  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users where id not in(1,3);")])]),e("div",[o._v("print(ret)  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# [('Yeung', '横沥'), ('Timmy', '万江'), ('Jack', '石排')]")])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("模糊查询")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco",color:"rgb(65, 173, 28)"}},[o._v("# .like('%xxx%')")])]),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter(Users.name.like('%e%')).all()  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users where name like '%e%';")])]),e("div",[o._v("print(ret) "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v(" # [('Kevin', '横沥'), ('Yeung', '横沥'), ('Aimer', '南城')]")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# ~表的类名.字段名.like('%xxx%') 等于 not like")])]),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address).filter(~Users.name.like('%e%')).all()  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users where name not like '%e%';")])]),e("div",[o._v("print(ret) "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v(" # [('Timmy', '万江'), ('Jack', '石排')]")])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("分页")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 直接在查询到的数据后面进行切片")])]),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address)[0:2]  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select name,address from users limit 0,2")])]),e("div",[o._v("print(ret)  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# [('Kevin', '横沥'), ('Yeung', '横沥')]")])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("排序")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("ret = session.query(Users.id, Users.name, Users.age).order_by(Users.age.desc()).all()  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select id,name,age from users order by age desc;")])]),e("div",[o._v("print(ret)  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# [(5, 'Jack', 30), (3, 'Aimer', 25), (4, 'Timmy', 25), (2, 'Yeung', 23), (1, 'Kevin', 18)]")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 对相同数据的进行二次排序")])]),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.id, Users.name, Users.age).order_by(Users.age.desc(), Users.id.desc()).all()  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# select id,name,age from users order by age desc, id desc;")])]),e("div",[o._v("print(ret)  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# [(5, 'Jack', 30), (4, 'Timmy', 25), (3, 'Aimer', 25), (2, 'Yeung', 23), (1, 'Kevin', 18)]")])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("聚合函数")])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[o._v("通过 func 使用聚合函数")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 导入 func")])]),e("div",[e("br")]),e("div",[o._v("from sqlalchemy.sql import func")])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("ret = session.query(")]),e("div",[o._v("    func.max(Users.age),")]),e("div",[o._v("    func.min(Users.age),")]),e("div",[o._v("    func.count(Users.id),")]),e("div",[o._v("    func.sum(Users.age),")]),e("div",[o._v("    func.avg(Users.age)")]),e("div",[o._v(").all()")]),e("div",[e("br")]),e("div",[o._v("print(ret)  "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# [(30, 18, 5, Decimal('121'), Decimal('24.2000'))]")])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("分组")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 导入 func，使用聚合函数")])]),e("div",[e("br")]),e("div",[o._v("from sqlalchemy.sql import func")])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("ret = session.query(")]),e("div",[o._v("    Users.age,")]),e("div",[o._v("    func.count(Users.age)")]),e("div",[o._v(").group_by(Users.age).all()")]),e("div",[e("br")]),e("div",[o._v("print(ret) "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v(" # [(18, 1), (23, 1), (25, 2), (30, 1)]")])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[o._v("having（）")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("ret = session.query(")]),e("div",[o._v("    Users.age,")]),e("div",[o._v("    func.count(Users.age)")]),e("div",[o._v(").group_by(Users.age).having(func.count(Users.age) >= 2).all()")]),e("div",[e("br")]),e("div",[o._v("print(ret) "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v(" # [(25, 2)]")])])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("连表")])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[o._v("方法一")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("ret = session.query(Users.name, Users.age, UserType.title).filter(Users.utid == UserType.id).all()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# select users.name, users.age, usertype.title from users, usertype where users.utid = usertype.id;")])],1),e("div",[o._v("print(ret) "),e("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# [('Aimer', 25, '超级会员'), ('Jack', 30, '超级会员'), ('Timmy', 25, '白金会员'), ('Kevin', 18, '黑金会员'), ('Yeung', 23, '黑金会员')]")])])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[o._v("方法二 -> .join() -> 在默认情况下 .join() 会使用 inner join 进行连表查询")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# 如果不加条件进行连表 .join() 会默认使用外键进行判断连表")])],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address, UserType.title).join(UserType).all()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# select users.name, users.address, usertype.title from users inner join usertype on users.utid = usertype.id;")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Aimer', '南城', '超级会员'), ('Jack', '石排', '超级会员'), ('Timmy', '万江', '白金会员'), ('Kevin', '横沥', '黑金会员'), ('Yeung', '横沥', '黑金会员')]")])],1)]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("span",{staticStyle:{"font-size":"9pt","font-family":"Monaco"}},[e("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用条件进行连表，在大多数情况都会使用外键进行判断连表，所以可以直接省略条件判断，这里只是为了做演示而已")])],1)]),e("div",[e("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[e("br")])]),e("div",[o._v("ret = session.query(Users.name, Users.address, UserType.title).join(UserType, Users.utid == UserType.id).all()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# select users.name, users.address, usertype.title from users inner join usertype on users.utid = usertype.id;")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Aimer', '南城', '超级会员'), ('Jack', '石排', '超级会员'), ('Timmy', '万江', '白金会员'), ('Kevin', '横沥', '黑金会员'), ('Yeung', '横沥', '黑金会员')]")])],1)]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# isouter=True 将 inner join 该变成 left join")])],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users.name, Users.address, UserType.title).join(UserType, isouter=True).all()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# select users.name, users.address, usertype.title from users left join usertype on usertype.id = users.utid;")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Aimer', '南城', '超级会员'), ('Jack', '石排', '超级会员'), ('Timmy', '万江', '白金会员'), ('Kevin', '横沥', '黑金会员'), ('Yeung', '横沥', '黑金会员')]")])],1)]),e("div",[e("br")])]),e("ul",[e("ul",[e("li",[e("div",[o._v("方法三 -> .union() 和 .union_all() -> 上下连表")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# .union() -> 没有去重功能")])],1),e("div",[e("br")]),e("div",[o._v("q1 = session.query(Users.name).filter(Users.id <= 2)")]),e("div",[o._v("q2 = session.query(UserType.title)")]),e("div",[o._v("ret = q1.union(q2).all()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# select name from users where id <= 2 union select title from usertype;")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Kevin',), ('Yeung',), ('超级会员',), ('白金会员',), ('黑金会员',)]")])],1)]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# .union_all() -> 自带去重功能")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[o._v("q1 = session.query(Users.name).filter(Users.id <= 2)")]),e("div",[o._v("q2 = session.query(UserType.title)")]),e("div",[o._v("ret = q1.union_all(q2).all()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# select name from users where id <= 2 union all select title from usertype;")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Kevin',), ('Yeung',), ('超级会员',), ('白金会员',), ('黑金会员',)]")])],1)]),e("div",[e("br")]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{color:"rgb(227, 0, 0)","font-weight":"bold"}},[o._v("relationship() -> 简化连表获取数据的操作 -> 在 ")]),e("span",{staticStyle:{color:"rgb(227, 0, 0)","font-weight":"bold"}},[o._v("django 中也有类似操作")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[o._v("# 导入 relationship")])],1),e("div",[e("font",{attrs:{color:"#000000"}},[e("br")])],1),e("div",[e("font",{attrs:{color:"#000000"}},[o._v("from sqlalchemy.orm import ")]),o._v("relationship")],1)]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[o._v("relationship('从表的类名', backref='从表使用的变量名')")])])])]),e("div",[e("br")]),e("ul",[e("ul",[e("ul",[e("li",[e("div",[o._v('backref="从表使用的变量名"，所定义的变量名是给当从表获取主表数据的时候使用')])]),e("li",[e("div",[o._v("在主表类中（即：有外键的类）中调用 relationship() 方法，且 relationship() 不会影响表的创建")])])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("class Users(Base):")]),e("div",[o._v("    __tablename__ = 'users'")]),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("…………")])],1),e("div",[e("br")]),e("div",[o._v("    user_type = relationship('UserType', backref='xxoo')")])]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[o._v("正向查询 -> 主表获取从表的数据")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{staticStyle:{color:"rgb(227, 0, 0)"}},[o._v("# 当调用了 relationship() 方法的时候，会将从表的所有数据放进 user_type 变量里面，")]),e("font",{attrs:{color:"#E30000"}},[e("font",[o._v("当要获取")]),o._v("与主表数据相关的从表数据"),e("font",[o._v("的")])],1),e("font",{staticStyle:{color:"rgb(227, 0, 0)"}},[o._v("时候，user_type 就会返回与主表数据相关的从表数据的对象")])],1),e("div",[e("br")]),e("div",[o._v("ret = session.query(Users).all()")]),e("div",[o._v("for row in ret:")]),e("div",[o._v("    print(row.user_type.__dict__)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x000002C281E56AC8>, 'title': '黑金会员', 'id': 3}")])],1),e("div",[o._v("    print(row.name, row.address, row.user_type.title) "),e("font",{attrs:{color:"#41AD1C"}},[o._v(" # Kevin 横沥 黑金会员")])],1)]),e("div",[e("br")]),e("ul",[e("ul",[e("li",[e("div",[o._v("反向查询 -> 从表获取主表的数据")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#E30000"}},[o._v("# 当调用了 relationship() 方法的时候，会将主表的所有数据放进 xxoo 变量里面，当要获取与从表数据相关的主表数据的时候，xxoo 就会返回与从表数据相关的主表数据的列表")])],1),e("div",[e("br")]),e("div",[o._v("ret2 = session.query(UserType).all()")]),e("div",[o._v("for row in ret2:")]),e("div",[o._v("    print(row.title, row.xxoo)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 超级会员 [<__main__.Users object at 0x000001830D6E71D0>, <__main__.Users object at 0x000001830D6E7240>]")])],1),e("div",[o._v("    print(row.xxoo[0].name)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# Aimer")])],1)]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("子查询")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("ret = session.query(Users.name, Users.address).filter(Users.id.in_(session.query(Users.id).filter(Users.id < 3))).all()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# select name,address from users where id in (select id from users where id < 3);")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [('Kevin', '横沥'), ('Yeung', '横沥')]")])],1)]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("临时表")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# .subquery()")])],1),e("div",[e("br")]),e("div",[o._v("sql = session.query(Users).filter(Users.id < 5).subquery()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用 .subquery() 创建临时表")])],1),e("div",[e("font",{attrs:{color:"#E30000"}},[e("b",[o._v("# 注意子句中需要使用 c 来调用字段内容")])])],1),e("div",[o._v("ret = session.query(sql).filter(sql.c.id > 2).all()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 使用临时表 -> select * from (select * from users where id < 5) as A where A.id > 2")])],1),e("div",[o._v("print(ret)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [(4, 'Timmy', 25, '万江', 2)]")])],1)]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("在 select 语句中的字段名那一块可以使用 select 语句 -> select 字段名,(select查询语句) from 表名 where 条件")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# 导入 aliased")])],1),e("div",[e("br")]),e("div",[o._v("from sqlalchemy.orm import aliased")])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# .as_scalar() -> 在SQL语句外面加了()")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[e("br")])],1),e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# 该例子在 Mysql 练习中的 显示所有学生的生物、物理、体育、美术四门的课程成绩")])],1),e("div",[e("br")]),e("div",[o._v("score_alias1 = aliased(Score, name='score_alias1')  "),e("font",{attrs:{color:"#E30000"}},[o._v("# 给表起别名")])],1),e("div",[o._v("score_alias2 = aliased(Score, name='score_alias2')  "),e("font",{attrs:{color:"#E30000"}},[o._v("# 给表起别名")])],1),e("div",[e("br")]),e("div",[o._v("result = session.query(")]),e("div",[o._v("    score_alias1.student_id,")]),e("div",[o._v("    session.query(score_alias2.num).filter(score_alias1.student_id == score_alias2.student_id, score_alias2.course_id == 1).as_scalar(),")]),e("div",[o._v("    session.query(score_alias2.num).filter(score_alias1.student_id == score_alias2.student_id, score_alias2.course_id == 2).as_scalar(),")]),e("div",[o._v("    session.query(score_alias2.num).filter(score_alias1.student_id == score_alias2.student_id, score_alias2.course_id == 3).as_scalar(),")]),e("div",[o._v("    session.query(score_alias2.num).filter(score_alias1.student_id == score_alias2.student_id, score_alias2.course_id == 4).as_scalar(),")]),e("div",[o._v(").group_by(score_alias1.student_id).all()")]),e("div",[e("br")]),e("div",[o._v("print(result)  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# [(1, 10, 9, None, 66), (2, 8, None, 68, 99), (3, 77, 66, 87, 99), (4, 79, 11, 67, 100), (5, 79, 11, 67, 100), (6, 9, 100, 67, 100), (7, 9, 100, 67, 88), (8, 9, 100, 67, 88), (9, 91, 88, 67, 22), (10, 90, 77, 43, 87), (11, 90, 77, 43, 87), (12, 90, 77, 43, 87), (13, None, None, 87, None)]")])],1)]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# SQL语句")])],1),e("div",[e("br")]),e("div",[o._v("select")]),e("div",[o._v("    student_id,")]),e("div",[o._v("    (select num from score as s2 where s2.student_id = s1.student_id and course_id = 1) as '生物',")]),e("div",[o._v("    (select num from score as s2 where s2.student_id = s1.student_id and course_id = 2) as '物理',")]),e("div",[o._v("    (select num from score as s2 where s2.student_id = s1.student_id and course_id = 3) as '体育',")]),e("div",[o._v("    (select num from score as s2 where s2.student_id = s1.student_id and course_id = 4) as '美术'")]),e("div",[o._v("from")]),e("div",[o._v("    score as s1")]),e("div",[o._v("group by")]),e("div",[o._v("    student_id;")])]),e("div",[e("br")]),e("div",[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Python/ORM框架 - SQLAchemy 模块_files/Image [3].png",type:"image/png"}})]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("8.")]),o._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("修改数据")])]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("返回值: 受影响行数的数量")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# .update()")])],1),e("div",[e("br")]),e("div",[o._v('ret = session.query(Users).filter(Users.id > 2).update({"name": "临时用户"})  '),e("font",{attrs:{color:"#41AD1C"}},[o._v("# update users set name = '临时用户' where id > 2;")])],1),e("div",[e("font",{attrs:{color:"#000000"}},[o._v("print(reg) ")]),o._v(" "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# 3")])],1)]),e("div",[e("br")]),e("div",[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Python/ORM框架 - SQLAchemy 模块_files/Image [4].png",type:"image/png"}})]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("在字符串类型的数据后面拼接上其他字符串")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("session.query(Users).filter(Users.id > 2).update({Users.name: Users.name + '_test'}, synchronize_session=False)")])]),e("div",[e("br")]),e("div",[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Python/ORM框架 - SQLAchemy 模块_files/Image [5].png",type:"image/png"}})]),e("div",[e("br")]),e("ul",[e("li",[e("div",[o._v("在数字类型的数据基础上进行运算")])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[o._v("session.query(Users).filter(Users.id > 2).update({Users.age: Users.age * 100}, synchronize_session='evaluate')")])]),e("div",[e("br")]),e("div",[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Python/ORM框架 - SQLAchemy 模块_files/Image [6].png",type:"image/png"}})]),e("div",[e("br")]),e("div",[e("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[o._v("9.")]),o._v(" "),e("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[o._v("删除数据")])]),e("div",[e("span",{staticStyle:{"font-size":"14pt"}},[e("br")])]),e("ul",[e("li",[e("div",[e("span",{staticStyle:{"font-size":"12pt"}},[o._v("返回值: 受影响行数的数量")])])])]),e("div",[e("br")]),e("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[e("div",[e("font",{attrs:{color:"#41AD1C"}},[o._v("# .delete()")])],1),e("div",[e("br")]),e("div",[o._v("session.query(Users).filter(Users.id > 2).delete()  "),e("font",{attrs:{color:"#41AD1C"}},[o._v("# delete from users where id>2;")])],1)]),e("div",[e("br")]),e("div",[e("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Python/ORM框架 - SQLAchemy 模块_files/Image [7].png",type:"image/png"}})]),e("div",[e("br")])]),e("div",[e("br")])])])])}),[],!1,null,null,null);r.default=i.exports}}]);