(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{380:function(t,i,o){"use strict";o.r(i);var r=o(25),e=Object(r.a)({},(function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("div",[o("span",[o("div",[o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("ModelSerializer 序列化组件")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[t._v("只要继承了 APIView 就可以使用 ")]),o("span",{staticStyle:{"font-size":"14pt"}},[t._v("ModelSerializer")]),o("span",{staticStyle:{"font-size":"14pt"}})]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[t._v("ModelSerializer")]),o("span",{staticStyle:{"font-size":"14pt"}},[t._v(" 的使用和 ModelForm 组件的使用类似")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("ModelSerializer的基本使用")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)","font-size":"9pt"}},[t._v("# serializer.py")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"},attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("from rest_framework import serializers")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("from .models import *")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("class BookSerializers(serializers.ModelSerializer):")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    class Meta:")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("        model = Book")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("        fields = '__all__'")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 自定义错误信息")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("        extra_kwargs = {")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v('            "title": {')])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                'error_messages': {")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                    'required': '书籍名称不能为空'")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                }")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("            },")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("            'price': {")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                'error_messages': {")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                    'required': '价格不能为空'")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                }")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("            },")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("            'pub_date': {")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                'error_messages': {")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                    'required': '日期不能为空'")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                }")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("            },")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("            'publish': {")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                'error_messages': {")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                    'required': '出版社不能为空'")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                }")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("            },")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("            'author': {")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                'error_messages': {")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                    'required': '作者不能为空'")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("                }")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("            }")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("        }")])],1)]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("br")]),o("div",[t._v("from django.shortcuts import render, HttpResponse")]),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[t._v("from rest_framework.response import Response")]),o("div",[t._v("from .models import *")]),o("div",[t._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class BookView(APIView):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 查看所有书籍")])],1),o("div",[t._v("    def get(self, request):")]),o("div",[t._v("        book_list = Book.objects.all()")]),o("div",[t._v("        bs = BookSerializers(book_list, many=True)")]),o("div",[t._v("        return Response(bs.data)")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 添加书籍")])],1),o("div",[t._v("    def post(self, request):")]),o("div",[t._v("        bs = BookSerializers(data=request.data)")]),o("div",[t._v("        if bs.is_valid():  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 验证数据是否有误")])],1),o("div",[t._v("            print(bs.validated_data)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 验证过后正确的数据: OrderedDict([('title', '三国演义'), ('price', 100), ('pub_date', datetime.date(2012, 12, 12)), ('publish', <Publish: 东莞出版社>), ('authors', [<Author: Kevin>, <Author: Aimer>])])")])],1),o("div",[t._v("            bs.save()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 保存数据，实际上调用的是 rest-framework 中的 create 方法")])],1),o("div",[t._v("            return Response(bs.data)")]),o("div",[t._v("        else:")]),o("div",[t._v("            return Response(bs.errors)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# bs.errors 验证过后的错误信息")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class BookDetailView(APIView):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 查看指定的书籍")])],1),o("div",[t._v("    def get(self, request, id):")]),o("div",[t._v("        book_obj = Book.objects.filter(pk=id).first()")]),o("div",[t._v("        if book_obj:")]),o("div",[t._v("            bs = BookSerializers(book_obj)")]),o("div",[t._v("            return Response(bs.data)")]),o("div",[t._v("        else:")]),o("div",[t._v("            return Response({'static': 0, 'message': '没有该书籍'})")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 修改书籍")])],1),o("div",[t._v("    def put(self, request, id):")]),o("div",[t._v("        book_obj = Book.objects.filter(pk=id).first()")]),o("div",[t._v("        bs = BookSerializers(book_obj, data=request.data)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 修改数据的时候一定要指定修改那条数据（即: book_obj），否则在执行 .save() 的时候就相当于新增数据")])],1),o("div",[t._v("        if bs.is_valid():  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 验证数据是否有误")])],1),o("div",[t._v("            bs.save()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 保存数据，实际上调用的是 rest-framework 中的 update 方法")])],1),o("div",[t._v("            return Response(bs.data)")]),o("div",[t._v("        else:")]),o("div",[t._v("            return Response(bs.errors)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# bs.errors 验证过后的错误信息")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 删除书籍")])],1),o("div",[t._v("    def delete(self, request, id):")]),o("div",[t._v("        Book.objects.filter(pk=id).delete()")]),o("div",[t._v("        return Response()")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# urls.py")])],1),o("div",[o("br")]),o("div",[t._v("urlpatterns = [")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("……")])],1),o("div",[t._v("    url(r'book/$', BookView.as_view()),")]),o("div",[t._v("    url(r'book/(\\d+)', BookDetailView.as_view())")]),o("div",[t._v("]")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口说明: 查看所有书籍")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口: http://127.0.0.1:8000/book/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 请求类型: GET")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 结果:")])],1),o("div",[o("br")]),o("div",[t._v("[")]),o("div",[t._v("    {")]),o("div",[t._v('        "id": 2,')]),o("div",[t._v('        "title": "三体",')]),o("div",[t._v('        "price": 222,')]),o("div",[t._v('        "pub_date": null,')]),o("div",[t._v('        "publish": 1,')]),o("div",[t._v('        "authors": [')]),o("div",[t._v("            2")]),o("div",[t._v("        ]")]),o("div",[t._v("    },")]),o("div",[t._v("    {")]),o("div",[t._v('        "id": 5,')]),o("div",[t._v('        "title": "三国演义",')]),o("div",[t._v('        "price": 100,')]),o("div",[t._v('        "pub_date": "2012-12-12",')]),o("div",[t._v('        "publish": 1,')]),o("div",[t._v('        "authors": [')]),o("div",[t._v("            1,")]),o("div",[t._v("            2")]),o("div",[t._v("        ]")]),o("div",[t._v("    }")]),o("div",[t._v("]")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# --------------------------------------------------------------")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口说明: 添加书籍")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口: http://127.0.0.1:8000/book/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 请求类型: POST")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 发送数据的编码格式: application/json -> 即: json 格式")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 所要发送的数据: ")]),t._v('{"title":"勿忘我","price":100,"pub_date":"2012-12-12","publish":1,"authors":[1,2]}')],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 结果:")])],1),o("div",[o("br")]),o("div",[t._v("{")]),o("div",[t._v('    "id": 14,')]),o("div",[t._v('    "title": "勿忘我",')]),o("div",[t._v('    "price": 100,')]),o("div",[t._v('    "pub_date": "2012-12-12",')]),o("div",[t._v('    "publish": 1,')]),o("div",[t._v('    "authors": [')]),o("div",[t._v("        1,")]),o("div",[t._v("        2")]),o("div",[t._v("    ]")]),o("div",[t._v("}")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# --------------------------------------------------------------")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口说明: 查看指定书籍")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口: http://127.0.0.1:8000/book/2")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 请求类型: GET")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 结果:")])],1),o("div",[o("br")]),o("div",[t._v("{")]),o("div",[t._v('    "id": 2,')]),o("div",[t._v('    "title": "三体",')]),o("div",[t._v('    "price": 222,')]),o("div",[t._v('    "pub_date": null,')]),o("div",[t._v('    "publish": 1,')]),o("div",[t._v('    "authors": [')]),o("div",[t._v("        2")]),o("div",[t._v("    ]")]),o("div",[t._v("}")]),o("div",[o("br")]),o("div",[o("font",{staticStyle:{color:"rgb(250, 122, 0)"}},[t._v("# --------------------------------------------------------------")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口说明: 修改书籍")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口: http://127.0.0.1:8000/book/2")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 请求类型: PUT")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 发送数据的编码格式: application/json -> 即: json 格式")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 所要发送的数据: ")]),t._v('{"title":"三体（第二部）","price":100,"pub_date":"2012-12-12","publish":1,"authors":[1,2]}')],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 结果:")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[t._v("{")]),o("div",[t._v('    "id": 2,')]),o("div",[t._v('    "title": "三体（第二部）",')]),o("div",[t._v('    "price": 100,')]),o("div",[t._v('    "pub_date": "2012-12-12",')]),o("div",[t._v('    "publish": 1,')]),o("div",[t._v('    "authors": [')]),o("div",[t._v("        2,")]),o("div",[t._v("        1")]),o("div",[t._v("    ]")]),o("div",[t._v("}")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# --------------------------------------------------------------")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口说明: 删除书籍")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口: http://127.0.0.1:8000/book/11")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 请求类型: DELETE")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 结果:")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("空")])],1)]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("save() 方法的说明")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("执行 save() 之前一定要执行 is_valid() 方法，否则会报错")])])])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v(".save() 方法的返回值就是所添加/修改的该条数据对象")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("br")]),o("div",[t._v("from django.shortcuts import render, HttpResponse")]),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[t._v("from rest_framework.response import Response")]),o("div",[t._v("from .models import *")]),o("div",[t._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class BookView(APIView):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 添加书籍")])],1),o("div",[t._v("    def post(self, request):")]),o("div",[t._v("        bs = BookSerializers(data=request.data)")]),o("div",[t._v("        if bs."),o("font",{attrs:{color:"#FA7A00"}},[t._v("is_valid")]),t._v("():  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 验证数据是否有误")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("data_obj")]),t._v(" = bs.save()")],1),o("div",[t._v("            print(data_obj.title, data_obj.price)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 三体 100")])],1),o("div",[t._v("            return Response(bs.data)")]),o("div",[t._v("        else:")]),o("div",[t._v("            return Response(bs.errors)")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("自定制字段")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("当 fields = '__all__' 的时候，但是又想对里面的某些字段进行单独配置的时候，可以直接在 ModelSerializer 类中重新编写该字段，那么该字段的配置就会覆盖掉之前的配置")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(147, 150, 0)"}},[t._v("建议:")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(" 如果使用了 ModelSerializer 就尽量不要自定制字段，否则容易出现问题")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("注意: ")])])]),o("ul",[o("li",[o("div",[t._v("当自定制一对多字段的时候，并且使用了source参数，那么就需要重写save()方法中的create()和update()方法 ")])]),o("li",[o("div",[t._v("当自定制多对多字段的时候，添加或修改数据多对多字段的数据会有问题")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# serializer.py ")])],1),o("div",[o("br")]),o("div",[t._v("class BookSerializers(serializers.ModelSerializer):")]),o("div",[t._v("    class Meta:")]),o("div",[t._v("        model = Book")]),o("div",[t._v("        fields = '__all__'")]),o("div",[t._v("        extra_kwargs = {")]),o("div",[t._v('            "title": {')]),o("div",[t._v("                'error_messages': {")]),o("div",[t._v("                    'required': '书籍名称不能为空'")]),o("div",[t._v("                }")]),o("div",[t._v("            },")]),o("div",[t._v("            'price': {")]),o("div",[t._v("                'error_messages': {")]),o("div",[t._v("                    'required': '价格不能为空'")]),o("div",[t._v("                }")]),o("div",[t._v("            },")]),o("div",[t._v("            'pub_date': {")]),o("div",[t._v("                'error_messages': {")]),o("div",[t._v("                    'required': '日期不能为空'")]),o("div",[t._v("                }")]),o("div",[t._v("            },")]),o("div",[t._v("            'publish': {")]),o("div",[t._v("                'error_messages': {")]),o("div",[t._v("                    'required': '出版社不能为空'")]),o("div",[t._v("                }")]),o("div",[t._v("            },")]),o("div",[t._v("            'author': {")]),o("div",[t._v("                'error_messages': {")]),o("div",[t._v("                    'required': '作者不能为空'")]),o("div",[t._v("                }")]),o("div",[t._v("            }")]),o("div",[t._v("        }")]),o("div",[o("br")]),o("div",[t._v('    publish = serializers.CharField(source="publish.name")  '),o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 重新编写 publish 字段的配置")])],1)]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 重写 save() 中的 create() 和 ")]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("update()")])]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("方法")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v(".save()方法实际上调用的是 rest-framework 中的 create 或者 update 方法")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("重写create()/update()方法就是自己将提交过来的数据保存到数据库，并且返回当前保存的数据")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("什么时候需要重写")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("当使用了自定制字段，并且在字段方法中传递了source参数 -> 通俗理解: 当自定制一对多字段的时候，并且使用了source参数，那么就需要重写save()方法中的create()和update()方法 ")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# serializer.py")])],1),o("div",[o("br")]),o("div",[t._v("class BookSerializers(serializers.ModelSerializer):")]),o("div",[t._v("    class Meta:")]),o("div",[t._v("        model = Book")]),o("div",[t._v("        fields = '__all__'")]),o("div",[t._v("        extra_kwargs = {")]),o("div",[t._v('            "title": {')]),o("div",[t._v("                'error_messages': {")]),o("div",[t._v("                    'required': '书籍名称不能为空'")]),o("div",[t._v("                }")]),o("div",[t._v("            },")]),o("div",[t._v("            'price': {")]),o("div",[t._v("                'error_messages': {")]),o("div",[t._v("                    'required': '价格不能为空'")]),o("div",[t._v("                }")]),o("div",[t._v("            },")]),o("div",[t._v("            'pub_date': {")]),o("div",[t._v("                'error_messages': {")]),o("div",[t._v("                    'required': '日期不能为空'")]),o("div",[t._v("                }")]),o("div",[t._v("            },")]),o("div",[t._v("            'publish': {")]),o("div",[t._v("                'error_messages': {")]),o("div",[t._v("                    'required': '出版社不能为空'")]),o("div",[t._v("                }")]),o("div",[t._v("            },")]),o("div",[t._v("            'author': {")]),o("div",[t._v("                'error_messages': {")]),o("div",[t._v("                    'required': '作者不能为空'")]),o("div",[t._v("                }")]),o("div",[t._v("            }")]),o("div",[t._v("        }")]),o("div",[o("br")]),o("div",[t._v('    publish = serializers.CharField(source="publish.pk")  '),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 重新编写 publish 字段的配置")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# ")]),o("font",{attrs:{color:"#41AD1C"}},[t._v("重写 save() 中的 create() 方法")])],1),o("div",[t._v("    def create(self, validated_data):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v('"""')])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("        :param validated_data: 通过验证的数据")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v('        """')])],1),o("div",[t._v("        print(validated_data)")]),o("div",[o("br")]),o("div",[t._v("        book = Book.objects.create(title=validated_data['title'], price=validated_data['price'], pub_date=validated_data['pub_date'], publish_id=validated_data['publish']['pk'])")]),o("div",[t._v('        book.authors.add(*validated_data["authors"])')]),o("div",[o("br")]),o("div",[t._v("        return book")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# ")]),o("font",{attrs:{color:"#41AD1C"}},[t._v("重写 save() 中的 update() 方法")])],1),o("div",[t._v("    def update(self, instance, validated_data):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v('"""')])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("        :param instance: 需要修改的查询到的数据对象")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("        :param validated_data: 通过验证的数据")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v('        """')])],1),o("div",[t._v("        for key, val in validated_data.items():")]),o("div",[t._v("            if hasattr(instance, key):")]),o("div",[t._v("                if 'publish' == key:")]),o("div",[t._v("                    instance.publish_id = validated_data['publish']['pk']")]),o("div",[t._v("                elif 'authors' == key:")]),o("div",[t._v("                    instance.authors.set(validated_data['authors'])")]),o("div",[t._v("                else:")]),o("div",[t._v("                    setattr(instance, key, val)")]),o("div",[t._v("        instance.save()")]),o("div",[t._v("        return instance")])]),o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("超链接API: Hyperlinked")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("HyperlinkedIdentityField 字段方法")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("HyperlinkedIdentityField 字段方法一般都是用在一对多字段上")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("HyperlinkedIdentityField 字段方法返回的是一个url路径")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("HyperlinkedIdentityField 字段方法一般在前后端分离的时候很少会使用")])])]),o("li",[o("div",[t._v("使用场景: 分页器")])]),o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("注意")]),t._v(": 如果你所定义的 序列化类 使用了 "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("HyperlinkedIdentityField 字段方法，那么在实例化 序列化")]),t._v("类 的时候一定要设置 context={'request': request}，否则会报错")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# urls.py")])],1),o("div",[o("br")]),o("div",[t._v("urlpatterns = [")]),o("div",[t._v("    url(r'^admin/', admin.site.urls),")]),o("div",[t._v("    url(r'publish/(?P<"),o("font",{attrs:{color:"#FA7A00"}},[t._v("pk")]),t._v(">\\d+)', PublishDetailView.as_view(), "),o("font",{attrs:{color:"#FA7A00"}},[t._v("name")]),t._v("='publish_detail'),")],1),o("div",[t._v("    url(r'book/$', BookView.as_view())")]),o("div",[t._v("]")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# serializer.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[t._v("from rest_framework import serializers")]),o("div",[t._v("from .models import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class PublishSerializers(serializers.Serializer):")]),o("div",[t._v("    name = serializers.CharField()")]),o("div",[t._v("    email = serializers.CharField()")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class BookSerializers(serializers.ModelSerializer):")]),o("div",[t._v("    class Meta:")]),o("div",[t._v("        model = Book")]),o("div",[t._v("        fields = '__all__'")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# view_name -> url别名")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("    # lookup_field -> 当前外键字段（一对多）在数据库中的字段名")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("    # lookup_url_kwarg -> 分组命名匹配中的别名")])],1),o("div",[o("br")]),o("div",[t._v("    publish = serializers."),o("font",{attrs:{color:"#FA7A00"}},[t._v("HyperlinkedIdentityField")]),t._v("(view_name='publish_detail', lookup_field='publish_id', lookup_url_kwarg='pk')")],1)]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("br")]),o("div",[t._v("from django.shortcuts import render, HttpResponse")]),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[t._v("from rest_framework.response import Response")]),o("div",[t._v("from .models import *")]),o("div",[t._v("from .serializer import *")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class BookView(APIView):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 查看所有书籍")])],1),o("div",[t._v("    def get(self, request):")]),o("div",[t._v("        book_list = Book.objects.all()")]),o("div",[t._v("        bs = BookSerializers(book_list, many=True, "),o("font",{attrs:{color:"#FA7A00"}},[t._v("context")]),t._v("={'request': request})  "),o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 如果你所定义的 序列化类 使用了 HyperlinkedIdentityField 字段方法，那么在实例化 序列化类 的时候一定要设置 context={'request': request}，否则会报错")])],1),o("div",[t._v("        return Response(bs.data)")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class PublishDetailView(APIView):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 查看指定的出版社")])],1),o("div",[t._v("    def get(self, request, pk):")]),o("div",[t._v("        publish_obj = Publish.objects.filter(pk=pk).first()")]),o("div",[t._v("        if publish_obj:")]),o("div",[t._v("            ps = PublishSerializers(publish_obj)")]),o("div",[t._v("            return Response(ps.data)")]),o("div",[t._v("        else:")]),o("div",[t._v("            return Response({'static': 0, 'message': '没有该出版社'})")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接口: http://127.0.0.1:8000/book/")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 请求类型: GET")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 结果:")])],1),o("div",[o("br")]),o("div",[t._v("[")]),o("div",[t._v("    {")]),o("div",[t._v('        "id": 2,')]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v('"publish": "http://127.0.0.1:8000/publish/1",')])],1),o("div",[t._v('        "title": "三体",')]),o("div",[t._v('        "price": 222,')]),o("div",[t._v('        "pub_date": null,')]),o("div",[t._v('        "authors": [')]),o("div",[t._v("            2")]),o("div",[t._v("        ]")]),o("div",[t._v("    },")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("……")])],1),o("div",[o("br")]),o("div",[t._v("]")])]),o("div",[o("br")])]),o("div",[o("br")]),o("div",[o("br")])])])])}),[],!1,null,null,null);i.default=e.exports}}]);