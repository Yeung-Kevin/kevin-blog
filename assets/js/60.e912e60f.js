(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{416:function(t,i,o){"use strict";o.r(i);var e=o(25),n=Object(e.a)({},(function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("div",[o("span",[o("div",[o("div",[o("div",[o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("编程的三部分: 使用数据 存储数据 展示数据")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),t._v(" "),o("font",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("在浏览器中输入URL并回车后都发生了什么？")])])],1),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[t._v("浏览器连接"),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("网页服务器")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("浏览器向服务端发送了一条消息")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("网页服务器接收到消息")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("网页服务器向浏览器发送消息（html文件）")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("浏览器展示页面")])])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"box-sizing":"border-box","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"14pt","white-space":"pre-wrap",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[t._v("2.")]),o("span",{staticStyle:{"font-size":"medium","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal"}}),o("span",{staticStyle:{"box-sizing":"border-box","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"14pt",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[t._v("使浏览器 和 网页服务器的说明")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("网页服务器相当于 socket 服务端")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("浏览器相当于 socket 客户端")])])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap",color:"rgb(227, 0, 0)","font-weight":"bold"}},[t._v("3.")]),o("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap",color:"rgb(227, 0, 0)","font-weight":"bold"}},[t._v("本质:")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("web框架的本质")])]),o("ul",[o("li",[o("div",[t._v("本质上：通过http协议使用 socket 互发消息")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("不同的URL返回不同的页面")])]),o("ul",[o("li",[o("div",[t._v("本质上：根据路径的不同返回不同的html文件内容")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("动态网页（html模板渲染）")])]),o("ul",[o("li",[o("div",[t._v("本质上：字符串的替换")])])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("Python Web框架的分类:")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("A. socket -> 服务器程序（")]),o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"12pt","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("专门用来处理 socket 收发消息")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("）")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("B. 根据不同的URL路径执行不同的函数 -> 应用程序（")]),o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-size":"12pt","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("处理业务逻辑，控制服务器程序要返回的消息的具体内容")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("）")])])]),o("li",[o("div",[t._v("C. 动态页面（html模板渲染）")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("Django -> 第三方的 A, 框架自带 B、C")])]),o("li",[o("div",[t._v("Flask -> 第三方的 A、C, 框架自带 B")])]),o("li",[o("div",[t._v("Tornado -> 框架自带 A、B、C")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("使用 socket 模拟上网")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("import socket")]),o("div",[o("br")]),o("div",[t._v("sk = socket.socket()")]),o("div",[t._v("sk.bind(('127.0.0.1', 8080))")]),o("div",[t._v("sk.listen()")]),o("div",[o("br")]),o("div",[t._v("while 1:")]),o("div",[t._v("    conn, addr = sk.accept()")]),o("div",[t._v("    data = conn.recv(2048)")]),o("div",[t._v("    print(data)")]),o("div",[t._v("    conn.send(b'HTTP/1.1 200 OK\\r\\n\\r\\n') "),o("font",{attrs:{color:"#E30000"}},[t._v(" # 因为要遵循HTTP协议，所以要在回复消息之前先发送状态行消息 -> ")]),o("font",{attrs:{color:"#E30000"}},[t._v("这里就相当于使用 socket 发送文件的例子中的报头（即：接收文件前要知道文件的名称/大小/类型，才可以开始接收文件，如果不懂的就看回 socket 中的报头）")])],1),o("div",[t._v("    conn.send(b'<h1>Hello</h1>')")]),o("div",[t._v("    conn.send(b'<a href=\"http://www.baidu.com\">baidu</a>')")]),o("div",[t._v("    conn.close()")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# socket 服务端所接收到消息 -> 其实服务端所接收到的就是网页请求头的内容")])],1),o("div",[o("br")]),o("div",[t._v("b'GET / HTTP/1.1\\r\\nHost: 127.0.0.1:8080\\r\\nConnection: keep-alive\\r\\nPragma: no-cache\\r\\nCache-Control: no-cache\\r\\nUpgrade-Insecure-Requests: 1\\r\\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.119 Safari/537.36\\r\\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\\r\\nAccept-Encoding: gzip, deflate, br\\r\\nAccept-Language: zh-CN,zh;q=0.9\\r\\n\\r\\n'")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 优化返回的信息 -> \\r\\n 代表着回车")])],1),o("div",[o("br")]),o("div",[t._v("b'GET / HTTP/1.1")]),o("div",[t._v("Host: 127.0.0.1:8080")]),o("div",[t._v("Connection: keep-alive")]),o("div",[t._v("Pragma: no-cache")]),o("div",[t._v("Cache-Control: no-cache")]),o("div",[t._v("Upgrade-Insecure-Requests: 1")]),o("div",[t._v("User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.119 Safari/537.36")]),o("div",[t._v("Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8")]),o("div",[t._v("Accept-Encoding: gzip, deflate, br")]),o("div",[t._v("Accept-Language: zh-CN,zh;q=0.9")]),o("div",[o("br")]),o("div",[t._v("'")])]),o("div",[o("br")]),o("div",[o("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django/Web框架的本质（重要+理解）_files/Image.png",type:"image/png"}})]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 浏览器访问 127.0.0.1:8080 -> 因为浏览器相当于 socket 客户端，所以不用编写 socket 客户端")])],1)]),o("div",[o("br")]),o("div",[o("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django/Web框架的本质（重要+理解）_files/Image [1].png",type:"image/png"}})]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("根据不同的路径返回不同的内容")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("import socket")]),o("div",[o("br")]),o("div",[t._v("sk = socket.socket()")]),o("div",[t._v("sk.bind(('127.0.0.1', 8080))")]),o("div",[t._v("sk.listen()")]),o("div",[o("br")]),o("div",[t._v("while 1:")]),o("div",[t._v("    conn, addr = sk.accept()")]),o("div",[t._v("    data = conn.recv(2048)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接收浏览器发送过来的消息")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 从浏览器发送过来的消息中获取路径")])],1),o("div",[t._v("    str_data = str(data, encoding='utf-8')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 把bytes类型转换为字符串类型")])],1),o("div",[t._v("    path = str_data.split()[1]  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# /index/")])],1),o("div",[o("br")]),o("div",[t._v("    conn.send(b'HTTP/1.1 200 OK\\r\\nContent-Type: text/html; charset=utf-8\\r\\n\\r\\n')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 需要设置为 utf-8 不然浏览器会以系统默认的 GBK 编码对发送过来的内容进行编译，这样就会出现乱码")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 根据不同的路径返回不同的内容")])],1),o("div",[t._v("    if path == '/index/':")]),o("div",[t._v("        response = bytes('<h1>index 页面</h1>', encoding='utf-8')")]),o("div",[t._v("    elif path == '/login/':")]),o("div",[t._v("        response = bytes('<h1>login 页面</h1>', encoding='utf-8')")]),o("div",[t._v("    else:")]),o("div",[t._v("        response = bytes('<h1>404 not found!</h1>', encoding='utf-8')")]),o("div",[o("br")]),o("div",[t._v("    conn.send(response)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 向浏览器发送具体响应体（内容）")])],1),o("div",[t._v("    conn.close()")])]),o("div",[o("br")]),o("div",[o("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django/Web框架的本质（重要+理解）_files/Image [2].png",type:"image/png"}}),t._v(" "),o("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django/Web框架的本质（重要+理解）_files/Image [3].png",type:"image/png"}}),t._v(" "),o("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django/Web框架的本质（重要+理解）_files/Image [4].png",type:"image/png",width:"280"}})]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("根据不同的路径返回不同的内容 -- 函数版")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("import socket")]),o("div",[o("br")]),o("div",[t._v("sk = socket.socket()")]),o("div",[t._v("sk.bind(('127.0.0.1', 8080))")]),o("div",[t._v("sk.listen()")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#E30000"}},[t._v("# 将返回不同内容的部分封装成函数")])],1),o("div",[t._v("def index(path):")]),o("div",[t._v("    s = '<h1>这是{}页面！</h1>'.format(path)")]),o("div",[t._v("    return bytes(s, encoding='utf-8')")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("def login(path):")]),o("div",[t._v("    s = '<h1>这是{}页面！</h1>'.format(path)")]),o("div",[t._v("    return bytes(s, encoding='utf-8')")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("while 1:")]),o("div",[t._v("    conn, addr = sk.accept()")]),o("div",[t._v("    data = conn.recv(2048)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接收浏览器发送过来的消息")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 从浏览器发送过来的消息中获取路径")])],1),o("div",[t._v("    str_data = str(data, encoding='utf-8')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 把bytes类型转换为字符串类型")])],1),o("div",[t._v("    path = str_data.split()[1]  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# /index/")])],1),o("div",[o("br")]),o("div",[t._v("    conn.send(b'HTTP/1.1 200 OK\\r\\nContent-Type: text/html; charset=utf-8\\r\\n\\r\\n')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 需要设置为 utf-8 不然浏览器会以系统默认的 GBK 编码对发送过来的内容进行编译，这样就会出现乱码")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 根据不同的路径返回不同的内容")])],1),o("div",[t._v("    if path == '/index/':")]),o("div",[t._v("        response = index(path)")]),o("div",[t._v("    elif path == '/login/':")]),o("div",[t._v("        response = login(path)")]),o("div",[t._v("    else:")]),o("div",[t._v("        response = bytes('<h1>404 not found!</h1>', encoding='utf-8')")]),o("div",[o("br")]),o("div",[t._v("    conn.send(response)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 向浏览器发送具体响应体（内容）")])],1),o("div",[t._v("    conn.close()")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("5.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("根据不同的路径返回不同的内容 -- 函数版进阶版")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("import socket")]),o("div",[o("br")]),o("div",[t._v("sk = socket.socket()")]),o("div",[t._v("sk.bind(('127.0.0.1', 8080))")]),o("div",[t._v("sk.listen()")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 将返回不同内容的部分封装成函数")])],1),o("div",[t._v("def index(path):")]),o("div",[t._v("    s = '<h1>这是{}页面！</h1>'.format(path)")]),o("div",[t._v("    return bytes(s, encoding='utf-8')")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("def login(path):")]),o("div",[t._v("    s = '<h1>这是{}页面！</h1>'.format(path)")]),o("div",[t._v("    return bytes(s, encoding='utf-8')")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#E30000"}},[t._v("# 使用反射解决每次都要更新判断的问题")])],1),o("div",[t._v("lis = [")]),o("div",[t._v("    ('/index/', index),")]),o("div",[t._v("    ('/login/', login)")]),o("div",[t._v("]")]),o("div",[o("br")]),o("div",[t._v("while 1:")]),o("div",[t._v("    conn, addr = sk.accept()")]),o("div",[t._v("    data = conn.recv(2048)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接收浏览器发送过来的消息")])],1),o("div",[o("br")]),o("div",[t._v("    # 从浏览器发送过来的消息中获取路径")]),o("div",[t._v("    str_data = str(data, encoding='utf-8')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 把bytes类型转换为字符串类型")])],1),o("div",[t._v("    path = str_data.split()[1]  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# /index/")])],1),o("div",[o("br")]),o("div",[t._v("    conn.send(b'HTTP/1.1 200 OK\\r\\nContent-Type: text/html; charset=utf-8\\r\\n\\r\\n')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 需要设置为 utf-8 不然浏览器会以系统默认的 GBK 编码对发送过来的内容进行编译，这样就会出现乱码")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 根据不同的路径返回不同的内容")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}}),o("font",{attrs:{color:"#E30000"}},[t._v(" # 使用反射解决每次都要更新判断的问题")])],1),o("div",[t._v("    func = None")]),o("div",[t._v("    for i in lis:")]),o("div",[t._v("        if i[0] == path:")]),o("div",[t._v("            func = i[1]")]),o("div",[t._v("            break")]),o("div",[o("br")]),o("div",[t._v("    if func:")]),o("div",[t._v("        response = func(path)")]),o("div",[t._v("    else:")]),o("div",[t._v("        response = bytes('<h1>404 not found!</h1>', encoding='utf-8')")]),o("div",[o("br")]),o("div",[t._v("    conn.send(response)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 向浏览器发送具体响应体（内容）")])],1),o("div",[t._v("    conn.close()")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("6.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("根据不同的路径返回具体的html文件")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("import socket")]),o("div",[o("br")]),o("div",[t._v("sk = socket.socket()")]),o("div",[t._v("sk.bind(('127.0.0.1', 8080))")]),o("div",[t._v("sk.listen()")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 将返回不同内容的部分封装成函数")])],1),o("div",[t._v("def index(path):")]),o("div",[t._v("    with open('index.html', encoding='utf-8') as f:  ")]),o("div",[t._v("        s = f.read()  "),o("font",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("# 读取 index.html 的内容")])],1),o("div",[t._v("    return bytes(s, encoding='utf-8')  "),o("font",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("# 返回 bytes类型的 html 内容")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("def login(path):")]),o("div",[t._v("    with open('login.html', encoding='utf-8') as f:")]),o("div",[t._v("        s = f.read()  "),o("font",{attrs:{color:"#E30000"}},[t._v("# 读取 login.html 的内容")])],1),o("div",[t._v("    return bytes(s, encoding='utf-8')  "),o("font",{attrs:{color:"#E30000"}},[t._v("# 返回 bytes类型的 html 内容")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 使用反射解决每次都要更新判断的问题")])],1),o("div",[t._v("lis = [")]),o("div",[t._v("    ('/index/', index),")]),o("div",[t._v("    ('/login/', login)")]),o("div",[t._v("]")]),o("div",[o("br")]),o("div",[t._v("while 1:")]),o("div",[t._v("    conn, addr = sk.accept()")]),o("div",[t._v("    data = conn.recv(2048)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 接收浏览器发送过来的消息")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 从浏览器发送过来的消息中获取路径")])],1),o("div",[t._v("    str_data = str(data, encoding='utf-8')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 把bytes类型转换为字符串类型")])],1),o("div",[t._v("    path = str_data.split()[1]  # /index/")]),o("div",[o("br")]),o("div",[t._v("    conn.send(b'HTTP/1.1 200 OK\\r\\nContent-Type: text/html; charset=utf-8\\r\\n\\r\\n') "),o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 需要设置为 utf-8 不然浏览器会以系统默认的 GBK 编码对发送过来的内容进行编译，这样就会出现乱码")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 根据不同的路径返回不同的内容")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("    # 使用反射解决每次都要更新判断的问题")])],1),o("div",[t._v("    func = None")]),o("div",[t._v("    for i in lis:")]),o("div",[t._v("        if i[0] == path:")]),o("div",[t._v("            func = i[1]")]),o("div",[t._v("            break")]),o("div",[o("br")]),o("div",[t._v("    if func:")]),o("div",[t._v("        response = func(path)")]),o("div",[t._v("    else:")]),o("div",[t._v("        response = bytes('<h1>404 not found!</h1>', encoding='utf-8')")]),o("div",[o("br")]),o("div",[t._v("    conn.send(response)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 向浏览器发送具体响应体（内容）")])],1),o("div",[t._v("    conn.close()")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# index.html")])],1),o("div",[o("br")]),o("div",[t._v("<!DOCTYPE html>")]),o("div",[t._v("<html>")]),o("div",[t._v("<head>")]),o("div",[t._v('    <meta charset="utf-8">')]),o("div",[t._v('    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">')]),o("div",[t._v("    <title>index</title>")]),o("div",[t._v('    <meta name="description" content="">')]),o("div",[t._v('    <meta name="keywords" content="">')]),o("div",[t._v('    <link rel="stylesheet" href="">')]),o("div",[t._v("    <script type=\"text/javascript\" src=''><\/script>")]),o("div",[t._v("</head>")]),o("div",[t._v("<body>")]),o("div",[t._v("<h1>这是index页面</h1>")]),o("div",[t._v('<script type="text/javascript"><\/script>')]),o("div",[t._v("</body>")]),o("div",[t._v("</html>")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# login.html")])],1),o("div",[o("br")]),o("div",[t._v("<!DOCTYPE html>")]),o("div",[t._v("<html>")]),o("div",[t._v("<head>")]),o("div",[t._v('    <meta charset="utf-8">')]),o("div",[t._v('    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">')]),o("div",[t._v("    <title>login</title>")]),o("div",[t._v('    <meta name="description" content="">')]),o("div",[t._v('    <meta name="keywords" content="">')]),o("div",[t._v('    <link rel="stylesheet" href="">')]),o("div",[t._v("    <script type=\"text/javascript\" src=''><\/script>")]),o("div",[t._v("</head>")]),o("div",[t._v("<body>")]),o("div",[t._v("<h1>这是login页面</h1>")]),o("div",[t._v('<script type="text/javascript"><\/script>')]),o("div",[t._v("</body>")]),o("div",[t._v("</html>")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("7.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("动态")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("网页")]),o("span",{staticStyle:{"font-size":"14pt"}},[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("（html模板渲染）")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("import socket")]),o("div",[t._v("import time")]),o("div",[o("br")]),o("div",[t._v("sk = socket.socket()")]),o("div",[t._v("sk.bind(('127.0.0.1', 8080))")]),o("div",[t._v("sk.listen()")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 将返回不同内容的部分封装成函数")])]),o("div",[t._v("def index(path):")]),o("div",[t._v("    with open('index.html', encoding='utf-8') as f:  ")]),o("div",[t._v("        s = f.read()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 读取 index.html 的内容")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}}),t._v("now = str(time.time())")],1),o("div",[t._v("        s = s.replace('@@xx@@', now)  "),o("font",{attrs:{color:"#E30000"}},[t._v("# 在网页中定义好特殊符号，用动态的数据去替换提前定义好的特殊符号")])],1),o("div",[t._v("    return bytes(s, encoding='utf-8')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回 bytes类型的 html 内容")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("def login(path):")]),o("div",[t._v("    with open('login.html', encoding='utf-8') as f:")]),o("div",[t._v("        s = f.read()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 读取 login.html 的内容")])],1),o("div",[t._v("    return bytes(s, encoding='utf-8')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回 bytes类型的 html 内容")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 使用反射解决每次都要更新判断的问题")])]),o("div",[t._v("lis = [")]),o("div",[t._v("    ('/index/', index),")]),o("div",[t._v("    ('/login/', login)")]),o("div",[t._v("]")]),o("div",[o("br")]),o("div",[t._v("while 1:")]),o("div",[t._v("    conn, addr = sk.accept()")]),o("div",[t._v("    data = conn.recv(2048)  "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 接收浏览器发送过来的消息")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 从浏览器发送过来的消息中获取路径")])]),o("div",[t._v("    str_data = str(data, encoding='utf-8')  "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 把bytes类型转换为字符串类型")])]),o("div",[t._v("    path = str_data.split()[1]  # /index/")]),o("div",[o("br")]),o("div",[t._v("    conn.send(b'HTTP/1.1 200 OK\\r\\nContent-Type: text/html; charset=utf-8\\r\\n\\r\\n') "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v(" # 需要设置为 utf-8 不然浏览器会以系统默认的 GBK 编码对发送过来的内容进行编译，这样就会出现乱码")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v(" # 根据不同的路径返回不同的内容")])]),o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("    # 使用反射解决每次都要更新判断的问题")])]),o("div",[t._v("    func = None")]),o("div",[t._v("    for i in lis:")]),o("div",[t._v("        if i[0] == path:")]),o("div",[t._v("            func = i[1]")]),o("div",[t._v("            break")]),o("div",[o("br")]),o("div",[t._v("    if func:")]),o("div",[t._v("        response = func(path)")]),o("div",[t._v("    else:")]),o("div",[t._v("        response = bytes('<h1>404 not found!</h1>', encoding='utf-8')")]),o("div",[o("br")]),o("div",[t._v("    conn.send(response)  "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 向浏览器发送具体响应体（内容）")])]),o("div",[t._v("    conn.close()")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# index.html")])],1),o("div",[o("br")]),o("div",[t._v("<!DOCTYPE html>")]),o("div",[t._v("<html>")]),o("div",[t._v("<head>")]),o("div",[t._v('    <meta charset="utf-8">')]),o("div",[t._v('    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">')]),o("div",[t._v("    <title>index</title>")]),o("div",[t._v('    <meta name="description" content="">')]),o("div",[t._v('    <meta name="keywords" content="">')]),o("div",[t._v('    <link rel="stylesheet" href="">')]),o("div",[t._v("    <script type=\"text/javascript\" src=''><\/script>")]),o("div",[t._v("</head>")]),o("div",[t._v("<body>")]),o("div",[t._v("<h1>时间戳：@@xx@@</h1>")]),o("div",[t._v('<script type="text/javascript"><\/script>')]),o("div",[t._v("</body>")]),o("div",[t._v("</html>")])]),o("div",[o("br")]),o("div",[o("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django/Web框架的本质（重要+理解）_files/Image [5].png",type:"image/png"}})]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("8.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("服务器程序 和 应用程序")])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("div",[o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(0, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("对于真实开发中的python web程序来说，一般会分为两部分：服务器程序和应用程序")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("服务器程序:")]),t._v(" "),o("span",{staticStyle:{"font-size":"12pt","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("主要负责对socket服务器进行封装，并在请求到来时，对请求的各种数据进行整理（")]),o("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("通俗理解: 专门用来处理 socket 收发消息")]),o("span",{staticStyle:{"font-size":"12pt","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("），例如：")])]),t._v("wsgiref（Python的内置模块）")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("应用程序:")]),t._v(" "),o("span",{staticStyle:{"font-size":"12pt","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("主要负责具体的逻辑处理（")]),o("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("通俗理解: 处理业务逻辑，控制服务器程序要返回的消息的具体内容")]),o("span",{staticStyle:{"font-size":"12pt","font-variant-caps":"normal","font-variant-ligatures":"normal"}},[t._v("）。为了方便应用程序的开发，就出现了众多的Web框架，例如：Django、Flask、web.py 等。不同的框架有不同的开发方式，但是无论如何，开发出的应用程序都要和服务器程序配合，才能为用户提供服务")])])])])]),o("div",[o("br")]),o("div",[t._v("由于出现了众多的Web框架，服务器程序就需要为不同的框架提供不同的支持。这样混乱的局面无论对于服务器还是框架，都是不好的。对服务器来说，需要支持各种不同框架，对框架来说，只有支持它的服务器才能被开发出的应用使用。")]),o("div",[o("br")]),o("div",[t._v("这时候，标准化就变得尤为重要。我们可以设立一个标准，只要服务器程序支持这个标准，框架也支持这个标准，那么他们就可以配合使用。一旦标准确定，双方各自实现。这样，服务器可以支持更多支持标准的框架，框架也可以使用更多支持标准的服务器。")]),o("div",[o("br")]),o("div",[t._v("WSGI（Web Server Gateway Interface）就是一种规范，它定义了使用Python编写的web应用程序与web服务器程序之间的接口格式，实现web应用程序与web服务器程序间的解耦。")]),o("div",[o("br")]),o("div",[t._v("常用的WSGI服务器有uwsgi、Gunicorn。而Python标准库提供的独立WSGI服务器叫wsgiref，"),o("span",{staticStyle:{"background-color":"rgb(255, 250, 165)","-evernote-highlight":"true"}},[t._v("Django开发环境用的就是这个模块来做服务器")])]),o("div",[o("span",{staticStyle:{"background-color":"rgb(255, 250, 165)","-evernote-highlight":"true"}},[o("br")])]),o("div",[t._v("WSGI 没有并发的功能，只能排队执行")]),o("div",[o("span",{staticStyle:{"background-color":"rgb(255, 250, 165)","-evernote-highlight":"true"}},[o("br")])]),o("div",[o("img",{attrs:{"data-filename":"20190412165112.png",src:"/kevin-blog/Django/Web框架的本质（重要+理解）_files/20190412165112.png",type:"image/png",width:"1092"}})]),o("div",[o("br")]),o("div",[o("img",{attrs:{"data-filename":"未标题-1.png",src:"/kevin-blog/Django/Web框架的本质（重要+理解）_files/未标题-1.png",type:"image/png"}})]),o("div",[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("9.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("wsgiref 服务器程序模块")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("wsgiref模块是一个遵循 wsgi 协议处理请求的服务器程序模块")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("利用wsgiref模块来替换我们自己写的web框架的 socket 部分的服务区程序")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("import time")]),o("div",[t._v("from wsgiref.simple_server import make_server")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 将返回不同内容的部分封装成函数")])],1),o("div",[t._v("def index(path):")]),o("div",[t._v("    with open('index.html', encoding='utf-8') as f:")]),o("div",[t._v("        s = f.read()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 读取 index.html 的内容")])],1),o("div",[t._v("        now = str(time.time())")]),o("div",[t._v("        s = s.replace('@@xx@@', now)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 在网页中定义好特殊符号，用动态的数据去替换提前定义好的特殊符号")])],1),o("div",[t._v("    return bytes(s, encoding='utf-8')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回 bytes类型的 html 内容")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("def login(path):")]),o("div",[t._v("    with open('login.html', encoding='utf-8') as f:")]),o("div",[t._v("        s = f.read()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 读取 login.html 的内容")])],1),o("div",[t._v("    return bytes(s, encoding='utf-8')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回 bytes类型的 html 内容")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 使用反射解决每次都要更新判断的问题")])],1),o("div",[t._v("lis = [")]),o("div",[t._v("    ('/index/', index),")]),o("div",[t._v("    ('/login/', login)")]),o("div",[t._v("]")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 使用wsgiref模块帮我们收发浏览器的消息")])],1),o("div",[t._v("def run_server(environ, start_response):")]),o("div",[t._v("    start_response('200 OK', [('Content-Type', 'text/html;charset=utf8'), ])  "),o("font",{attrs:{color:"#E30000"}},[t._v("# 设置HTTP响应的状态码和头信息")])],1),o("div",[t._v("    path = environ['PATH_INFO']  "),o("font",{attrs:{color:"#E30000"}},[t._v("# 取到用户输入的url")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 根据不同的路径返回不同的内容")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("    # 使用反射解决每次都要更新判断的问题")])],1),o("div",[t._v("    func = None")]),o("div",[t._v("    for i in lis:")]),o("div",[t._v("        if i[0] == path:")]),o("div",[t._v("            func = i[1]")]),o("div",[t._v("            break")]),o("div",[o("br")]),o("div",[t._v("    if func:")]),o("div",[t._v("        response = func(path)")]),o("div",[t._v("    else:")]),o("div",[t._v("        response = bytes('<h1>404 not found!</h1>', encoding='utf-8')")]),o("div",[o("br")]),o("div",[t._v("    return [response]")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("if __name__ == '__main__':")]),o("div",[t._v("    httpd = make_server('127.0.0.1', 8080, run_server)")]),o("div",[t._v('    print("我在8080等你哦...")')]),o("div",[t._v("    httpd.serve_forever()")])]),o("div",{staticStyle:{margin:"10px auto",padding:"0px","text-indent":"0px","letter-spacing":"normal",orphans:"2","text-align":"left","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("br")]),o("div",{staticStyle:{margin:"10px auto",padding:"0px","text-indent":"0px","letter-spacing":"normal",orphans:"2","text-align":"left","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("10.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("jinja2 模块")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("jinja2 模块一般用于html模板渲染，和上面所写的动态网页例子是一样的")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# jinja2 的安装")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[t._v("pip3 install jinja2 -i https://pypi.douban.com/simple "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 使用豆瓣的镜像")])],1)]),o("div",[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from wsgiref.simple_server import make_server")]),o("div",[t._v("import jinja2")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 将返回不同内容的部分封装成函数")])],1),o("div",[t._v("def index(path):")]),o("div",[t._v("    with open('index.html', encoding='utf-8') as f:")]),o("div",[t._v("        data = f.read()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 读取 index.html 的内容")])],1),o("div",[o("br")]),o("div",[t._v("    template = jinja2.Template(data)  "),o("font",{attrs:{color:"#E30000"}},[t._v("# 生成模板文件")])],1),o("div",[t._v('    s = template.render({"name": "Alex", "hobby_list": ["烫头", "泡吧"]})  '),o("font",{attrs:{color:"#E30000"}},[t._v("# 把数据填充到模板里")])],1),o("div",[o("br")]),o("div",[t._v("    return bytes(s, encoding='utf-8')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回 bytes类型的 html 内容")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("def login(path):")]),o("div",[t._v("    with open('login.html', encoding='utf-8') as f:")]),o("div",[t._v("        s = f.read()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 读取 login.html 的内容")])],1),o("div",[t._v("    return bytes(s, encoding='utf-8')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回 bytes类型的 html 内容")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 使用反射解决每次都要更新判断的问题")])],1),o("div",[t._v("lis = [")]),o("div",[t._v("    ('/index/', index),")]),o("div",[t._v("    ('/login/', login)")]),o("div",[t._v("]")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("def run_server(environ, start_response):")]),o("div",[t._v("    start_response('200 OK', [('Content-Type', 'text/html;charset=utf8'), ])  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 设置HTTP响应的状态码和头信息")])],1),o("div",[t._v("    path = environ['PATH_INFO']  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 取到用户输入的url")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 根据不同的路径返回不同的内容")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("    # 使用反射解决每次都要更新判断的问题")])],1),o("div",[t._v("    func = None")]),o("div",[t._v("    for i in lis:")]),o("div",[t._v("        if i[0] == path:")]),o("div",[t._v("            func = i[1]")]),o("div",[t._v("            break")]),o("div",[o("br")]),o("div",[t._v("    if func:")]),o("div",[t._v("        response = func(path)")]),o("div",[t._v("    else:")]),o("div",[t._v("        response = bytes('<h1>404 not found!</h1>', encoding='utf-8')")]),o("div",[o("br")]),o("div",[t._v("    return [response]")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("if __name__ == '__main__':")]),o("div",[t._v("    httpd = make_server('127.0.0.1', 8080, run_server)")]),o("div",[t._v('    print("我在8080等你哦...")')]),o("div",[t._v("    httpd.serve_forever()")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# index.html")])],1),o("div",[o("br")]),o("div",[t._v("<!DOCTYPE html>")]),o("div",[t._v('<html lang="zh-CN">')]),o("div",[t._v("<head>")]),o("div",[t._v('    <meta charset="UTF-8">')]),o("div",[t._v('    <meta http-equiv="x-ua-compatible" content="IE=edge">')]),o("div",[t._v('    <meta name="viewport" content="width=device-width, initial-scale=1">')]),o("div",[t._v("    <title>index</title>")]),o("div",[t._v("</head>")]),o("div",[t._v("<body>")]),o("div",[t._v("<h1>姓名："+t._s("{{name}}")+"</h1>")]),o("div",[t._v("<h1>爱好：</h1>")]),o("div",[t._v("<ul>")]),o("div",[t._v("    {% for hobby in hobby_list %}")]),o("div",[t._v("    <li>"+t._s("{{hobby}}")+"</li>")]),o("div",[t._v("    {% endfor %}")]),o("div",[t._v("</ul>")]),o("div",[t._v("</body>")]),o("div",[t._v("</html>")])]),o("div",[o("br")]),o("div",[o("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django/Web框架的本质（重要+理解）_files/Image [6].png",type:"image/png"}})]),o("div",[o("br")])])])])}),[],!1,null,null,null);i.default=n.exports}}]);