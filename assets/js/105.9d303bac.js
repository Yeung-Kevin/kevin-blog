(window.webpackJsonp=window.webpackJsonp||[]).push([[105],{465:function(t,s,o){"use strict";o.r(s);var i=o(25),e=Object(i.a)({},(function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("div",[o("span",[o("div",[o("div",[o("div",[o("div",[o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("Flask 的 Session")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("1.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("Flask 的 session 原理")])]),o("div",[o("font",{staticStyle:{"font-size":"14pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[t._v("当请求刚进来时，Flask 会读取cookie中session对应的值：eyjrmindxxx，将该值解密并反序列化成一个字典，并且放入内存中以便视图函数使用")])]),o("li",[o("div",[t._v("当请求结束时，flask会读取内存中字典的值，进行序列化+加密，最后写入用户cookie中")])])]),o("div",[o("br")]),o("div",[o("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Flask/Session_files/Image.png",type:"image/png",width:"532"}})]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("2.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("Flask 的 session 介绍")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("Flask 中的 session 本质上继承了 python 中的字典，字典有的方法它都能使用，且在返回给浏览器的时候会将这个字典变成密文写入cookie中")])])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("3.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("session 的全局配置项")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[t._v("{")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}}),t._v("'PERMANENT_SESSION_LIFETIME': timedelta(days=31),  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# session 的有效时间")])],1),o("div",[t._v("    'SESSION_COOKIE_NAME': 'session',  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# session 在 cookie 中的名字")])],1),o("div",[t._v("    'SESSION_COOKIE_SAMESITE': None,")]),o("div",[t._v("    'SESSION_COOKIE_DOMAIN': None,")]),o("div",[t._v("    'SESSION_COOKIE_PATH': None,")]),o("div",[t._v("    'SESSION_COOKIE_HTTPONLY': True,")]),o("div",[t._v("    'SESSION_COOKIE_SECURE': False,")]),o("div",[t._v("    'SESSION_REFRESH_EACH_REQUEST': True,  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 是否当用户访问了该页面重新计算session时间")])],1),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[t._v("}")])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("4.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("session 的使用")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# app.py")])],1),o("div",[o("br")]),o("div",[t._v("from flask import Flask, request, session")]),o("div",[o("br")]),o("div",[t._v("app = Flask(__name__)")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.secret_key")]),t._v(" = 'session_salt'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 设置session的“盐”，一定要设置否则无法使用 session")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("@app.route('/index', methods=['GET', 'POST'])")]),o("div",[t._v("def index():")]),o("div",[o("font",{staticStyle:{color:"rgb(250, 122, 0)"}},[t._v("session['name']")]),t._v(" = 'Kevin'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 设置 session")])],1),o("div",[t._v("    session_name_data = "),o("font",{attrs:{color:"#FA7A00"}},[t._v("session.get('name')")]),t._v(" "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 获取 session")])],1),o("div",[t._v("    print(session_name_data)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# Kevin")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("span")]),o("font",{attrs:{color:"#FA7A00"}},[t._v("del session['name'] ")]),t._v(" "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 删除 session")])],1),o("div",[t._v("    return 'index'")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("if __name__ == '__main__':")]),o("div",[t._v("    app.run()")])]),o("div",[o("font",{staticStyle:{"font-size":"14pt"}},[o("br")])],1),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("Flask 的 Session 源码分析")])]),o("div",[o("font",{staticStyle:{"font-size":"14pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[t._v("flask 默认通过 SecureCookieSessionInterface 对象管理 Session")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("SecureCookieSessionInterface 对象下最重要的两个方法就是 open_session方法 和 save_session方法")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("open_session方法 和 save_session方法的说明")])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("open_session方法: 获取session，从cookie中获取session的信息，然后session信息进行解密+反序列化得到相关的session内容")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("save_session方法: 保存session，将需要保存的内容加密+序列化，然后写入cookie中")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("class SecureCookieSessionInterface(SessionInterface):")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("……")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# 获取 session 的方法")])],1),o("div",[t._v("    def open_session(self, app, request):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 检测是否设置了secret_key参数，返回一个签名对象")])],1),o("div",[t._v("        s = self.get_signing_serializer(app)")]),o("div",[t._v("        if s is None:")]),o("div",[t._v("            return None")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 去cookie中获取session信息")])],1),o("div",[t._v("        val = request.cookies.get(app.session_cookie_name)")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 如果是第一次请求，返回一个空的SecureCookieSession对象，会被交给请求上下文的session属性管理")])],1),o("div",[t._v("        if not val:")]),o("div",[t._v("            return self.session_class()")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 获取session的失效时间")])],1),o("div",[t._v("        max_age = total_seconds(app.permanent_session_lifetime)")]),o("div",[t._v("        try:")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 对session信息进行解码+反序列化得到用户信息")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("data = s.loads(val, max_age=max_age)")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回有用户信息的session对象")])],1),o("div",[t._v("            return self.session_class(data)")]),o("div",[t._v("        except BadSignature:")]),o("div",[t._v("            return self.session_class()")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# 保存 session 的方法")])],1),o("div",[t._v("    def save_session(self, app, session, response):")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 获取cookie设置的域")])],1),o("div",[t._v("        domain = self.get_cookie_domain(app)")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 获取cookie设置的路径")])],1),o("div",[t._v("        path = self.get_cookie_path(app)")]),o("div",[o("br")]),o("div",[t._v("        if not session:")]),o("div",[t._v("            if session.modified:")]),o("div",[t._v("                response.delete_cookie(")]),o("div",[t._v("                    app.session_cookie_name, domain=domain, path=path")]),o("div",[t._v("                )")]),o("div",[t._v("            return")]),o("div",[o("br")]),o("div",[t._v("        if session.accessed:")]),o("div",[t._v('            response.vary.add("Cookie")')]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 检测SESSION_REFRESH_EACH_REQUEST参数配置")])],1),o("div",[t._v("        if not self.should_set_cookie(app, session):")]),o("div",[t._v("            return")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回SESSION_COOKIE_HTTPONLY参数配置")])],1),o("div",[t._v("        httponly = self.get_cookie_httponly(app)")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回SESSION_COOKIE_SECURE参数配置")])],1),o("div",[t._v("        secure = self.get_cookie_secure(app)")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回SESSION_COOKIE_SAMESITE参数配置")])],1),o("div",[t._v("        samesite = self.get_cookie_samesite(app)")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回失效的时间点")])],1),o("div",[t._v("        expires = self.get_expiration_time(app, session)")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 将用户的数据加密+序列化")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v(" val = self.get_signing_serializer(app).dumps(dict(session))")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 设置cookie")])],1),o("div",[t._v("        response.set_cookie(")]),o("div",[t._v("            app.session_cookie_name,")]),o("div",[t._v("            val,")]),o("div",[t._v("            expires=expires,")]),o("div",[t._v("            httponly=httponly,")]),o("div",[t._v("            domain=domain,")]),o("div",[t._v("            path=path,")]),o("div",[t._v("            secure=secure,")]),o("div",[t._v("            samesite=samesite,")]),o("div",[t._v("        )")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t._v("app.session_interface 说明")]),t._v(": ")])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("app.session_interface 是指定 Flask 使用什么对象对session进行管理")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("当 app.session_interface 被修改了，那么就会使用你所指定的对象进行对session的管理")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("flask-session 模块也是通过修改 app.session_interface 的值来确定session保存在那个位置")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from flask import Flask")]),o("div",[t._v("from flask.sessions import SecureCookieSessionInterface")]),o("div",[o("br")]),o("div",[t._v("app = Flask(__name__)")]),o("div",[o("font",{staticStyle:{color:"rgb(250, 122, 0)"}},[t._v("app.session_interface = SecureCookieSessionInterface()")])],1)]),o("div",[o("font",{staticStyle:{"font-size":"14pt"}},[o("br")])],1),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("flask-session模块")])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("PIL的安装")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("pip3 install flask-session -i https://pypi.douban.com/simple "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 使用豆瓣的镜像")])],1)]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("介绍")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("flask-session 是 flask 框架的 session组件，由于原来 flask 内置 session 使用签名 cookie 保存，该组件则将支持 session 保存到多个地方，如:")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("null")]),t._v(": 采用flask默认的保存在cookie中")])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(65, 173, 28)"}},[t._v("redis")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(": 将数据保存到 redis 缓存中")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(65, 173, 28)"}},[t._v("memcached")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(": 将数据保存到 memcached 缓存中")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(65, 173, 28)"}},[t._v("filesystem")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(": 将数据保存到文件中")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(65, 173, 28)"}},[t._v("mongodb")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(": 将数据保存到 mongodb 数据库中")])])]),o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt",color:"rgb(65, 173, 28)"}},[t._v("sqlalchmey")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v(":")]),o("span",{staticStyle:{"font-size":"12pt",color:"rgb(65, 173, 28)"}}),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("将数据存到")]),t._v("关系型数据库")])])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("flask-session 实际是通过修改 ")]),t._v("app.session_interface 的值来确定 session 保存在那个位置")])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("在 Flask 的 Session 源码分析栏目中有提到 app.session_interface 的说明")])])])]),o("div",[o("br")]),o("div",[o("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Flask/Session_files/Image [1].png",type:"image/png"}})]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("使用场景")])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("如果应用程序比较小，就用原生的加密ccokie 保存session（即: Flask 内置session）")])])])]),o("div",[o("font",{staticStyle:{"font-size":"12pt"}},[o("br")])],1),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("如果应用程序比较大，就用flask-session（即: redis）")])])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("所有配置项")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 可以在 flask-session 所提供的 Session 类源码中查看所有的配置信息")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("#")]),t._v(" from flask.ext.session import Session  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 旧版本的写法")])],1),o("div",[t._v("from flask_session import Session  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 新版本的写法")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("Session")])],1)]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# ------------------ 公共配置 --------------------------")])],1),o("div",[o("br")]),o("div",[t._v("app.config['SESSION_TYPE'] = 'null'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# session所保存的位置")])],1),o("div",[t._v("app.config['SESSION_PERMANENT'] = True  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 是否使用永久会话，默认True，但是如果设置了PERMANENT_SESSION_LIFETIME，则这个失效")])],1),o("div",[t._v("app.config['SESSION_USE_SIGNER'] = False  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 是否为cookie设置签名来保护数据不被更改，默认是False；如果设置True,那么必须设置flask的secret_key参数")])],1),o("div",[t._v("app.config['SESSION_KEY_PREFIX'] = 'session:' "),o("font",{attrs:{color:"#41AD1C"}},[t._v(" # session存储时的key的前缀")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# ------------------ redis的相关配置 --------------------------")])],1),o("div",[o("br")]),o("div",[t._v("app.config['SESSION_REDIS'] = None  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 配置redis连接对象（即: 设置该连接那个redis），如果不设置默认使用本地ip+6379端口的redis进行连接")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# ------------------ memcached的相关配置 --------------------------")])],1),o("div",[o("br")]),o("div",[t._v("app.config['SESSION_MEMCACHED'] = None  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 配置memcached连接对象（即: 设置该连接那个memcached），如果不设置默认就会报错")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# ------------------ filesystem的相关配置 --------------------------")])],1),o("div",[o("br")]),o("div",[t._v("app.config['SESSION_FILE_DIR'] = os.path.join(os.getcwd(), 'flask_session')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 文件路径")])],1),o("div",[t._v("app.config['SESSION_FILE_THRESHOLD'] = 500  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 存储session的个数如果大于这个值时，就要开始进行删除了")])],1),o("div",[t._v("app.config['SESSION_FILE_MODE'] = 384  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 文件权限类型，默认值: 0o600")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# ------------------ mongodb的相关配置 --------------------------")])],1),o("div",[o("br")]),o("div",[t._v("app.config['SESSION_MONGODB'] = None  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 所要连接的MongoDB数据库")])],1),o("div",[t._v("app.config['SESSION_MONGODB_DB'] = 'flask_session'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# MongoDB 数据库名称")])],1),o("div",[t._v("app.config['SESSION_MONGODB_COLLECT'] = 'sessions' "),o("font",{attrs:{color:"#41AD1C"}},[t._v(" # MongoDB 表名称")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# ------------------ sqlalchmey的相关配置 --------------------------")])],1),o("div",[o("br")]),o("div",[t._v("app.config['SESSION_SQLALCHEMY'] = None  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# SQLAlchemy对象")])],1),o("div",[t._v("app.config['SESSION_SQLALCHEMY_TABLE'] = 'sessions'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 表名称（即: session 数据保存在该表下）")])],1)]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("5.")]),t._v(" "),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("使用")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("redis")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{staticStyle:{"font-size":"9pt"},attrs:{color:"#41AD1C"}},[t._v("# app.py")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("import redis")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("from flask import Flask, render_template, session")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("font",{attrs:{color:"#41AD1C"}},[t._v("#")]),t._v(" from flask.ext.session import "),o("font",{attrs:{color:"#FA7A00"}},[t._v("Session  ")]),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 旧版本的写法")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("from flask_session import "),o("font",{attrs:{color:"#FA7A00"}},[t._v("Session  ")]),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 新版本的写法")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("app = Flask(__name__)")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("app.secret_key = 'session_salt'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 设置session的“盐”")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"},attrs:{color:"#FA7A00"}},[t._v("# ----------------- flask-session的相关配置-start -------------------------")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_TYPE']")]),t._v(" = 'redis'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# session所保存的位置")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_REDIS']")]),t._v(" = redis.Redis(host='127.0.0.1', port=6379, password='')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 配置redis连接对象（即: 设置该连接那个redis），如果不设置默认使用本地ip+6379端口的redis进行连接")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_PERMANENT'] = True  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 是否使用永久会话，默认True，但是如果设置了PERMANENT_SESSION_LIFETIME，则这个失效")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_USE_SIGNER'] = False  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 是否为cookie设置签名来保护数据不被更改，默认是False；如果设置True,那么必须设置flask的secret_key参数")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_KEY_PREFIX'] = 'session:'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# session存储时的key的前缀")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"},attrs:{color:"#FA7A00"}},[t._v("Session(app)")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"},attrs:{color:"#FA7A00"}},[t._v("# ----------------- flask-session的相关配置-end -------------------------")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("@app.route('/login')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("def login():")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    session['user'] = 'Kevin'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 设置 session")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    return render_template('login.html')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("@app.route('/index')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("def index():")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    print(session.get('user'))  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 获取 session")])],1)],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    return render_template('index.html')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("if __name__ == '__main__':")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    app.run()")])],1)]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("memcached")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# app.py")])]),o("div",[o("br")]),o("div",[t._v("import memcache")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask import Flask, render_template, session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("#")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask.ext.session import")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 旧版本的写法")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask_session import")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 新版本的写法")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app = Flask(__name__)")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.secret_key = 'session_salt'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 设置session的“盐”")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("# ----------------- flask-session的相关配置-start -------------------------")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("app.config['SESSION_TYPE']")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt"}},[t._v("= '")]),t._v("memcached"),o("span",{staticStyle:{"font-size":"9pt"}},[t._v("'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# session所保存的位置")])]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['")]),t._v("SESSION_MEMCACHED"),o("span",{staticStyle:{"font-size":"9pt"}},[t._v("']")])]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt"}},[t._v("= ")]),t._v("memcache.Client(['10.211.55.4:12000']) "),o("span",{staticStyle:{"font-size":"9pt"}}),o("font",{attrs:{color:"#41AD1C"}},[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("# 配置")]),t._v("memcached"),o("span",{staticStyle:{"font-size":"9pt"}},[t._v("连接对象（即: 设置该连接那个")]),t._v("memcached"),o("span",{staticStyle:{"font-size":"9pt"}},[t._v("），如果不设置默认就会报错")])])],1),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_PERMANENT'] = True  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 是否使用永久会话，默认True，但是如果设置了PERMANENT_SESSION_LIFETIME，则这个失效")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_USE_SIGNER'] = False  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 是否为cookie设置签名来保护数据不被更改，默认是False；如果设置True,那么必须设置flask的secret_key参数")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_KEY_PREFIX'] = 'session:'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# session存储时的key的前缀")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session(app)")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("# ----------------- flask-session的相关配置-end -------------------------")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("@app.route('/login')")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("def login():")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    session['user'] = 'Kevin'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 设置 session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    return render_template('login.html')")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("@app.route('/index')")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("def index():")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    print(session.get('user'))  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 获取 session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    return render_template('index.html')")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("if __name__ == '__main__':")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    app.run()")])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("filesystem")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# app.py")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask import Flask, render_template, session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("#")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask.ext.session import")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 旧版本的写法")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask_session import")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 新版本的写法")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app = Flask(__name__)")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.secret_key = 'session_salt'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 设置session的“盐”")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("# ----------------- flask-session的相关配置-start -------------------------")])]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_TYPE']")]),t._v(" = 'filesystem'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# session所保存的位置")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_FILE_DIR']")]),t._v(" = '/Users/wupeiqi/PycharmProjects/grocery/96.Flask新课程/组件/2.flask-session'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 文件路径")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_FILE_THRESHOLD']")]),t._v(" = 500  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 存储session的个数如果大于这个值时，就要开始进行删除了")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_FILE_MODE']")]),t._v(" = 384  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 文件权限类型，默认值: 0o600")])],1),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_PERMANENT'] = True  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 是否使用永久会话，默认True，但是如果设置了PERMANENT_SESSION_LIFETIME，则这个失效")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_USE_SIGNER'] = False  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 是否为cookie设置签名来保护数据不被更改，默认是False；如果设置True,那么必须设置flask的secret_key参数")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_KEY_PREFIX'] = 'session:'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# session存储时的key的前缀")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session(app)")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("# ----------------- flask-session的相关配置-end -------------------------")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("@app.route('/login')")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("def login():")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    session['user'] = 'Kevin'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 设置 session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    return render_template('login.html')")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("@app.route('/index')")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("def index():")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    print(session.get('user'))  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 获取 session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    return render_template('index.html')")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("if __name__ == '__main__':")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    app.run()")])])]),o("div",[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("mongodb")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# app.py")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("import ")]),t._v("pymongo")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask import Flask, render_template, session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("#")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask.ext.session import")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 旧版本的写法")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask_session import")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 新版本的写法")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app = Flask(__name__)")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.secret_key = 'session_salt'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 设置session的“盐”")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("# ----------------- flask-session的相关配置-start -------------------------")])]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_TYPE']")]),t._v(" = 'mongodb'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# session所保存的位置")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_MONGODB']")]),t._v(" = pymongo.MongoClient('mongodb://localhost:27017/')  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 所要连接的MongoDB数据库")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_MONGODB_DB']")]),t._v(" = 'mongo的db名称（数据库名称）'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# MongoDB 数据库名称")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_MONGODB_COLLECT']")]),t._v(" = 'mongo的collect名称（表名称）'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# MongoDB 表名称")])],1),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_PERMANENT'] = True  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 是否使用永久会话，默认True，但是如果设置了PERMANENT_SESSION_LIFETIME，则这个失效")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_USE_SIGNER'] = False  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 是否为cookie设置签名来保护数据不被更改，默认是False；如果设置True,那么必须设置flask的secret_key参数")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_KEY_PREFIX'] = 'session:'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# session存储时的key的前缀")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session(app)")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("# ----------------- flask-session的相关配置-end -------------------------")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("@app.route('/login')")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("def login():")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    session['user'] = 'Kevin'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 设置 session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    return render_template('login.html')")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("@app.route('/index')")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("def index():")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    print(session.get('user'))  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 获取 session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    return render_template('index.html')")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("if __name__ == '__main__':")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    app.run()")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("sqlalchmey")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("pip3 install flask-sqlalchemy -i https://pypi.douban.com/simple "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 使用豆瓣的镜像")])],1)]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# app.py")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask import Flask, render_template, session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("#")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask.ext.session import")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 旧版本的写法")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("from flask_session import")]),t._v(" "),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 新版本的写法")])]),o("div",[t._v("from flask_sqlalchemy import SQLAlchemy")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app = Flask(__name__)")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.secret_key = 'session_salt'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 设置session的“盐”")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("# ----------------- flask-session的相关配置-start -------------------------")])]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 设置数据库链接")])],1),o("div",[t._v("app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://数据库用户名:密码，如果没有密码可以空着不填@ip地址:端口号/数据库名称?charset=utf8'")]),o("div",[t._v("app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = True")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 实例化SQLAlchemy")])],1),o("div",[t._v("db = SQLAlchemy(app)")]),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_TYPE']")]),t._v(" = 'sqlalchemy'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# session所保存的位置")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_SQLALCHEMY']")]),t._v(" = db  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# SQLAlchemy对象")])],1),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("app.config['SESSION_SQLALCHEMY_TABLE']")]),t._v(" = 'session'  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 表名称（即: session 数据保存在该表下）")])],1),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_PERMANENT'] = True  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 是否使用永久会话，默认True，但是如果设置了PERMANENT_SESSION_LIFETIME，则这个失效")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_USE_SIGNER'] = False  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 是否为cookie设置签名来保护数据不被更改，默认是False；如果设置True,那么必须设置flask的secret_key参数")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("app.config['SESSION_KEY_PREFIX'] = 'session:'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# session存储时的key的前缀")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("Session(app)")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(250, 122, 0)"}},[t._v("# ----------------- flask-session的相关配置-end -------------------------")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("@app.route('/login')")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("def login():")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    session['user'] = 'Kevin'  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 设置 session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    return render_template('login.html')")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("@app.route('/index')")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("def index():")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    print(session.get('user'))  ")]),o("span",{staticStyle:{"font-size":"9pt",color:"rgb(65, 173, 28)"}},[t._v("# 获取 session")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    return render_template('index.html')")])]),o("div",[o("br")]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("if __name__ == '__main__':")])]),o("div",[o("span",{staticStyle:{"font-size":"9pt"}},[t._v("    app.run()")])])]),o("div",[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 在终端上执行创建数据库表")])],1),o("div",[o("br")]),o("div",[t._v(">>> from app import db")]),o("div",[t._v(">>> db.create_all()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 创建数据库表")])],1)]),o("div",[o("br")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);