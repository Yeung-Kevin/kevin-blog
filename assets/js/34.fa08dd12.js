(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{388:function(t,e,o){"use strict";o.r(e);var i=o(25),r=Object(i.a)({},(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("div",[o("span",[o("div",[o("div",[o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","font-weight":"bold","line-height":"1.5","background-color":"#3eaf7c","border-radius":"3px","text-align":"center",color:"white","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-ligatures":"normal","font-variant-caps":"normal","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","font-weight":"bold","line-height":"1.5","background-color":"#3eaf7c","border-radius":"3px",color:"white","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-ligatures":"normal","font-variant-caps":"normal","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t._v("rest-framework 中文文档")])]),o("div",[o("br")]),o("div",[t._v("Github:  "),o("a",{attrs:{href:"https://github.com/Q1mi/Django-REST-framework-documentation"}},[t._v("https://github.com/Q1mi/Django-REST-framework-documentation")])]),o("div",[o("br")]),o("div",[t._v("地址:  "),o("a",{attrs:{href:"https://q1mi.github.io/Django-REST-framework-documentation/"}},[t._v("https://q1mi.github.io/Django-REST-framework-documentation/")])]),o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("rest-framework框架的介绍")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("rest-framework 是根据 RESTful 规范开发出来的一套 Django 的 API 框架")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("rest-framework 是建立在CBV基础上使用的 -> 通俗理解: 如果要是用 rest-framework，那么就一定要使用 CBV 去编写视图")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("rest-framework 的作用: 开发符合 RESTful 规范的接口")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("rest-framework 的10个功能（按请求顺序排序）: 路由 视图 版本 认证 权限 频率 解析器 序列化 分页 渲染器")])])]),o("div",[o("br")])]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("csrf token 的问题")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("在使用 rest-framework 编写接口的时候会默认忽略掉 csrf token 认证中间件")])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("原理: 在 .as_view() 返回 view 视图函数的时候会在 view 视图函数上加上 csrf_exempt 装饰器，使其忽略 csrf token 的认证")])])])]),o("div",[o("br")]),o("div",[o("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Django Rest-Framework/rest-framework 的基本使用_files/Image.png",type:"image/png"}})]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("如果在编写接口的时候还是发生了 csrf token 问题的解决办法")])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("问题一: Postman 可以正常发送请求，但是在浏览器上无法正常发送")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("ul",[o("li",[o("div",[t._v("解决办法一: 以 vue 项目为例: 查看 cookie 中是否存在 csrf token 的相关 cookie，如果存在清楚浏览器所有 cookie 即可")])])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("ul",[o("li",[o("div",[t._v("解决办法二: 以 vue 项目为例: 先注释掉 csrf token 中间件，然后查看浏览器是否可以正常发送请求，如果可以，删除掉 csrf token 中间件的注释，给视图类下的视图函数单独添加  csrf_exempt 装饰器")])])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from rest_framework.views import APIView")]),o("div",[t._v("from rest_framework.response import Response")]),o("div",[t._v("from django.utils.decorators import method_decorator")]),o("div",[t._v("from django.views.decorators.csrf import "),o("font",{attrs:{color:"#FA7A00"}},[t._v("csrf_exempt")])],1),o("div",[o("br")]),o("div",[t._v("class Test(APIView):")]),o("div",[t._v("　　@method_decorator("),o("font",{attrs:{color:"#FA7A00"}},[t._v("csrf_exempt")]),t._v(")  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 给类里面的方法加装饰器  需要导入一个方法method_decorator")])],1),o("div",[t._v("　　def post(self, request):")]),o("div",[t._v("　　　　return Response({'a': 1})")])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("问题一: Postman 可以无法发送请求，浏览器上也无法正常发送")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("ul",[o("li",[o("div",[t._v("解决办法: 先注释掉 csrf token 中间件，然后查看Postman是否可以正常发送请求，如果可以，删除掉 csrf token 中间件的注释，给视图类下的视图函数单独添加  csrf_exempt 装饰器")])])])])]),o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("本笔记本所使用的数据库")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("# models.py")])],1)]),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("from django.db import models")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[t._v("class User(models.Model):")]),o("div",[t._v("    username = models.CharField(max_length=32)")]),o("div",[t._v("    password = models.CharField(max_length=32)")]),o("div",[t._v("    type_choices = ((1, '普通用户'), (2, 'VIP'), (3, 'SVIP'))")]),o("div",[t._v("    user_type = models.IntegerField(choices=type_choices, default=1)")]),o("div",[o("br")]),o("div",[t._v("    def __str__(self):")]),o("div",[t._v("        return self.username")]),o("div",[o("br")]),o("div",[t._v("    class Meta:")]),o("div",[t._v('        verbose_name = "用户表"')]),o("div",[t._v("        verbose_name_plural = verbose_name")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class Token(models.Model):")]),o("div",[t._v("    user = models.OneToOneField(to='User')")]),o("div",[t._v("    token = models.CharField(max_length=128)")]),o("div",[o("br")]),o("div",[t._v("    def __str__(self):")]),o("div",[t._v("        return self.token")]),o("div",[o("br")]),o("div",[t._v("    class Meta:")]),o("div",[t._v('        verbose_name = "Token表"')]),o("div",[t._v("        verbose_name_plural = verbose_name")]),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("class Book(models.Model):")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    title = models.CharField(max_length=32, verbose_name='书名')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    price = models.IntegerField(verbose_name='价格')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    pub_date = models.DateField(verbose_name='出版日期')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}}),t._v("production_date = models.DateTimeField(verbose_name='生产日期', null=True)")],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    publish = models.ForeignKey(\"Publish\", verbose_name='出版社')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    authors = models.ManyToManyField(\"Author\", verbose_name='作者')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    def __str__(self):")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("        return self.title")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    class Meta:")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v('        verbose_name = "书籍表"')])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("        verbose_name_plural = verbose_name")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("class Publish(models.Model):")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    name = models.CharField(max_length=32, verbose_name='出版社名称')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    email = models.EmailField(verbose_name='邮箱')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    def __str__(self):")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("        return self.name")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    class Meta:")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v('        verbose_name = "出版社表"')])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("        verbose_name_plural = verbose_name")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("class Author(models.Model):")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    name = models.CharField(max_length=32, verbose_name='姓名')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    age = models.IntegerField(verbose_name='年龄')")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    def __str__(self):")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("        return self.name")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[o("br")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("    class Meta:")])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v('        verbose_name = "作者表"')])],1),o("div",[o("font",{staticStyle:{"font-size":"9pt"}},[t._v("        verbose_name_plural = verbose_name")])],1)]),o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("rest-framework 的下载与配置")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 下载 rest-")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("framework ")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("pip3 install djangorestframework -i https://pypi.douban.com/simple "),o("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 使用豆瓣的镜像")])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" 注册 rest-")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("framework")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# settings.py")])],1),o("div",[o("br")]),o("div",[t._v("INSTALLED_APPS = [")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("……")])],1),o("div",[t._v("    'rest_framework',")]),o("div",[t._v("]")])]),o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("接口类的编写规范")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("在编写接口的时候要注意不能出现异常导致程序运行中断，而是使用 try 对异常进行捕获防治程序运行中断")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("编写好每个异常的状态码（即: code），每个状态码就代表着一个错误信息")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{color:"rgb(255, 0, 0)"}},[t._v("注意: 在本章节中只有这里使用了接口类编写规范，其他栏目没有使用需要注意，且一定要按照该规范编写")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# response.py")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 返回给前端的数据结构")])],1),o("div",[t._v("class BaseResponse(object):")]),o("div",[t._v("    def __init__(self):")]),o("div",[t._v("        self.code = 0")]),o("div",[t._v("        self.data = None")]),o("div",[t._v("        self.msg = ''")]),o("div",[o("br")]),o("div",[t._v("    @property")]),o("div",[t._v("    def dic(self):")]),o("div",[t._v("        return self.__dict__")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# exceptions.py")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 自定义异常类")])],1),o("div",[t._v("class CommonException(Exception):")]),o("div",[t._v("    def __init__(self, code, msg):")]),o("div",[t._v("        self.code = code")]),o("div",[t._v("        self.msg = msg")])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("br")]),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[t._v("from rest_framework.response import Response")]),o("div",[o("br")]),o("div",[t._v("from django.core.exceptions import ObjectDoesNotExist "),o("font",{attrs:{color:"#41AD1C"}},[t._v(" # 如果查询不到数据会抛出该错误")])],1),o("div",[o("br")]),o("div",[t._v("from api.utils.response import BaseResponse")]),o("div",[t._v("from api.utils.exceptions import CommonException  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 自定义异常类")])],1),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class Spec(APIView):")]),o("div",[t._v("    def get(self):")]),o("div",[t._v("        res = BaseResponse()")]),o("div",[t._v("        try:")]),o("div",[t._v("            obj1 = 表类.objects.get(pk=xxx)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# .get() 方法如果查询不到就会抛出 ObjectDoesNotExist 异常")])],1),o("div",[t._v("            obj2 = 表类.objects.filter(pk=xxx).first()  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 如果查询不到不会抛出异常，只会返回 None")])],1),o("div",[o("br")]),o("div",[t._v("            if not obj2:")]),o("div",[t._v("                raise CommonException(1002, 'xxx不存在2')")]),o("div",[o("br")]),o("div",[t._v("            res.data = {")]),o("div",[t._v("                'xxx': obj1.xxx,")]),o("div",[t._v("                'xxx': obj2.xxx")]),o("div",[t._v("            }")]),o("div",[o("br")]),o("div",[t._v("        except ObjectDoesNotExist as e:")]),o("div",[t._v("            res.msg = 'xxx不存在1'")]),o("div",[t._v("            res.code = 1001")]),o("div",[t._v("        except CommonException as e:")]),o("div",[t._v("            res.msg = e.msg")]),o("div",[t._v("            res.code = e.code")]),o("div",[t._v("        except Exception as e:")]),o("div",[t._v("            print(e)")]),o("div",[o("font",{attrs:{color:"#FA7A00"}},[t._v("# 捕获其他不知道的异常，然后写入日志中")])],1),o("div",[t._v("        return Response(res.dic)")])]),o("div",[o("br")]),o("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[o("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("APIView 的 request 对象 ")])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" APIView 的 request对象 说明")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("这里所指的request对象就是 FBV 或 CBV 中的 request 对象")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("APIView（在")]),t._v(" rest-framework 中 CBV 所要继承的类"),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("） 的 request 对象是在 View（即: 以前CBV中所继承的类） 的 request 对象的基础上进行封装的，所以在使用")]),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("在使用")]),t._v(" rest-framework 中的 CBV 里的 request 对象是一个全新的 request 对象")])])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("View 的 request 对象有的功能，APIView 的 request 对象都有")])])]),o("div",[o("br")]),o("div",[o("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),o("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v(" APIView 的 request对象 所提供的常用属性:")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("request.GET -> 获取GET请求参数")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("br")]),o("div",[t._v("from django.shortcuts import render, HttpResponse")]),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[o("br")])]),o("div",[o("br")]),o("div",[t._v("class BookView(APIView):")]),o("div",[t._v("    def get(self, request):")]),o("div",[o("br")]),o("div",[t._v("        get_data = "),o("font",{attrs:{color:"#FA7A00"}},[t._v("request.GET")])],1),o("div",[o("br")]),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# 等同于")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[o("br")])],1),o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("        # get_data = request._request.GET")])],1),o("div",[o("br")]),o("div",[t._v("        print(get_data)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# <QueryDict: {'b': ['2'], 'a': ['1']}>")])],1),o("div",[o("br")]),o("div",[t._v("        return HttpResponse('get请求')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[t._v("request.query_params -> "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("获取GET请求参数")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("request.query_params 等同于 "),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("request.GET")])])]),o("li",[o("div",[t._v("request.query_params 实际上是执行了 request._request.GET")])])])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[t._v("from django.shortcuts import render, HttpResponse")]),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("class BookView(APIView):")]),o("div",[t._v("    def get(self, request):")]),o("div",[o("br")]),o("div",[t._v("        get_data = "),o("font",{staticStyle:{color:"rgb(250, 122, 0)"}},[t._v("request.query_params")])],1),o("div",[o("br")]),o("div",[t._v("        print(get_data)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# <QueryDict: {'name': ['三国演义'], 'price': ['100']}>")])],1),o("div",[t._v("        print(get_data.get('name'))  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 三国演义")])],1),o("div",[t._v("        print(get_data.get('price'))  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 100")])],1),o("div",[o("br")]),o("div",[t._v("        return HttpResponse('get请求')")])]),o("div",[o("span",{staticStyle:{"font-size":"14pt"}},[o("br")])]),o("ul",[o("li",[o("div",[o("span",{staticStyle:{"font-size":"12pt"}},[t._v("request.data -> 获取除GET请求外的其他请求参数（即: POST/PUT/")]),t._v("PATCH 等请求的参数"),o("span",{staticStyle:{"font-size":"12pt"}},[t._v("）")])])])]),o("div",[o("br")]),o("ul",[o("ul",[o("li",[o("div",[t._v("在不使用 rest-framework 之前，request.POST 只能获取以 application/x-www-form-urlencoded 编码格式发送过来的数据，其他编码格式发送过来的数据（如: application/json）都只能通过 request.body 获取，然后自行解析，但是在 rest-framework 可以通过 request.data 获取不同编码格式发送过来的数据，并且帮我们进行解析")])])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("br")]),o("div",[t._v("from django.shortcuts import render, HttpResponse")]),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[o("br")])]),o("div",[o("br")]),o("div",[t._v("class BookView(APIView):")]),o("div",[o("br")]),o("div",[t._v("    def post(self, request):")]),o("div",[t._v("        data = "),o("font",{attrs:{color:"#FA7A00"}},[t._v("request.data")])],1),o("div",[t._v("        print(data)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# 以 application/json 编码格式提交过来的数据 -> {'name': 'Kevin', 'age': 18}")])],1),o("div",[t._v("        return HttpResponse('post请求')")])]),o("div",[o("br")]),o("ul",[o("li",[o("div",[t._v("request._request -> 获取 View 的 request 对象（即: 旧的request对象）")])])]),o("div",[o("br")]),o("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[o("div",[o("font",{attrs:{color:"#41AD1C"}},[t._v("# views.py")])],1),o("div",[o("br")]),o("div",[t._v("from django.shortcuts import render, HttpResponse")]),o("div",[t._v("from rest_framework.views import APIView")]),o("div",[o("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[o("br")])]),o("div",[o("br")]),o("div",[t._v("class BookView(APIView):")]),o("div",[t._v("    def get(self, request):")]),o("div",[t._v("        get_data = "),o("font",{attrs:{color:"#FA7A00"}},[t._v("request._request")]),t._v(".GET")],1),o("div",[t._v("        print(get_data)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# <QueryDict: {'b': ['2'], 'a': ['1']}>")])],1),o("div",[t._v("        return HttpResponse('get请求')")]),o("div",[o("br")]),o("div",[o("br")]),o("div",[t._v("    def post(self, request):")]),o("div",[t._v("        post_data = "),o("font",{attrs:{color:"#FA7A00"}},[t._v("request._request")]),t._v(".POST")],1),o("div",[t._v("        print(post_data)  "),o("font",{attrs:{color:"#41AD1C"}},[t._v("# <QueryDict: {'age': ['18'], 'name': ['Kevin']}>")])],1),o("div",[t._v("        return HttpResponse('post请求')")])]),o("div",[o("br")])]),o("div",[o("br")]),o("div",[o("br")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);