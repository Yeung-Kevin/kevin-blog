(window.webpackJsonp=window.webpackJsonp||[]).push([[143],{494:function(i,o,t){"use strict";t.r(o);var r=t(25),e=Object(r.a)({},(function(){var i=this,o=i.$createElement,t=i._self._c||o;return t("ContentSlotsDistributor",{attrs:{"slot-key":i.$parent.slotKey}},[t("div",[t("span",[t("div",[t("div",[t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("集群")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),i._v(" "),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("集群的介绍")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("简单地说，集群就是指一组（若干个）相互独立的计算机，利用高速通信网络组成的一个较大的计算机服务系统，每个集群节点（即集群中的每台计算机）都是运行各自服务的独立服务器。这些服务器之间可以彼此通信，协同向用户提供应用程序，系统资源和数据，并以单一系统的模式加以管理。当用户客户机请求集群系统时，集群给用户的感觉就是一个单一独立的服务器，而实际上用户请求的是一组集群服务器")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("打开谷歌，百度的页面，看起来好简单，也许你觉得用几分钟就可以制作出相似的网页，而实际上，这个页面的背后是由成千上万台服务器集群协同工作的结果。而这么多的服务器维护和管理，以及相互协调工作也许就是同学们未来的工作职责了")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("若要用一句话描述集群，即一堆服务器合作做同一件事，这些机器可能需要整个技术团队架构，设计和统一协调管理，这些机器可以分布在一个机房，也可以分布在全国全球各个地区的多个机房")])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("2.")]),i._v(" "),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("为什么要使用集群")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("font",{staticStyle:{"font-size":"12pt"}},[t("span",{staticStyle:{"font-size":"12pt","font-weight":"bold"}},[i._v("高性能")])])],1)])]),t("div",[t("font",{staticStyle:{"font-size":"12pt"}},[t("br")])],1),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("一些国家重要的计算密集型应用（如天气预报，核试验模拟等），需要计算机有很强的运算处理能力。以全世界现有的技术，即使是大型机，其计算能力也是有限的，很难单独完成此任务。因为计算时间可能会相当长，也许几天，甚至几年或更久。因此，对于这类复杂的计算业务，便使用了计算机集群技术，集中几十上百台，甚至成千上万台计算机进行计算")])])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("大家耳熟能详的大型网站谷歌、百度、淘宝等，都不是几台大型机可以构建的，都是上万台服务器组成的高性能集群，分布于不同的地点")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[i._v("价格有效性")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("通常一套系统集群架构，只需要几台或数十台服务器主机即可。与动辄价值上百万元的专用超级计算机相比便宜了很多。在达到同样性能需求的条件下，采用计算机集群架构比采用同等运算能力的大型计算机具有更高的性价比")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("早期的淘宝，支付宝的数据库等核心系统就是使用上百万元的小型机服务器。后因使用维护成本太高以及扩展设备费用成几何级数翻倍，甚至成为扩展瓶颈，人员维护也十分困难，最终使用PC服务器集群替换之，比如，把数据库系统从小机结合Oracle数据库迁移到MySQL开源数据库结合PC服务器上来。不但成本下降了，扩展和维护也更容易了")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[i._v("可伸缩性")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("当服务负载，压力增长时，针对集群系统进行较简单的扩展即可满足需求，且不会降低服务质量")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("通常情况下，硬件设备若想扩展性能，不得不增加新的CPU和存储器设备，如果加不上去了，就不得不够买更高性能的服务器，就拿我们现在的服务器来讲，可以增加的设备总是有限的。如果采用集群技术，则只需要将新的单个服务器加入现有集群架构中即可，从访问的客户角度来看，系统服务无论是连续性还是性能上都几乎没有变化，系统在不知不觉中完成了升级，加大了访问能力，轻松地实现了扩展。集群系统中的节点数目可以增长到几千乃至上万个，其伸缩性远超过单台超级计算机")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[i._v("高可用性")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("单一的计算机系统总会面临设备损毁的问题，如CPU，内存，主板，电源，硬盘等，只要一个部件坏掉，这个计算机系统就可能会宕机，无法正常提供服务。在集群系统中，尽管部分硬件和软件也还是会发生故障，但整个系统的服务可以是7*24小时可用的")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("集群架构技术可以使得系统在若干硬件设备故障发生时仍可以继续工作，这样就将系统的停机时间减少到了最小。集群系统在提高系统可靠性的同时，也大大减小了系统故障带来的业务损失，目前几乎100%的互联网网站都要求7*24小时提供服务")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[i._v("透明性")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("多个独立计算机组成的松耦合集群系统构成一个虚拟服务器。用户或客户端程序访问集群系统时，就像访问一台高性能，高可用的服务器一样，集群中一部分服务器的上线，下线不会中断整个系统服务，这对用户也是透明的")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[i._v("可管理性")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("整个系统可能在物理上很大，但其实容易管理，就像管理一个单一映像系统一样。在理想状况下，软硬件模块的插入能做到即插即用")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[i._v("可编程性")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("在集群系统上，容易开发及修改各类应用程序")])])])]),t("div",[t("br")]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("负载均衡示意图")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"1132884-20181122231803127-188968722.png",src:"/kevin-blog/Linux/nginx 负载均衡_files/1132884-20181122231803127-188968722.png",type:"image/png"}})]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"1132884-20181122231837300-1361831847.png",src:"/kevin-blog/Linux/nginx 负载均衡_files/1132884-20181122231837300-1361831847.png",type:"image/png"}})]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"1132884-20181122231933322-1866836813.jpg",src:"/kevin-blog/Linux/nginx 负载均衡_files/1132884-20181122231933322-1866836813.jpg",type:"image/jpeg"}})]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"1132884-20181122232211243-1810845203.jpg",src:"/kevin-blog/Linux/nginx 负载均衡_files/1132884-20181122232211243-1810845203.jpg",type:"image/jpeg"}})]),t("div",[t("br")]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("nginx 负载均衡概述")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("Web服务器，直接面向用户，往往要承载大量并发请求，单台服务器难以负荷，我使用多台WEB服务器组成集群，前端使用Nginx负载均衡，将请求分散的打到我们的后端服务器集群中，实现负载的分发。那么会大大提升系统的吞吐率、请求性能、高容灾")])])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"fzjh.jpg",src:"/kevin-blog/Linux/nginx 负载均衡_files/fzjh.jpg",type:"image/jpeg"}})]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("Nginx要实现负载均衡需要用到 proxy_pass 代理模块配置")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("Nginx可以配置代理多台服务器，当一台服务器宕机之后，仍能保持系统可用")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("Nginx负载均衡与Nginx代理不同地方在于: Nginx代理仅代理一台服务器，而Nginx负载均衡则是将客户端请求代理转发至一组upstream虚拟服务池")])])]),t("div",[t("br")]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("nginx 负载均衡的配置")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","box-sizing":"border-box","-webkit-tap-highlight-color":"transparent","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","white-space":"pre-wrap",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("1.")]),t("span",{staticStyle:{"font-size":"14pt","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v(" 环境的准备")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("准备3台服务器，且都安装了 nginx")])])])]),t("div",[t("font",{staticStyle:{"font-size":"12pt"}},[t("br")])],1),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("10.0.0.3 -> 作为 nginx 的负载均衡器，用于将请求分发给其他服务器进行处理")])])]),t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("10.0.0.5 -> 作为处理请求减轻负载的服务器")])])]),t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("10.0.0.6 -> 作为处理请求减轻负载的服务器")])])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("关闭所有服务器的防火墙")])])]),t("div",[t("font",{staticStyle:{"font-size":"12pt"}},[t("br")])],1),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("所有负责减轻负载的服务器，所存放的网站项目要完全一样")])])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","box-sizing":"border-box","-webkit-tap-highlight-color":"transparent","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","white-space":"pre-wrap",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("2.")]),t("span",{staticStyle:{"font-size":"14pt","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v(" nginx 负载均衡器的配置 -> 10.0.0.3 的配置")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("br")])]),t("ul",[t("li",[t("div",[i._v("进入 nginx 的配置文件")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/nginx-1-12/conf/nginx.conf")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("nginx 负载均衡器 的 nginx.conf 的配置文件设置")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("http {")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("  ...")]),t("span",{staticStyle:{color:"rgb(65, 173, 28)"}})]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# 定义一个名为 flask 的负载均衡池")])],1),t("div",[t("font",{attrs:{color:"#E30000"}},[i._v("upstream flask {")])],1),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("font",{attrs:{color:"#E30000"}}),i._v(" "),t("font",{attrs:{color:"#41AD1C"}},[i._v("# 池子中存放着两个处理请求减轻负载的服务器，默认轮询方式调用服务器")])],1),t("div",[t("font",{attrs:{color:"#E30000"}},[i._v("        server 10.0.0.5:8000;")])],1),t("div",[t("font",{attrs:{color:"#E30000"}},[i._v("        server 10.0.0.6:8000;")])],1),t("div",[t("font",{attrs:{color:"#E30000"}},[i._v("    }")])],1),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 使用server配置网站, 每个 server{} 代表一个网站 (简称虚拟主机)")])]),t("div",[i._v("    server {")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 监听端口, 默认80")])]),t("div",[i._v("        listen 80;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v(" # 提供服务的域名或主机名，即: 通过该域名或ip来访问当前配置的网站")])]),t("div",[i._v("        server_name 10.0.0.3;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 控制网站访问路径")])]),t("div",[i._v("        location / {")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将接收到的请求转交给名为flask的负载均衡池进行分发处理")])]),t("div",[t("font",{attrs:{color:"#E30000"}},[i._v("proxy_pass http://flask;")])],1),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("font",{attrs:{color:"#E30000"}}),i._v(" "),t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将 proxy_params 配置文件添加到当前虚拟主机上，且这个 proxy_params 配置文件需要手动创建到 /opt/nginx-1-12/conf/ 下")])],1),t("div",[t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("            # include 参数的作用: 减少主配置文件 nginx.conf 的内容，将某部分的配置项单独写在一个配置文件中然后使用 include 参数进行导入，其效果和直接写在 nginx.conf 主配置文件下是一样的")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("            # include 参数如果不使用绝对路径，那么默认会在 /opt/nginx-1-12/conf/ 下寻找你所定义的配置文件")])],1),t("div",[t("font",{staticStyle:{color:"rgb(227, 0, 0)"}},[i._v("            include proxy_params;")])],1),t("div",[i._v("        }")]),t("div",[i._v("    }")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("...")])]),t("div",[i._v("}")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("在 nginx 配置文件夹（即: /opt/nginx-1-12/conf/）下创建 proxy_params 配置文件")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/nginx-1-12/conf/proxy_params")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("打开 ")]),i._v("proxy_params 配置文件")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/nginx-1-12/conf/proxy_params")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("配置 proxy_params 配置文件")])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("存放请求头的相关参数")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("proxy_set_header Host $http_host;")]),t("div",[i._v("proxy_set_header X-Real-IP $remote_addr;")]),t("div",[i._v("proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;")]),t("div",[t("br")]),t("div",[i._v("proxy_connect_timeout 30;")]),t("div",[i._v("proxy_send_timeout 60;")]),t("div",[i._v("proxy_read_timeout 60;")]),t("div",[t("br")]),t("div",[i._v("proxy_buffering on;")]),t("div",[i._v("proxy_buffer_size 32k;")]),t("div",[i._v("proxy_buffers 4 128k;")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("检查"),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("nginx 负载均衡器")]),i._v("配置文件是否有语法错误")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("/opt/nginx-1-12/sbin/nginx -t")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("启动 "),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("nginx 负载均衡器")]),i._v(" 或 平滑重启 "),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("nginx 负载均衡器")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("如果没有启动 nginx，那么就启动 nginx")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("/opt/nginx-1-12/sbin/nginx")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("如果已经启动了nginx，那么在修改配置文件后，就平滑重启 nginx")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("/opt/nginx-1-12/sbin/nginx -s reload")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"white-space":"pre-wrap","font-size":"14pt","font-weight":"bold"}},[i._v("3.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 处理请求减轻负载的服务器配置 -> 10.0.0.5 的配置")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[i._v("方式一: 直接使用 flask 启动 web 服务")])])])]),t("div",[t("font",{staticStyle:{"font-size":"14pt"}},[t("br")])],1),t("ul",[t("ul",[t("li",[t("div",[i._v("注意: 在线上部署的时候，"),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("所有负责减轻负载的服务器，所存放的网站项目要完全一样，这里只是为了查看结果才做不一样的配置")])])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("在 /opt 文件夹下创建一个 flask_project 文件夹用于存放 flask 项目")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("mkdir /opt/flask_project")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("在 /opt/flask_project 下创建一个 my_flask.py 文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/flask_project/my_flask.py")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("进入 my_flask.py 文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/flask_project/my_flask.py")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("编辑 my_flask.py 文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("from flask import Flask")]),t("div",[i._v("app=Flask(__name__)")]),t("div",[i._v("@app.route('/')")]),t("div",[i._v("def hello():")]),t("div",[i._v("    return '<h1 style=\"color:red\">i am flask....from nginx<h1>'")]),t("div",[i._v('if __name__=="__main__":')]),t("div",[i._v("    app.run(host='0.0.0.0',port=8000)")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("启动 flask ")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("python3 /opt/flask_project/my_flask.py")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[i._v("方式二: 使用 nginx 启动 web 服务")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("在 /opt/nginx-1-12/html 创建一个 nginx_fzjh.html 文件")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("ul",[t("li",[t("div",[i._v("创建 nginx_fzjh.html 文件")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/nginx-1-12/html/nginx_fzjh.html")])]),t("div",[t("br")]),t("ul",[t("ul",[t("ul",[t("li",[t("div",[i._v("修改 nginx_fzjh.html 的内容")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/nginx-1-12/html/nginx_fzjh.html")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# nginx_fzjh.html")])],1),t("div",[t("br")]),t("div",[i._v('<h1 style="color:red">i am flask....from nginx<h1>')])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("nginx 的 nginx.conf 的配置文件设置")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("http {")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("  ...")]),t("span",{staticStyle:{color:"rgb(65, 173, 28)"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 使用server配置网站, 每个 server{} 代表一个网站 (简称虚拟主机)")])]),t("div",[i._v("    server {")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 监听端口, 默认80")])]),t("div",[i._v("        listen 8000;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v(" # 提供服务的域名或主机名，即: 通过该域名或ip来访问当前配置的网站")])]),t("div",[i._v("        server_name 10.0.0.5;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 控制网站访问路径")])]),t("div",[i._v("        location / {")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 存放网站代码路径")])]),t("div",[i._v("            root /opt/nginx-1-12/html/;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 服务器返回的默认页面文件, 即: 当浏览器访问 10.0.0.5 的时候就会返回一个 index.html 页面 ")])]),t("div",[i._v("            index nginx_fzjh.html;  ")]),t("div",[i._v("        }")]),t("div",[i._v("    }")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("...")])]),t("div",[i._v("}")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("检查nginx配置文件是否有语法错误")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("/opt/nginx-1-12/sbin/nginx -t")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("启动nginx 或 平滑重启 nginx")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("ul",[t("li",[t("div",[i._v("如果没有启动 nginx，那么就启动 nginx")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("/opt/nginx-1-12/sbin/nginx")])]),t("div",[t("br")]),t("ul",[t("ul",[t("ul",[t("li",[t("div",[i._v("如果已经启动了nginx，那么在修改配置文件后，就平滑重启 nginx")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("/opt/nginx-1-12/sbin/nginx -s reload")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("4.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 处理请求减轻负载的服务器配置 -> 10.0.0.6 的配置")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[i._v("方式一: 直接使用 flask 启动 web 服务")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("注意: 在线上部署的时候，"),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("所有负责减轻负载的服务器，所存放的网站项目要完全一样，这里只是为了查看结果才做不一样的配置")])])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("在 /opt 文件夹下创建一个 flask_project 文件夹用于存放 flask 项目")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("mkdir /opt/flask_project")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("在 /opt/flask_project 下创建一个 my_flask.py 文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/flask_project/my_flask.py")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("进入 my_flask.py 文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/flask_project/my_flask.py")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("编辑 my_flask.py 文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("from flask import Flask")]),t("div",[i._v("app=Flask(__name__)")]),t("div",[i._v("@app.route('/')")]),t("div",[i._v("def hello():")]),t("div",[i._v("    return '<h1 style=\"color:green\">i am flask....from nginx<h1>'")]),t("div",[i._v('if __name__=="__main__":')]),t("div",[i._v("    app.run(host='0.0.0.0',port=8000)")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("启动 flask ")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("python3 /opt/flask_project/my_flask.py")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-weight":"bold"}},[i._v("方式二: 使用 nginx 启动 web 服务")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("在 /opt/nginx-1-12/html 创建一个 nginx_fzjh.html 文件")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("ul",[t("li",[t("div",[i._v("创建 nginx_fzjh.html 文件")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/nginx-1-12/html/nginx_fzjh.html")])]),t("div",[t("br")]),t("ul",[t("ul",[t("ul",[t("li",[t("div",[i._v("修改 nginx_fzjh.html 的内容")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/nginx-1-12/html/nginx_fzjh.html")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# nginx_fzjh.html")])]),t("div",[t("br")]),t("div",[i._v('<h1 style="color:green">i am flask....from nginx<h1>')])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("nginx 的 nginx.conf 的配置文件设置")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("http {")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("  ...")]),t("span",{staticStyle:{color:"rgb(65, 173, 28)"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 使用server配置网站, 每个 server{} 代表一个网站 (简称虚拟主机)")])]),t("div",[i._v("    server {")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 监听端口, 默认80")])]),t("div",[i._v("        listen 8000;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v(" # 提供服务的域名或主机名，即: 通过该域名或ip来访问当前配置的网站")])]),t("div",[i._v("        server_name 10.0.0.6;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 控制网站访问路径")])]),t("div",[i._v("        location / {")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 存放网站代码路径")])]),t("div",[i._v("            root /opt/nginx-1-12/html/;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 服务器返回的默认页面文件, 即: 当浏览器访问 10.0.0.6 的时候就会返回一个 index.html 页面 ")])]),t("div",[i._v("            index nginx_fzjh.html;  ")]),t("div",[i._v("        }")]),t("div",[i._v("    }")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("...")])]),t("div",[i._v("}")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("检查nginx配置文件是否有语法错误")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("/opt/nginx-1-12/sbin/nginx -t")])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("启动nginx 或 平滑重启 nginx")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("ul",[t("li",[t("div",[i._v("如果没有启动 nginx，那么就启动 nginx")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("/opt/nginx-1-12/sbin/nginx")])]),t("div",[t("br")]),t("ul",[t("ul",[t("ul",[t("li",[t("div",[i._v("如果已经启动了nginx，那么在修改配置文件后，就平滑重启 nginx")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("/opt/nginx-1-12/sbin/nginx -s reload")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("5.")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v(" 通过浏览器访问网站")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[i._v("轮询访问"),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("处理请求减轻负载的服务器（即: 如果有两台")]),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("处理请求减轻负载的服务器")]),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("，浏览器第一次发送请求，服务器A处理，")]),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("浏览器")]),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("第二次")]),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("发送请求后，服务器B处理")]),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("）")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("浏览器第一次发送请求")])])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/nginx 负载均衡_files/Image.png",type:"image/png"}})]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("浏览器第二次发送请求")])])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/nginx 负载均衡_files/Image [1].png",type:"image/png"}})]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("浏览器第三次发送请求")])])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/nginx 负载均衡_files/Image [2].png",type:"image/png"}})]),t("div",[t("br")]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("nginx 负载均衡调度算法")])]),t("div",[t("div",[t("br")]),t("table",{staticStyle:{"border-collapse":"collapse","min-width":"100%"}},[t("colgroup",[t("col",{staticStyle:{width:"130px"}}),t("col",{staticStyle:{width:"816px"}})]),t("tbody",[t("tr",[t("td",{staticStyle:{"vertical-align":"middle","background-color":"rgb(234, 234, 234)",border:"1px solid rgb(187, 187, 187)",width:"130px",padding:"8px"}},[t("div",{staticStyle:{"text-align":"center"}},[i._v("调度算法")])]),t("td",{staticStyle:{"vertical-align":"middle","background-color":"rgb(234, 234, 234)",border:"1px solid rgb(187, 187, 187)",width:"816px",padding:"8px"}},[t("div",{staticStyle:{"text-align":"center"}},[i._v("说明")])])]),t("tr",[t("td",{staticStyle:{"vertical-align":"middle",width:"130px",padding:"8px",border:"1px solid"}},[t("div",{staticStyle:{"text-align":"center"}},[i._v("轮询")])]),t("td",{staticStyle:{"vertical-align":"middle",width:"816px",padding:"8px",border:"1px solid"}},[t("div",[i._v("按时间顺序逐一分配到不同的后端服务器(默认调度方式)")])])]),t("tr",[t("td",{staticStyle:{"vertical-align":"middle",width:"130px",padding:"8px",border:"1px solid"}},[t("div",{staticStyle:{"text-align":"center"}},[i._v("weight")])]),t("td",{staticStyle:{"vertical-align":"middle",width:"816px",padding:"8px",border:"1px solid"}},[t("div",[i._v("加权轮询, weight值越大, 分配到的访问几率越高")])])]),t("tr",[t("td",{staticStyle:{"vertical-align":"middle",width:"130px",padding:"8px",border:"1px solid"}},[t("div",{staticStyle:{"text-align":"center"}},[i._v("ip_hash")])]),t("td",{staticStyle:{"vertical-align":"middle",width:"816px",padding:"8px",border:"1px solid"}},[t("div",[i._v("每个请求按访问IP的hash结果分配,这样来自同一IP的固定访问一个后端服务器，且不能和 weight 一起使用")])])]),t("tr",[t("td",{staticStyle:{"vertical-align":"middle",width:"130px",padding:"8px",border:"1px solid"}},[t("div",{staticStyle:{"text-align":"center"}},[i._v("url_hash")])]),t("td",{staticStyle:{"vertical-align":"middle",width:"816px",padding:"8px",border:"1px solid"}},[t("div",[i._v("按照访问URL的hash结果来分配请求,是每个URL定向到同一个后端服务器")])])]),t("tr",[t("td",{staticStyle:{"vertical-align":"middle",width:"130px",padding:"8px",border:"1px solid"}},[t("div",{staticStyle:{"text-align":"center"}},[i._v("least_conn")])]),t("td",{staticStyle:{"vertical-align":"middle",width:"816px",padding:"8px",border:"1px solid"}},[t("div",[i._v("最少链接数,那个机器链接数少就分发")])])])])]),t("div",[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("weight")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("http {")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("  ...")]),t("span",{staticStyle:{color:"rgb(65, 173, 28)"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 定义一个名为 flask 的负载均衡池")])]),t("div",[t("font",{attrs:{color:"#464646"}},[i._v("upstream flask {")])],1),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),i._v(" "),t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 池子中存放着两个处理请求减轻负载的服务器，默认轮询方式调用服务器")])]),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("font",{attrs:{color:"#464646"}},[i._v(" server 10.0.0.5:8000 ")]),t("font",{attrs:{color:"#E30000"}},[i._v("weight=3")]),t("font",{attrs:{color:"#464646"}},[i._v(";")])],1),t("div",[t("font",{attrs:{color:"#464646"}},[i._v("        server 10.0.0.6:8000 ")]),t("font",{attrs:{color:"#E30000"}},[i._v("weight=7")]),t("font",{attrs:{color:"#464646"}},[i._v(";")])],1),t("div",[t("font",{attrs:{color:"#464646"}},[i._v("    }")])],1),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 使用server配置网站, 每个 server{} 代表一个网站 (简称虚拟主机)")])]),t("div",[i._v("    server {")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 监听端口, 默认80")])]),t("div",[i._v("        listen 80;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v(" # 提供服务的域名或主机名，即: 通过该域名或ip来访问当前配置的网站")])]),t("div",[i._v("        server_name 10.0.0.5;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 控制网站访问路径")])]),t("div",[i._v("        location / {")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将接收到的请求转交给名为flask的负载均衡池进行分发处理")])]),t("div",[t("font",{attrs:{color:"#464646"}},[i._v("proxy_pass http://flask;")])],1),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),i._v(" "),t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将 proxy_params 配置文件添加到当前虚拟主机上，且这个 proxy_params 配置文件需要手动创建到 /opt/nginx-1-12/conf/ 下")])]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("            # include 参数的作用: 减少主配置文件 nginx.conf 的内容，将某部分的配置项单独写在一个配置文件中然后使用 include 参数进行导入，其效果和直接写在 nginx.conf 主配置文件下是一样的")])]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("            # include 参数如果不使用绝对路径，那么默认会在 /opt/nginx-1-12/conf/ 下寻找你所定义的配置文件")])]),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("font",{attrs:{color:"#464646"}},[i._v("include proxy_params;")])],1),t("div",[i._v("        }")]),t("div",[i._v("    }")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("...")])]),t("div",[i._v("}")])]),t("div",[t("br")])]),t("ul",[t("li",[t("div",[i._v("ip_hash")])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("根据客户端ip哈希分配，不能和 weight 一起使用")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("http {")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("  ...")]),t("span",{staticStyle:{color:"rgb(65, 173, 28)"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 定义一个名为 flask 的负载均衡池")])]),t("div",[t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("upstream flask {")])]),t("div",[t("span",{staticStyle:{color:"rgb(70, 70, 70)"}}),t("font",{attrs:{color:"#464646"}}),i._v(" "),t("font",{attrs:{color:"#E30000"}},[i._v("ip_hash;")])],1),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),i._v(" "),t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 池子中存放着两个处理请求减轻负载的服务器，默认轮询方式调用服务器")])]),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v(" server 10.0.0.5:8000")]),t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v(";")])]),t("div",[t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("        server 10.0.0.6:8000")]),t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v(";")])]),t("div",[t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("    }")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 使用server配置网站, 每个 server{} 代表一个网站 (简称虚拟主机)")])]),t("div",[i._v("    server {")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 监听端口, 默认80")])]),t("div",[i._v("        listen 80;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v(" # 提供服务的域名或主机名，即: 通过该域名或ip来访问当前配置的网站")])]),t("div",[i._v("        server_name 10.0.0.5;")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 控制网站访问路径")])]),t("div",[i._v("        location / {")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将接收到的请求转交给名为flask的负载均衡池进行分发处理")])]),t("div",[t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("proxy_pass ")]),i._v("http://flask;")]),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),i._v(" "),t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将 proxy_params 配置文件添加到当前虚拟主机上，且这个 proxy_params 配置文件需要手动创建到 /opt/nginx-1-12/conf/ 下")])]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("            # include 参数的作用: 减少主配置文件 nginx.conf 的内容，将某部分的配置项单独写在一个配置文件中然后使用 include 参数进行导入，其效果和直接写在 nginx.conf 主配置文件下是一样的")])]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("            # include 参数如果不使用绝对路径，那么默认会在 /opt/nginx-1-12/conf/ 下寻找你所定义的配置文件")])]),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}}),t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("include proxy_params;")])]),t("div",[i._v("        }")]),t("div",[i._v("    }")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("...")])]),t("div",[i._v("}")])]),t("div",[t("br")]),t("div",[t("br")])]),t("div",[t("br")])])])])}),[],!1,null,null,null);o.default=e.exports}}]);