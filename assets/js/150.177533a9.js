(window.webpackJsonp=window.webpackJsonp||[]).push([[150],{503:function(i,e,t){"use strict";t.r(e);var o=t(25),r=Object(o.a)({},(function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":i.$parent.slotKey}},[t("div",[t("span",[t("div",[t("div",[t("div",[t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("介绍")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("redis 主从复制的问题")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("Redis主从复制可将主节点数据同步给从节点，从节点此时有两个作用：")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("一旦主节点宕机，从节点作为主节点的备份可以随时顶上来")])])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("扩展主节点的读能力，分担主节点读压力")])])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("但是问题是：")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("一旦主节点宕机，从节点上位，那么需要人为修改所有应用方的主节点地址（改为新的master地址），还需要命令所有从节点复制新的主节点")])])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("那么这个问题，redis-sentinel就可以解决了")])])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("2.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("redis-sentinel 的介绍")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("redis-sentinel 是 redis 官方推荐的高可用性解决方案")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("当用 redis 作 master(主)-slave(从) 的主从复制的时候，如果 master(主) 本身宕机，redis本身或者客户端都没有实现主从切换的功能")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("而 redis-sentinel 就是一个独立运行的进程，用于监控多个 ")]),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("master(主)-slave(从)")]),i._v(" "),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("集群，")]),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("自动发现 master(主) 宕机，进行自动切换将某一个 slave(从) 设置为 master(主)")])])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("font",{staticStyle:{color:"rgb(227, 0, 0)"}},[t("b",[i._v("redis-sentinel只是redis的一个进程，它不存储数据，只用于监控 redis 的状态")])])],1)])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[t("b",[i._v("redis-sentinel 可以创建多个 sentinel(哨兵) 进行监控")])])])])]),t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t("b",[t("br")])])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[t("b",[i._v("redis-sentinel 的默认端: 26379")])])])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("3.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("sentinel（哨兵） 的主要功能")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("监控 redis 是否良好运行，每个一秒中向 master(主)节点 或 slave(从)节点 发送一个ping的命令查看这些节点是否能ping通")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("如果发现 master(主)节点 ping 不通，那么 sentinel(哨兵) 就会和其他 sentinel(哨兵) 进行 “协商” 选择某一个 slave(从)节点 作为 master(主)节点")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("当 sentinel(哨兵) 进行过主从切换后，主redis配置文件、从redis配置文件、sentinel(哨兵)配置文件 都会发生变化，即: 原本的 主redis配置文件 中会多一行 slaveof 配置项，sentinel(哨兵)配置文件的监控目标也随之改变")])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("4.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("sentinel（哨兵） 是如何发现其他 ")]),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("sentinel（哨兵） 的")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v('sentinel 会通过命令连接向被监视的主从服务器发送 "Hello" 信息，该信息包含了 sentinel 的 ip、端口、id 等内容，以此来向其他 sentinel 宣告自己的存在。与此同时 sentinel 会通过订阅连接接收其他 sentinel 的 "Hello" 信息，以此来发现监视同一个主服务器的其他 sentinel')])])])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"1132884-20181124181822218-112575374.jpg",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/1132884-20181124181822218-112575374.jpg",type:"image/jpeg",width:"585"}})]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v('sentinel 通过发送 "Hello" 信息来让 sentinel2 和 sentinel3 发现自己，其他两个 sentinel 也会进行类似的操作')])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("5.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("redis-sentinel 的架构图")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"1132884-20180928115711245-1503702880.jpg",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/1132884-20180928115711245-1503702880.jpg",type:"image/jpeg",width:"947"}})]),t("div",[t("br")]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"1132884-20180928145626051-1360651849.jpg",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/1132884-20180928145626051-1360651849.jpg",type:"image/jpeg",width:"947"}})]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"1132884-20180928145734973-1288883859.jpg",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/1132884-20180928145734973-1288883859.jpg",type:"image/jpeg",width:"945"}})]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"1132884-20181116091956977-1189113564.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/1132884-20181116091956977-1189113564.png",type:"image/png",width:"933"}})]),t("div",[t("br")]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("环境的准备")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("配置主从复制 -> 一主两从")])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("创建 redis-sentinel 文件夹")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("创建文件夹 /opt/redis-4.0.10/my_redis_sentinel -> 用于存放 sentinel(哨兵)配置 和 redis 配置文件，方便管理")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("mkdir /opt/redis-4.0.10/my_redis_sentinel")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("2.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("配置主redis（master） ")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("创建 主redis 配置文件 -> redis-6380.conf")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/redis-4.0.10/my_redis_sentinel/redis-6380.conf")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("修改 主redis 配置文件 -> redis-6380.conf")])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("进入配置文件")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal"}},[i._v("vim /opt/redis-4.0.10/my_redis_sentinel/redis-6380.conf")])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("修改配置文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 绑定远程连接ip，如需要远程访问当前服务器的redis（即: 让别人连接你的redis），那么就需要填写当前服务器的ip -> 0.0.0.0 代表 127.0.0.1 也代表 当前服务器ip")])]),t("div",[t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("bind 0.0.0.0")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# redis 端口")])]),t("div",[i._v("port 6380")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否后台运行 redis，在执行 redis-server redis.conf 命令时，如果为 yes 那么就不进入阻塞状态（即: 还可以输入其他命令），如果为 no 进入阻塞状态 （即: 无法输入别的命令）")])]),t("div",[i._v("daemonize yes")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志文件，注意: /data/6380/ 目录必须存在（即: 如果没有就需要手动创建）")])]),t("div",[i._v('logfile "/data/6380/redis.log"')]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 配置 redis 的数据存放文件夹，一般存放redis的持久化存储文件和redis的日志文件等，注意: /data/6380/ 目录必须存在（即: 如果没有就需要手动创建）")])]),t("div",[i._v("dir /data/6380")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 定义 RDB 持久化文件名")])]),t("div",[i._v("dbfilename dump-6380.rdb")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("创建reids配置文件所需要的文件夹")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("mkdir /data/6380")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("3.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("配置从redis1（slave1）")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("创建 从redis 配置文件 -> redis-6381.conf")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/redis-4.0.10/my_redis_sentinel/redis-6381.conf")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("修改 从redis 配置文件 -> redis-6381.conf")])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("进入配置文件")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-variant-caps":"normal","font-variant-ligatures":"normal","font-family":"Monaco",color:"rgb(70, 70, 70)"}},[i._v("vim /opt/redis-4.0.10/my_redis_sentinel/redis-6381.conf")])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("修改配置文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 绑定远程连接ip，如需要远程访问当前服务器的redis（即: 让别人连接你的redis），那么就需要填写当前服务器的ip -> 0.0.0.0 代表 127.0.0.1 也代表 当前服务器ip")])]),t("div",[t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("bind 0.0.0.0")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# redis 端口")])]),t("div",[i._v("port 6381")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否后台运行 redis，在执行 redis-server redis.conf 命令时，如果为 yes 那么就不进入阻塞状态（即: 还可以输入其他命令），如果为 no 进入阻塞状态 （即: 无法输入别的命令）")])]),t("div",[i._v("daemonize yes")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志文件，注意: /data/6381/ 目录必须存在（即: 如果没有就需要手动创建）")])]),t("div",[i._v('logfile "/data/6381/redis.log"')]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 配置 redis 的数据存放文件夹，一般存放redis的持久化存储文件和redis的日志文件等，注意: /data/6381/ 目录必须存在（即: 如果没有就需要手动创建）")])]),t("div",[i._v("dir /data/6381")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 定义 RDB 持久化文件名")])]),t("div",[i._v("dbfilename dump-6381.rdb")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将 6380 redis 设置为当前的 6381 redis 的 主redis")])]),t("div",[i._v("slaveof 127.0.0.1 6380")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("创建reids配置文件所需要的文件夹")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("mkdir /data/6381")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("3.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("配置从redis2（slave2）")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("创建 从redis 配置文件 -> redis-6382.conf")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/redis-4.0.10/my_redis_sentinel/redis-6382.conf")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("修改 从redis 配置文件 -> redis-6382.conf")])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("进入配置文件")])])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{"letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px","font-variant-caps":"normal","font-variant-ligatures":"normal","font-family":"Monaco",color:"rgb(70, 70, 70)"}},[i._v("vim /opt/redis-4.0.10/my_redis_sentinel/redis-6382.conf")])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("修改配置文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 绑定远程连接ip，如需要远程访问当前服务器的redis（即: 让别人连接你的redis），那么就需要填写当前服务器的ip -> 0.0.0.0 代表 127.0.0.1 也代表 当前服务器ip")])]),t("div",[t("span",{staticStyle:{color:"rgb(70, 70, 70)"}},[i._v("bind 0.0.0.0")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# redis 端口")])]),t("div",[i._v("port 6382")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否后台运行 redis，在执行 redis-server redis.conf 命令时，如果为 yes 那么就不进入阻塞状态（即: 还可以输入其他命令），如果为 no 进入阻塞状态 （即: 无法输入别的命令）")])]),t("div",[i._v("daemonize yes")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志文件，注意: /data/6382/ 目录必须存在（即: 如果没有就需要手动创建）")])]),t("div",[i._v('logfile "/data/6382/redis.log"')]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 配置 redis 的数据存放文件夹，一般存放redis的持久化存储文件和redis的日志文件等，注意: /data/6382/ 目录必须存在（即: 如果没有就需要手动创建）")])]),t("div",[i._v("dir /data/6382")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 定义 RDB 持久化文件名")])]),t("div",[i._v("dbfilename dump-6382.rdb")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 将 6380 redis 设置为当前的 6382 redis 的 主redis")])]),t("div",[i._v("slaveof 127.0.0.1 6380")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("创建reids配置文件所需要的文件夹")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("mkdir /data/6382")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("4.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("启动所有redis")])]),t("div",[t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-server /opt/redis-4.0.10/my_redis_sentinel/redis-6380.conf")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-server /opt/redis-4.0.10/my_redis_sentinel/redis-6381.conf")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-server /opt/redis-4.0.10/my_redis_sentinel/redis-6382.conf")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("5.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("查看 redis 是否启动")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("ps -ef | grep redis")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image.png",type:"image/png"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("6.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("查看 redis 是否能 ping 通")])]),t("div",[t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("[root@kevin_linux /data 07:43:04]# "),t("font",{attrs:{color:"#FA7A00"}},[i._v("redis-cli -h 10.0.0.3 -p 6380")])],1),t("div",[i._v("10.0.0.3:6380> "),t("font",{attrs:{color:"#FA7A00"}},[i._v("ping")])],1),t("div",[t("font",{attrs:{color:"#FA7A00"}},[i._v("PONG")])],1)]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("[root@kevin_linux /data 07:43:39]# "),t("font",{attrs:{color:"#FA7A00"}},[i._v("redis-cli -h 10.0.0.3 -p 6381")])],1),t("div",[i._v("10.0.0.3:6381> "),t("font",{attrs:{color:"#FA7A00"}},[i._v("ping")])],1),t("div",[t("font",{attrs:{color:"#FA7A00"}},[i._v("PONG")])],1)]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("[root@kevin_linux /data 07:43:56]# "),t("font",{attrs:{color:"#FA7A00"}},[i._v("redis-cli -h 10.0.0.3 -p 6382")])],1),t("div",[i._v("10.0.0.3:6382> "),t("font",{attrs:{color:"#FA7A00"}},[i._v("ping")])],1),t("div",[t("font",{attrs:{color:"#FA7A00"}},[i._v("PONG")])],1)]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("7.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("查看 redis 的主从身份状态")])]),t("div",[t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-cli -p 6380 info replication")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [1].png",type:"image/png"}})]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-cli -p 6381 info replication")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [2].png",type:"image/png"}})]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-cli -p 6382 info replication")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [3].png",type:"image/png"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("7.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("在 主redis(master) 写入数据，在 从redis(slave) 查看数据")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [4].png",type:"image/png"}})]),t("div",[t("br")]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("redis-sentinel 的配置")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t("b",[i._v("注意: ")])])])])]),t("div",[t("b",[t("br")])]),t("ul",[t("ul",[t("li",[t("div",[t("font",{staticStyle:{color:"rgb(227, 0, 0)"}},[t("b",[i._v("redis-sentinel只是redis的一个进程，它不存储数据，只用于监控 redis 的状态")])])],1)])])]),t("div",[t("b",[t("br")])]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{color:"rgb(227, 0, 0)"}},[t("b",[i._v("sentinel 默认端口号 26379")])])])])])]),t("div",[t("b",[t("br")])]),t("ul",[t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[t("b",[i._v("可以创建多个 sentinel(哨兵) 进行监控")])])])])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("创建 sentinel 配置文件")])]),t("div",[t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("创建三个 sentinel 配置文件到 /opt/redis-4.0.10/my_redis_sentinel 目录下")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/redis-4.0.10/my_redis_sentinel/sentinel-26380.conf")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/redis-4.0.10/my_redis_sentinel/sentinel-26381.conf")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("touch /opt/redis-4.0.10/my_redis_sentinel/sentinel-26382.conf")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("2.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("配置 ")]),t("span",{staticStyle:{"font-size":"14pt"}},[t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("sentinel-26380.conf 配置文件")])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("进入配置文件")])])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{color:"rgb(51, 51, 51)","font-family":"Monaco"}},[t("font",{staticStyle:{"font-size":"9pt"}},[i._v("vim ")])],1),i._v("/opt/redis-4.0.10/my_redis_sentinel/sentinel-26380.conf")])]),t("div",[t("font",{staticStyle:{"font-size":"12pt"}},[t("br")])],1),t("ul",[t("li",[t("div",[i._v("修改配置文件")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# sentinel 端口")])],1),t("div",[i._v("port 26380")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# 是否后台运行 sentinel，在执行 redis-server redis.conf 命令时，如果为 yes 那么就不进入阻塞状态（即: 还可以输入其他命令），如果为 no 进入阻塞状态 （即: 无法输入别的命令）")])],1),t("div",[i._v("daemonize yes")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# 日志文件，注意: /data/26380/ 目录必须存在（即: 如果没有就需要手动创建）")])],1),t("div",[i._v('logfile "/data/26380/sentinel.log"')]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# 配置 sentinel 的数据存放文件夹，注意: /data/26380/ 目录必须存在（即: 如果没有就需要手动创建）")])],1),t("div",[i._v("dir /data/26380")]),t("div",[t("br")]),t("div",[t("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 让当前 sentinel 节点监控 10.0.0.3:6380 这个主节点（即:主redis）")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# mymaster : 是主节点的别名，可以起别的名字")])],1),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# 2 : 代表判断主节点（即:主redis）失败（即:宕机）至少需要2个sentinel节点节点同意")])],1),t("div",[i._v("sentinel monitor mymaster 10.0.0.3 6380 2")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# 当 sentinel 节点集合对主节点（即:主redis）故障判定达成一致时，sentinel领导者节点会做故障转移操作，选出新的主节点（即:主redis），原来的从节点（即:从redis）会向新的主节点（即:主redis）发起复制操作，限制每次向新的主节点（即:主redis）发起复制操作的从节点（即:从redis）个数为1")])],1),t("div",[i._v("sentinel parallel-syncs mymaster 1")]),t("div",[t("br")]),t("div",[t("font",{attrs:{color:"#41AD1C"}},[i._v("# 故障转移超时时间为 180000 毫秒")])],1),t("div",[i._v("sentinel failover-timeout mymaster 180000")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("创建sentinel配置文件所需要的文件夹")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("mkdir /data/26380")])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("3.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("配置 ")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("sentinel-26381.conf 配置文件")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("进入配置文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{color:"rgb(51, 51, 51)","font-family":"Monaco","font-size":"9pt"}},[i._v("vim ")]),i._v("/opt/redis-4.0.10/my_redis_sentinel/sentinel-26381.conf")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("修改配置文件")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# sentinel 端口")])]),t("div",[i._v("port 26381")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否后台运行 sentinel，在执行 redis-server redis.conf 命令时，如果为 yes 那么就不进入阻塞状态（即: 还可以输入其他命令），如果为 no 进入阻塞状态 （即: 无法输入别的命令）")])]),t("div",[i._v("daemonize yes")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志文件，注意: /data/26381/ 目录必须存在（即: 如果没有就需要手动创建）")])]),t("div",[i._v('logfile "/data/26381/sentinel.log"')]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 配置 sentinel 的数据存放文件夹，注意: /data/26381/ 目录必须存在（即: 如果没有就需要手动创建）")])]),t("div",[i._v("dir /data/26381")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 让当前 sentinel 节点监控 10.0.0.3:6380 这个主节点（即:主redis）")])]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# mymaster : 是主节点的别名，可以起别的名字")])]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 2 : 代表判断主节点（即:主redis）失败（即:宕机）至少需要2个sentinel节点节点同意")])]),t("div",[i._v("sentinel monitor mymaster 10.0.0.3 6380 2")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 当 sentinel 节点集合对主节点（即:主redis）故障判定达成一致时，sentinel领导者节点会做故障转移操作，选出新的主节点（即:主redis），原来的从节点（即:从redis）会向新的主节点（即:主redis）发起复制操作，限制每次向新的主节点（即:主redis）发起复制操作的从节点（即:从redis）个数为1")])]),t("div",[i._v("sentinel parallel-syncs mymaster 1")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 故障转移超时时间为 180000 毫秒")])]),t("div",[i._v("sentinel failover-timeout mymaster 180000")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("创建sentinel配置文件所需要的文件夹")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("mkdir /data/26381")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("4.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("配置 ")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("sentinel-26382.conf 配置文件")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("进入配置文件")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{color:"rgb(51, 51, 51)","font-family":"Monaco","font-size":"9pt"}},[i._v("vim ")]),i._v("/opt/redis-4.0.10/my_redis_sentinel/sentinel-26382.conf")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("修改配置文件")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# sentinel 端口")])]),t("div",[i._v("port 26382")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 是否后台运行 sentinel，在执行 redis-server redis.conf 命令时，如果为 yes 那么就不进入阻塞状态（即: 还可以输入其他命令），如果为 no 进入阻塞状态 （即: 无法输入别的命令）")])]),t("div",[i._v("daemonize yes")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 日志文件，注意: /data/26382/ 目录必须存在（即: 如果没有就需要手动创建）")])]),t("div",[i._v('logfile "/data/26382/sentinel.log"')]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 配置 sentinel 的数据存放文件夹，注意: /data/26382/ 目录必须存在（即: 如果没有就需要手动创建）")])]),t("div",[i._v("dir /data/26382")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 让当前 sentinel 节点监控 10.0.0.3:6380 这个主节点（即:主redis）")])]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# mymaster : 是主节点的别名，可以起别的名字")])]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 2 : 代表判断主节点（即:主redis）失败（即:宕机）至少需要2个sentinel节点节点同意")])]),t("div",[i._v("sentinel monitor mymaster 10.0.0.3 6380 2")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 当 sentinel 节点集合对主节点（即:主redis）故障判定达成一致时，sentinel领导者节点会做故障转移操作，选出新的主节点（即:主redis），原来的从节点（即:从redis）会向新的主节点（即:主redis）发起复制操作，限制每次向新的主节点（即:主redis）发起复制操作的从节点（即:从redis）个数为1")])]),t("div",[i._v("sentinel parallel-syncs mymaster 1")]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{color:"rgb(65, 173, 28)"}},[i._v("# 故障转移超时时间为 180000 毫秒")])]),t("div",[i._v("sentinel failover-timeout mymaster 180000")])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("创建sentinel配置文件所需要的文件夹")])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("mkdir /data/26382")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("5.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("启动 ")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("sentinel（哨兵）")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-sentinel /opt/redis-4.0.10/my_redis_sentinel/sentinel-26380.conf")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-sentinel /opt/redis-4.0.10/my_redis_sentinel/sentinel-26381.conf")])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-sentinel /opt/redis-4.0.10/my_redis_sentinel/sentinel-26382.conf")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("6.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("查看")]),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}}),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("sentinel（哨兵）是否")]),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("启动")])]),t("div",[t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("ps -ef | grep redis")])]),t("div",[t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [5].png",type:"image/png"}})])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("6.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("查看")]),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}}),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("sentinel（哨兵）的状态")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-cli -p 26380 info sentinel")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [6].png",type:"image/png"}})])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{staticStyle:{"font-size":"9pt"}},[i._v("redis-cli -p 26381 info sentinel")])],1)]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [7].png",type:"image/png"}})])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{staticStyle:{"font-size":"9pt"}},[i._v("redis-cli -p 26382 info sentinel")])],1)]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [8].png",type:"image/png"}})]),t("div",[t("br")]),t("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[i._v("redis 故障实验")])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("1.")]),i._v(" "),t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"rgb(0, 0, 0)","font-family":'"Courier New"',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold"}},[i._v("大致思路")])]),t("div",[t("span",{staticStyle:{"font-size":"18.6667px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[t("br")])]),t("ul",[t("li",[t("div",[i._v("结束 主redis进程6380端口，观察从redis是否会进行新的主redis（master）选举，进行切换")])])]),t("div",[t("br")]),t("ul",[t("li",[t("div",[i._v("重新启动旧的 主redis，查看此时 redis 的状态身份")])])]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("2.")]),i._v(" "),t("span",{staticStyle:{"font-size":"14pt"}},[t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("结束主redis进程6380端口")])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("span",{staticStyle:{"font-size":"9pt",color:"rgb(51, 51, 51)","font-family":"Monaco"}},[i._v("ps -ef | grep redis")])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{staticStyle:{"font-size":"9pt"}},[i._v("kill -9 7411")])],1)]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [9].png",type:"image/png"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("3.")]),i._v(" "),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("等待 sentinel 进行主从切换（即: 30秒后")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("查看从redis的身份状态")]),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("）")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("4.")]),i._v(" "),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("查看从redis的身份状态")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("此时查看所有从redis的身份状态，查看是否有一个从reids被设置为了主redis")])])])]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("此时 从redis 6381 被设置为了 主redis")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-cli -p 6381 info replication")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [10].png",type:"image/png"}})]),t("div",[t("br")]),t("ul",[t("ul",[t("li",[t("div",[i._v("此时 从redis 6382 的所设置的主redis被给改为 redis 6381")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-cli -p 6382 info replication")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [11].png",type:"image/png"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("4.")]),i._v(" "),t("span",{staticStyle:{"font-size":"14pt"}},[t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("重新启动旧的 主redis，查看此时 redis 的状态身份")])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("重新启动旧的 主redis")])])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{staticStyle:{"font-size":"9pt"}},[i._v("redis-server /opt/redis-4.0.10/my_redis_sentinel/redis-6380.conf")])],1)]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("查看此时")]),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("旧的 主redis")]),i._v(" "),t("span",{staticStyle:{"font-size":"12pt"}},[i._v("的状态身份")])])])]),t("div",[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-cli -p 6380 info replication")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [12].png",type:"image/png"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("5.")]),i._v(" "),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("查看此时新主 redis 的状态身份")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("redis-cli -p 6381 info replication")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [13].png",type:"image/png"}})]),t("div",[t("br")]),t("div",[t("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[i._v("6.")]),i._v(" "),t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[i._v("查 redis 配置文件 和 sentinel 配置文件的变化")])]),t("div",[t("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t("br")])]),t("ul",[t("li",[t("div",[t("font",{staticStyle:{"font-size":"12pt",color:"rgb(227, 0, 0)"}},[i._v("注意: 当 sentinel 配置文件变化后，原本的注释已经对应不上他的配置项了，所以不要去查看这些注释")])],1)])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("查 redis 配置文件的变化")])])])]),t("div",[t("span",{staticStyle:{"font-size":"14pt"}},[t("br")])]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[t("font",{staticStyle:{"font-size":"9pt"}},[i._v("vim /opt/redis-4.0.10/my_redis_sentinel/redis-6380.conf")])],1)]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [14].png",type:"image/png"}})]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/redis-4.0.10/my_redis_sentinel/redis-6381.conf")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [15].png",type:"image/png"}})]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/redis-4.0.10/my_redis_sentinel/redis-6382.conf")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [16].png",type:"image/png"}})]),t("div",[t("br")]),t("ul",[t("li",[t("div",[t("span",{staticStyle:{"font-size":"12pt"}},[i._v("查 sentinel 配置文件的变化")])])])]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/redis-4.0.10/my_redis_sentinel/sentinel-26380.conf")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [17].png",type:"image/png"}})]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/redis-4.0.10/my_redis_sentinel/sentinel-26381.conf")])]),t("div",[t("br")]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [18].png",type:"image/png"}})]),t("div",[t("br")]),t("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[t("div",[i._v("vim /opt/redis-4.0.10/my_redis_sentinel/sentinel-26382.conf")])]),t("div",[t("br")])]),t("div",[t("img",{attrs:{"data-filename":"Image.png",src:"/kevin-blog/Linux/redis-sentinel 哨兵模式_files/Image [19].png",type:"image/png"}})]),t("div",[t("br")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);