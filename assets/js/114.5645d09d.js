(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{467:function(t,e,i){"use strict";i.r(e);var a=i(25),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[i("div",[i("span",[i("div",[i("div",[i("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[i("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("g 的介绍")])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("1.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("Flask 中的 g 的生命周期")])])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("当每次请求进来的时候，会为每个请求创建一个 g，当请求结束（即: 当视图函数返回数据给浏览器）的时候 g 就会消失 -> 不懂的可以看回上下文管理中的 app 上下文流程图")])])])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("2.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("g 和 全局变量 的区别")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[t._v("全局变量项目启动的时候就会创建，而 g 只会在请求到来的时候创建")])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("在多线程的情况下，g 不会收到影响，因为每个线程下都会有一个g，而在多线程情况下使用全局变量就会出现数据的混乱")])])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("3.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("g 和 session 的区别")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("g只在一次请求周期中存在，当请求结束后g就会消失，而session会在请求到来的时候再去cookie中获取")])])])]),i("div",[i("br")]),i("div",[i("span",{staticStyle:{"font-size":"14pt","white-space":"pre-wrap","font-weight":"bold"}},[t._v("4.")]),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}}),i("span",{staticStyle:{"font-size":"14pt","font-weight":"bold"}},[t._v("g 的使用场景")])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[t._v("Flask 中的 g 的使用情况 和 Django 中的（在中间件中对request添加新的属性，然后每个视图函数都可以使用到给属性）使用情况类似 ")])])]),i("div",[i("span",{staticStyle:{"font-size":"14pt"}},[i("br")])]),i("ul",[i("li",[i("div",[i("span",{staticStyle:{"-en-paragraph":"true"}},[t._v("g ")]),i("span",{staticStyle:{"font-family":'".PingFang SC"',"-en-paragraph":"true"}},[t._v("一般在")]),t._v(" "),i("span",{staticStyle:{"font-family":'"Helvetica Neue"',"-en-paragraph":"true"}},[t._v("before_request")]),t._v(" "),i("span",{staticStyle:{"font-family":'".PingFang SC"',"-en-paragraph":"true"}},[t._v("和")]),t._v(" "),i("span",{staticStyle:{"font-family":'"Helvetica Neue"',"-en-paragraph":"true"}},[t._v("after_request")]),t._v(" "),i("span",{staticStyle:{"font-family":'".PingFang SC"',"-en-paragraph":"true"}},[t._v("特殊函数上使用")])])])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("一次http请求内如果先做一个操作，然后再做一个操作，后面的操作需要前面操作的某一个参数的时候，就可以使用g（例如: 使用 g 实现自定义 session）")])])]),i("div",[i("br")]),i("h2",{staticStyle:{margin:"10px 0px 12px",padding:"0px 0px 0px 15px","font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-align":"center","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px"}},[i("span",{staticStyle:{"font-size":"21px","background-color":"#3eaf7c","border-radius":"3px","text-shadow":"rgb(34, 34, 34) 1px 1px 2px","letter-spacing":"normal",orphans:"2","text-indent":"0px","text-transform":"none","white-space":"normal",widows:"2","word-spacing":"0px","-webkit-text-stroke-width":"0px",color:"white","font-family":'"Helvetica Neue", Helvetica, Verdana, Arial, sans-serif',"font-variant-caps":"normal","font-variant-ligatures":"normal","font-weight":"bold","line-height":"1.5"}},[t._v("g 的使用")])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("g 的正确使用")])])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# app.py")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[t._v("from flask import Flask, "),i("font",{attrs:{color:"#FA7A00"}},[t._v("g")])],1),i("div",[i("br")]),i("div",[t._v("app = Flask(__name__)")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("@app.before_request")]),i("div",[t._v("def process_request():")]),i("div",[i("font",{attrs:{color:"#FA7A00"}},[t._v("g.username = 'Kevin'")]),t._v(" "),i("font",{staticStyle:{color:"rgb(65, 173, 28)"}},[t._v("# 在 g 中添加新的属性")])],1),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("@app.route('/index')")]),i("div",[t._v("def index():")]),i("div",[t._v("    username = g.username  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 获取 g 的属性")])],1),i("div",[t._v("    print(username)")]),i("div",[t._v("    return 'index_html'")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("@app.route('/news')")]),i("div",[t._v("def news():")]),i("div",[t._v("    username = g.username  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 获取 g 的属性")])],1),i("div",[t._v("    print(username)")]),i("div",[t._v("    return 'news_html'")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("if __name__ == '__main__':")]),i("div",[t._v("    app.run()")])]),i("div",[i("br")]),i("ul",[i("li",[i("div",[t._v("g 的错误使用")])])]),i("div",[i("br")]),i("ul",[i("ul",[i("li",[i("div",[i("span",{staticStyle:{"font-size":"12pt"}},[t._v("当每次请求进来的时候，会为每个请求创建一个 g，当请求结束（即: 当视图函数返回数据给浏览器）的时候 g 就会消失，所以当访问 news 视图获取 g.username 的时候就会报错，因为 index 的视图请求已经结束了 g 也已经消失了，news 视图的 g 不是 index 视图的 g ")])])])])]),i("div",[i("br")]),i("div",{staticStyle:{"box-sizing":"border-box",padding:"8px","font-family":'Monaco, Menlo, Consolas, "Courier New", monospace',"font-size":"12px",color:"rgb(51, 51, 51)","border-radius":"4px","background-color":"rgb(251, 250, 248)",border:"1px solid rgba(0, 0, 0, 0.15)","-en-codeblock":"true"}},[i("div",[i("font",{attrs:{color:"#41AD1C"}},[t._v("# app.py")])],1),i("div",[i("font",{attrs:{color:"#41AD1C"}},[i("br")])],1),i("div",[t._v("from flask import Flask, g")]),i("div",[i("br")]),i("div",[t._v("app = Flask(__name__)")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("@app.route('/index')")]),i("div",[t._v("def index():")]),i("div",[t._v("    g.username = 'Kevin'  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 在 g 中添加新的属性")])],1),i("div",[t._v("    return 'index_html'")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("@app.route('/news')")]),i("div",[t._v("def news():")]),i("div",[t._v("    print(g.username)  "),i("font",{attrs:{color:"#41AD1C"}},[t._v("# 报错")])],1),i("div",[t._v("    return 'news_html'")]),i("div",[i("br")]),i("div",[i("br")]),i("div",[t._v("if __name__ == '__main__':")]),i("div",[t._v("    app.run()")])])]),i("div",[i("br")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);